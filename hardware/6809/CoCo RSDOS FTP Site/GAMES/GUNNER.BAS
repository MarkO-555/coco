1 REM TANK GUNNER70 PMODE3,180 PCLEAR 490 DIM TK(28,20)100 CLS105 PRINT "        TANK GUNNER"110 INPUT "DO YOU WISH WINDS  (Y OR N)";Q$120 IF Q$="N" THEN W=0 ELSE W=RND(20)-10130 IF W>0 THEN PRINT"WINDS FROM LEFT AT FORCE";W ELSE PRINT"WINDS FROM RIGHT AT FORCE";ABS(W)160 A$="L255;O1V31BV30FV29DV28GV27EV25CV23FV21CV19GV17BV15;L210;O2;D#V13C#V11F#V9DV7AV5BV3EV1G"170 B$="L200;O1;V31BV28AV24GV20FV16DV10C#V5C"180 C$="H4G3U3L4E4H4E4U2F4E4D3R4G3F2R3G4F3L3D2L2"190 PCLS200 COLOR 3,1220 CIRCLE (6,14),4,3230 CIRCLE (14,14),4,3240 CIRCLE (22,14),4,3250 LINE (6,10)-(22,10),PSET260 LINE (6,18)-(22,18),PSET270 CIRCLE (14,10),8,3,1,.5,1280 PAINT (14,8),3290 GET (0,0)-(28,20),TK,G300 PCLS310 GOSUB 760320 SCREEN 1,0340 FALSE=0350 MASK=127:KO=123:LI=16360 BU=65280:TS=.09:G=25:S=.1370 P1=X1+20:P2=X2+8380 F1=FALSE:F2=FALSE:F3=FALSE390 Q1=Y1+5:Q2=Y2+5400 O=100:L=10410 T1=.1:T2=.1420 X4=-1:Y4=-1:X5=0:Y5=0430 B1=P1:B2=P2:D1=Q1:D2=Q2440 PI=3.14159256:PH=PI/3:M=PI/8:PM=PI-M:LP=LI*PI450 'MAIN LOOP460 V2=LI-JOYSTK(0)+O:V1=JOYSTK(2)+O:A2=PI-(LI-JOYSTK(1))/LP-(M*2)470 A1=(L1-JOYSTK(3))/LP+(M*3):BT=(PEEK(BU) AND MASK)-KO480 IF F1 THEN GOSUB 1130 ELSE GOSUB 1320490 IF F2 THEN GOSUB 1370 ELSE GOSUB 1560500 IF F3 THEN IF F1 OR F2 THEN 510 ELSE 530510 ON BT GOSUB 1610,1060,990520 GOTO 460530 FOR I=1 TO 800:NEXT I540 CLS:SCREEN 0,0550 PRINT @ 10,"TANK GUNNER":PRINT560 PRINT"   LEFT TANK","  RIGHT TANK"570 PRINT"     SCORE",  "     SCORE":PRINT580 S1=S1+H1:S2=S2+H2590 H1=0:H2=0600 PRINT TAB(6) S1 TAB(22) S2610 PRINT:PRINT620 GOTO 110630 END640 'EXPLOSION SUBROUTINE650 D$="BM"+STR$(INT(X3+14))+","+STR$(INT(Y3+19))660 COLOR 2,1670 DRAW D$+C$680 PAINT(X3+14,Y3+6),4,2690 FOR I=1 TO 20:NEXT I700 PAINT(X3+14,Y3+6),1,2710 COLOR 1,3720 DRAW D$+C$730 COLOR 3,1740 PLAY A$750 RETURN760 'POSITION TANKS AND DRAW MOUNTAIN770 X1=RND(30)780 Y1=191-RND(50)-20790 PUT (X1,Y1)-(X1+28,Y1+20),TK,PSET800 X2=RND(30)+197810 Y2=191-RND(50)-20820 PUT (X2,Y2)-(X2+28,Y2+20),TK,PSET830 DT=X2-X1840 COLOR 2,1850 LINE (0,Y1+20)-(X1+30,Y1+20),PSET860 LINE (X2-8,Y2+20)-(255,Y2+20),PSET870 LINE (0,Y1+20)-(0,191),PSET880 LINE (0,191)-(255,191),PSET890 LINE (255,Y2+20)-(255,191),PSET900 M=(Y1+Y2)/2-20-RND(60)910 N=X1+RND(14)+DT/2920 REM DRAW MOUNTAIN930 LINE ((X1+30),(Y1+20))-(N,M),PSET940 LINE (N,M)-(X2-8,Y2+20),PSET950 PAINT (N,M+2),2,2960 COLOR 3,1970 RETURN980 'RIGHT TANK FIRE SUBROUTINE990 IF F2 THEN RETURN ELSE F2=11000 C2=V2*SIN(A2)1010 C1=V2*COS(A2)+W1020 PLAY B$1030 XA=0:YB=01040 RETURN1050 'LEFT TANK FIRE SUBROUTINE1060 IF F1 THEN RETURN ELSE F1=11070 K2=V1*SIN(A1)1080 K1=V1*COS(A1)1090 PLAY B$1100 X4=0:Y4=01110 RETURN1120 'UPDATE LEFT TANKS FIRE1130 T1=T1+TS1140 IF Y4>0 THEN X5=X4:Y5=Y41150 X4=K1*T1+P1:Y4=Q1-(K2*T1-G*T1*T1)1160 PRESET(X5,Y5)1170 IF X4>255 THEN F1=FALSE:T1=S:RETURN1180 IF Y4<0 THEN RETURN1190 ON PPOINT(X4,Y4)-1 GOTO 1250,1220,12801200 PSET(X4,Y4,4)1210 RETURN1220 F1=FALSE:F3=1:T1=S:H1=11230 X3=X2:Y3=Y2:GOSUB 6401235 T1=S1240 LINE (P2,Q2)-(B2,D2),PRESET:RETURN1250 F1=FALSE:X3=X4-14:Y3=Y4-10:GOSUB 6401255 T1=S1260 PUT (X2,Y2)-(X2+28,Y2+20),TK,PSET1270 GOTO 15601280 X3=X4-14:Y3=Y4-101290 GOSUB 6401295 T1=S:T2=S1300 F1=FALSE:F2=FALSE:RETURN1310 'LEFT GUN SUBROUTINE1320 XO=P1+L*COS(A1)1330 YO=Q1-L*SIN(A1)1340 LINE(P1,Q1)-(B1,D1),PRESET1345 LINE(P1,Q1)-(XO,YO),PSET1350 B1=XO:D1=YO:RETURN1360 'UPDATE RIGHT TANKS FIRE1370 T2=T2+TS1380 IF YA>0 AND XA>0 THEN XB=XA:YB=YA1390 XA=C1*T2+P2:YA=Q2-(C2*T2-G*T2*T2)1400 PRESET(XB,YB)1410 IF XA<0 THEN F2=FALSE:T2=S:RETURN1420 IF YA<0 THEN RETURN1430 ON PPOINT(XA,YA)-1 GOTO 1490,1460,15201440 PSET(XA,YA,4)1450 RETURN1460 F2=FALSE:F3=1:T2=S:H2=11470 X3=X1:Y3=Y1:GOSUB 6401475 T2=S1480 LINE (P1,Q1)-(B1,D1),PRESET:RETURN1490 F2=FALSE:X3=XA-14:Y3=YA-10:GOSUB 6401495 T2=S1500 PUT (X1,Y1)-(X1+28,Y1+20),TK,PSET1510 GOTO 13201520 X3=XA-14:Y3=YA-101530 GOSUB 6401535 T1=S:T2=S1540 F1=FALSE:F2=FALSE:RETURN1550 'RIGHT GUN SUBROUTINE1560 XT=P2+L*COS(A2)1570 YT=Q2-L*SIN(A2)1580 LINE(P2,Q2)-(B2,D2),PRESET1585 LINE (P2,Q2)-(XT,YT),PSET1590 B2=XT:D2=YT:RETURN1600 'BOTH BUTTONS PUSHED1610 IF F1 AND F2 THEN RETURN1620 GOSUB 9901630 GOTO 10601640 END 'TANK GUNNER