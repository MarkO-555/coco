1 POKE&HFFD9,0:GOSUB710:CO=0:WIDTH40:PALETTE0,0:PALETTE2,18:PALETTE8,63:PALETTE10,36:PALETTE12,24:CLS1:PRINT:PRINTTAB(3);STRING$(32,"*"):PRINT"   *        WELCOME ABOARD        *"2 PRINT"   *              THE             *":PRINT"   *           STARSHIP           *":PRINT"   *          ENTERPRISE          *"3 PRINTTAB(3);STRING$(32,"*")15 PRINT"    STANDBY FOR ORDERS CAPT'N KIRK":CLEAR60016 Z$="                        "17 DIMG(8,8),C(9,2),K(3,3),N(3),Z(8,8),D(8)18 T=INT(RND(0)*20+20)*100:T0=T:T9=30+INT(RND(0)*10):D0=0:E=5000:E0=E19 P=10:P0=P:S9=200:S=0:B9=0:K9=0:X$=""20 DEF FND(D)=SQR((K(1,1)-S1)^2+(K(1,2)-S2)^2)21 DEF FNR(R)=INT(RND(0)*7.98+1.01)22 Q1=FNR(1):Q2=FNR(2):S1=FNR(1):S2=FNR(2)23 FORI=1TO9:C(I,1)=0:C(I,2)=0:NEXTI24 C(3,1)=-1:C(2,1)=-1:C(4,1)=-1:C(4,2)=-1:C(5,2)=-1:C(6,2)=-125 C(1,2)=1:C(2,2)=1:C(6,1)=1:C(7,1)=1:C(8,1)=1:C(8,2)=1:C(9,2)=126 FORI=1TO8:D(I)=0:NEXTI27 A1$="NAVSRTLRSPHATORSHEDAMCOMENDDESREP"28 FORI=1TO8:FORJ=1TO8:K3=0:Z(I,J)=0:R1=RND(0)29 IFR1>.98THENK3=3:K9=K9+3:GOTO3230 IFR1>.95THENK3=2:K9=K9+2:GOTO3231 IFR1>.80THENK3=1:K9=K9+132 B3=0:IFRND(0)>.96THENB3=1:B9=B9+133 G(I,J)=K3*100+B3*10+FNR(1):NEXTJ:NEXTI:IF K9>T9 THEN T9=K9+134 IFB9<>0THEN3735 IFG(Q1,Q2)<200THENG(Q1,Q2)=G(Q1,Q2)+100:K9=K9+136 B9=1:G(Q1,Q2)=G(Q1,Q2)+10:Q1=FNR(1):Q2=FNR(2)37 K7=K9:PRINT:PRINT"RECEIVING CODE 1 FROM STARFLEET HQ - WAR"39 PRINT:PRINT"   INVADING KLINGONS:"K9:PRINT"   DAYS BEFORE ATTACK:"T940 PRINT"   STARBASES AVAILABLE:"B9:PRINT:ATTR 1,0,B:PRINT"   MISSION: ENGAGE ENEMY":ATTR 3,047 Z4=Q1:Z5=Q2:K3=0:B3=0:S3=0:G5=0:D4=.5*RND(0):Z(Q1,Q2)=G(Q1,Q2)48 IFQ1<1ORQ1>8ORQ2<1ORQ2>8THEN8549 GOSUB485:IF T0<>T THEN6250 PRINT:PRINT"   MISSION BEGINS IN "G2$:PRINT"   QUADRANT"Q1","Q2:PRINT:GOSUB51055 CLS:FORX=1TO8:PRINT:NEXTX:PRINTTAB(5);STRING$(29,"#")56 PRINT"     #                           #"57 PRINT"     #      STANDBY TO BEAM      #"58 PRINT"     #       ABOARD CAPT'N       #"59 PRINT"     #                           #"60 PRINTTAB(5);STRING$(29,"#"):GOTO7162 CLS:PRINT"     ++++++++++++++++++++++++"63 PRINT"     +                      +"64 PRINT"     +      NOW ENTERING    +"65 U=LEN(G2$):UU=12-(U/2)66 PRINT"     +                      +"67 PRINT"     ++++++++++++++++++++++++"69 PRINT:PRINT:PRINTTAB(UU)G2$;" QUADRANT"70 FORU=1TO200:NEXTU71 K3=INT(G(Q1,Q2)*.01):B3=INT(G(Q1,Q2)*.1)-10*K372 S3=G(Q1,Q2)-100*K3-10*B3:IFK3=0THEN8473 FORU=1TO600:NEXTU74 CLS:ATTR 4,0,B:FORLQ=1TO6:PRINT:NEXTLQ75 PRINT"     ############################"76 PRINT"     #                          #"77 PRINT"     #        COMBAT AREA       #"78 PRINT"     #       CONDITION RED      #"79 IFS>200THEN8180 PRINT"     #  SHIELDS DANGEROUSLY LOW #"81 PRINT"     #                          #"82 PRINT"     ############################":ATTR 3,083 FORU=1TO25:FORUU=1TO45:NEXTUU:SOUND240,1:NEXTU84 FORI=1TO3:K(I,1)=0:K(I,2)=0:NEXTI85 FOR I=1TO3:K(I,3)=0:NEXTI:Q$=Z$+Z$+Z$+Z$+Z$+Z$+Z$+LEFT$(Z$,17)86 A$="<E>":Z1=S1:Z2=S2:GOSUB468:IF K3<1THEN8987 FORI=1TOK3:GOSUB466:A$="<K>":Z1=R1:Z2=R288 GOSUB468:K(I,1)=R1:K(I,2)=R2:K(I,3)=S9*(0.5+RND(2)):NEXTI:IFCO>=1THENGOSUB31689 IFB3<1THEN9190 GOSUB466:A$=">S<":Z1=R1:B4=R1:Z2=R2:B5=R2:GOSUB46891 FORI=1TOS3:GOSUB466:A$=" * ":Z1=R1:Z2=R2:GOSUB468:NEXTI92 GOSUB34793 IF S+E>10THEN IF E>10 OR D(7)=0THEN10295 CLS:PRINTTAB(6);"* * * * FATAL ERROR * * * * "96 PRINT"YOU'VE JUST STRANDED YOUR SHIP IN SPACE!"98 PRINT"YOU HAVE INSUFFICIENT ENERGY FOR WARP":PRINT"SPEED AND SHIELD CONTROL IS PRESENTLY"100 PRINT"INCAPABLE OF CROSS-CIRCUITING TO ENGINE":PRINT"ROOM":GOSUB510:PRINT"THE ENTERPRISE IS DEAD IN SPACE":GOTO333102 CO=CO+1:PRINT"COMMAND - ";:GOSUB711:CLS103 FORI=1TO12:IFLEFT$(A$,3)<>MID$(A1$,3*I-2,3)THEN105104 ON I GOTO117,92,200,212,236,270,288,375,703,696,293105 NEXTI:PRINT"   * ENTER ONE OF THE FOLLOWING * ":PRINT:PRINT106 PRINT"  --------------------------------"107 PRINT"  NAV  --- SET COURSE"108 PRINT"  SRT  --- SHORT RANGE TACTICAL"109 PRINT"  LRS  --- LONG RANGE SCAN"110 PRINT"   F1  --- FIRE PHASERS"111 PRINT"   F2  --- FIRE PHOTON TORPEDOS"112 PRINT"  SHE  --- ADJUST SHIELD ENERGY"113 PRINT"  DAM  --- DAMAGE CONTROL REPORT"114 PRINT"  COM  --- USE LIBRARY COMPUTER"115 PRINT"  REP  --- REPAIR DAMAGE":PRINT"  DES  --- SELF DESTRUCT":PRINT"  END  --- END SIMULATION"116 PRINT"  --------------------------------":GOSUB510:GOTO92117 CLS:PRINT"        NAVIGATIONAL COURSE MAP":GOSUB 118:GOTO128118 LOCATE19,4:PRINT"3":LOCATE9,11:PRINT"5 . . . . * . . . . 1"119 LOCATE19,18:PRINT"7"122 LOCATE16,9:PRINT".  .  .":LOCATE16,13:PRINT".  .  ."123 LOCATE14,7:PRINT".    .    .":LOCATE14,15:PRINT".    .    ."124 LOCATE12,5:PRINT"4             2":LOCATE12,17:PRINT"6             8"127 LOCATE0,21:RETURN128 INPUT"COURSE (0-9)";C1:IF C1=9 THEN C1=1129 IF C1>=1 AND C1<9 THEN 131130 CLS:GOSUB513:PRINT"MR. SULU REPORTS: 'INCORRECT HEADING'":GOSUB510:GOTO92131 X$="8":IF D(1)<0THEN X$="0.2"132 PRINT"WARP FACTOR (0-";X$;")";:INPUT W1:IF D(1)<0AND W1>.2 THEN 138133 IF W1>0AND W1<=8THEN140134 IF W1=0THEN93135 CLS:GOSUB513:PRINT"SCOTTY REPORTS: 'MY ENGINES CANNA HANDLE  WARP"W1", CAPTAIN!'":GOSUB510:GOTO92138 CLS:GOSUB513:PRINT"SCOTTY REPORTS: 'MY ENGINES ARE DAMAGED, CAPN'N. WARP .2 IS THE BEST I CAN DO'":GOSUB510:GOTO92140 N=INT(W1*8+.5):IF E-N>=0THEN150141 CLS:GOSUB513:PRINT"SCOTTY REPORTS: 'THE MAIN ENERGIZER   CANNA HANDLE WARP"W1;:IFS>5 THEN PRINT"YE MIGHT TRY LOWERING THE SHIELDS A BIT'" ELSE PRINT"'"148 PRINT:GOSUB510:GOTO92149 GOTO92150 FOR I=1 TO K3:IF K(I,3)=0 THEN153151 A$="   ":Z1=K(I,1):Z2=K(I,2):GOSUB468:GOSUB466152 K(I,1)=Z1:K(I,2)=Z2:A$="<K>":GOSUB468153 NEXTI:GOSUB316:D1=0:D6=W1:IF W1>=1 THEN D6=1154 FORI=1TO8:IF D(I)>=0THEN159155 D(I)=D(I)+D6:IF D(I)>-.1 AND D(I)<0THEN D(I)=-.1:GOTO159156 IF D(I)<0THEN159157 IF D1<>1THEN D1=1:CLS:GOSUB513:PRINTTAB(9);"DAMAGE CONTROL REPORT:"158 R1=I:GOSUB473:PRINT"  "G2$;" REPAIR COMPLETED":GOSUB510159 NEXT I:IF RND(0)>.2THEN165160 R1=FNR(1):IF RND(0)>=.6THEN163161 D(R1)=D(R1)-(RND(0)*5+1):CLS:GOSUB513:PRINTTAB(9);"DAMAGE CONTROL REPORT:"162 GOSUB473:PRINT"  "G2$;" INOPERATIVE":GOSUB510:GOTO165163 D(R1)=D(R1)+RND(0)*3+1:CLS:GOSUB513:PRINTTAB(9);"DAMAGE CONTROL REPORT:"164 GOSUB473:PRINT" "G2$;" REPAIR IN PROGRESS":GOSUB510165 A$="   ":Z1=INT(S1):Z2=INT(S2):GOSUB468166 X1=C(C1,1)+(C(C1+1,1)-C(C1,1))*(C1-INT(C1)):X=S1:Y=S2167 X2=C(C1,2)+(C(C1+1,2)-C(C1,2))*(C1-INT(C1)):Q4=Q1:Q5=Q2168 FOR I=1TO N:S1=S1+X1:S2=S2+X2:IF S1<1 OR S1>=9 OR S2<1 OR S2>=9 THEN177169 S8=INT(S1)*24+INT(S2)*3-26:IF MID$(Q$,S8,2)="  "THEN 172170 S1=INT(S1-X1):S2=INT(S2-X2):CLS:GOSUB513:PRINT"  MR. SULU REPORTS: 'NAVIGATION ERROR,          CAPTAIN!'":GOSUB510:GOTO173172 NEXTI:S1=INT(S1):S2=INT(S2)173 A$="<E>":Z1=INT(S1):Z2=INT(S2):GOSUB468:GOSUB196:T8=1174 IF W1<1THEN T8=.1*INT(10*W1)175 T=T+T8:IF T>T0+T9 THEN331176 GOTO92177 X=8*Q1+X+N*X1:Y=8*Q2+Y+N*X2:Q1=INT(X/8):Q2=INT(Y/8):S1=INT(X-Q1*8)178 S2=INT(Y-Q2*8):IFS1=0THENQ1=Q1-1:S1=8179 IFS2=0THENQ2=Q2-1:S2=8180 X5=0:IFQ1<1THENX5=1:Q1=1:S1=1181 IFQ1>8THENX5=1:Q1=8:S1=8182 IFQ2<1THENX5=1:Q2=1:S2=1183 IFQ2>8THENX5=1:Q2=8:S2=8184 IFX5=0THEN194185 CLS:GOSUB513:PRINT"LT. UHURA REPORTS: 'MESSAGE FROM";186 PRINT" STAR-  FLEET COMMAND - ";187 PRINT"PERMISSION TO ATTEMPT   CROSSING OF GALACTIC PERIMETER IS";188 PRINT" HEREBY *DENIED*. SHUT DOWN YOUR";189 PRINT" ENGINES'":GOSUB510190 CLS:GOSUB513:PRINT"SCOTTY REPORTS: 'ENGINES SHUT DOWN AT   SECTOR"S1","S2"OF QUADRANT"Q1","Q2:GOSUB510193 IF T>T0+T9 THEN GOSUB513:PRINT"TIME HAS EXPIRED. THERE ARE"K9"KLINGONS LEFT":GOSUB510:GOTO333194 IF (8*Q1+Q2)=(8*Q4+Q5) THEN 173195 T=T+1:GOSUB196:GOTO47196 E=E-N-10:IFE>=0THENRETURN197 CLS:GOSUB513:PRINT"SHIELD CONTROL SUPPLIED ENERGY TO       COMPLETE THE MANEUVER.":GOSUB510198 S=S+E:E=0:IFS<=0THENS=0199 RETURN200 IFD(3)<0THENCLSELSEGOTO204201 GOSUB513202 PRINT"MR. SPOCK REPORTS:";203 PRINT" 'LONG RANGE SENSORS    AT  PRESENT ARE INOPERABLE.'":GOSUB510:GOTO92204 CLS:LOCATE8,0:PRINT"LONG  RANGE  SCAN  FOR    ":LOCATE13,1205 PRINT"QUADRANT"Q1","Q2:PRINT:PRINT206 O1$="      -------------------------":PRINTO1$207 FOR I=(Q1-1) TO (Q1+1):N(1)=-1:N(2)=-2:N(3)=-3:FOR J=(Q2-1) TO (Q2+1)208 IFI>0ANDI<9ANDJ<9THENN(J-Q2+2)=G(I,J):Z(I,J)=G(I,J)209 NEXTJ:PRINT"     ";:FORL=1TO3:PRINT  " :  " ;:IFN(L)<=0THENPRINT"*** ";:GOTO211210 PRINT RIGHT$(STR$(N(L)+1000),3);" ";211 NEXTL:PRINT " :":PRINTO1$:NEXTI:PRINT:PRINT:PRINTTAB(15);"SCAN KEY:":PRINT:PRINT"  # OF KLINGONS -> 214 <- # OF STARS":PRINTTAB(20);"^":PRINTTAB(13);"# OF STARBASES":PRINT:GOSUB510:GOTO92212 IFD(4)<0THENCLSELSE214213 GOSUB513:PRINT"MR. CHEKOV REPORTS: 'PHASERS INOPERATIVE, SIR'":GOSUB510:GOTO92214 IFK3>0THEN219215 CLS:GOSUB513:PRINT:PRINT"MR. CHEKOV REPORTS: 'NO ENEMY VESSELS IN THIS QUADRANT, CAPTAIN'":PRINT:GOSUB510:GOTO92219 CLS:PRINT:PRINT:INPUT"ENTER TARGET COORDINATES (X,Y)";TX,TY220 FORLQ=1TO3:IFK(LQ,1)=TX AND K(LQ,2)=TY THEN 222 ELSE NEXTLQ:PRINT:PRINT"MR. CHEKOV REPORTS: 'NO TARGETS AT      SPECIFIED COORDINATES":PRINT:GOSUB510:GOTO92222 PRINT:PRINT"MR. CHEKOV REPORTS: 'PHASERS LOCKED ON        TARGET'":PRINT:PRINT"ENERGY AVAILABLE =";E;"UNITS"223 INPUT"NUMBER OF UNITS TO FIRE";X:IFX<=0THEN92224 IFE-X<0THEN222225 IFD(7)<0THENX=XRND(0)226 H1=INT(X/K3):FORI=1TO3:IFK(I,3)<=0THEN235227 H=INT((H1/FND(2))*(RND(5)+2)):E=E-H1:IFH>.15*K(I,3)THEN229228 CLS:GOSUB513:PRINT"SENSORS SHOW NO DAMAGE TO ENEMY AT ";K(I,1);",";K(I,2):GOSUB510:GOTO235229 K(I,3)=K(I,3)-H:CLS:GOSUB513:PRINTH;"UNIT HIT ON KLINGON AT SECTOR             ";K(I,1);",";K(I,2)230 IFK(I,3)<=0THENPRINT"    ***KLINGON DESTROYED***"ELSE232231 GOSUB510:GOTO233232 PRINT" (SENSORS SHOW";K(I,3);"UNITS REMAINING)":GOSUB510:GOTO235233 K3=K3-1:K9=K9-1:Z1=K(I,1):Z2=K(I,2):A$="   ":GOSUB468234 K(I,3)=0:G(Q1,Q2)=G(Q1,Q2)-100:Z(Q1,Q2)=G(Q1,Q2):IFK9<=0THEN344235 NEXTI:GOSUB527:GOSUB316:GOTO92236 TF=0237 CLS:IFK3<1 THEN 215 ELSE IF P>0 THEN 238 ELSE GOSUB513:PRINT"MR. CHEKOV REPORTS: 'ALL PHOTON TORPEDOES EXPENDED'":GOSUB510:GOTO92238 IFD(5)>=0 THEN 240239 CLS:GOSUB513:PRINT"MR. CHEKOV REPORTS: 'PHOTON TORPEDOES     ARE NOT OPERATIONAL":GOSUB510:GOTO92240 PRINT"       PHOTON TORPEDO COURSE MAP":GOSUB 118:INPUT"PHOTON TORPEDO COURSE (1-9)";C1:IFC1=9THENC1=1241 IFC1>=1ANDC1<9THEN244 ELSE IFC1=0 THEN GOSUB527:GOSUB316:GOTO92242 CLS:GOSUB513:PRINT"MR. CHEKOV REPORTS: 'INCORRECT COURSE DATA'":GOSUB510243 GOTO92244 TF=TF+1:X1=C(C1,1)+(C(C1+1,1)-C(C1,1))*(C1-INT(C1)):E=E-2:P=P-1245 X2=C(C1,2)+(C(C1+1,2)-C(C1,2))*(C1-INT(C1)):X=S1:Y=S2246 CLS:GOSUB513:PRINT"  TORPEDO TRACK:"247 X=X+X1:Y=Y+X2:X3=INT(X+.5):Y3=INT(Y+.5)248 IFX3<1ORX3>8ORY3<1ORY3>8THEN269249 PRINT"               ";X3;",";Y3:A$="   ":Z1=X:Z2=Y:GOSUB482250 IFZ3<>0THEN247251 A$="<K>":Z1=X:Z2=Y:GOSUB482:IFZ3=0THEN256252 PRINT"    ***KLINGON DESTROYED***":GOSUB510:K3=K3-1:K9=K9-1:IFK9<=0THEN344253 FORI=1TO3:IFX3=K(I,1)ANDY3=K(I,2)THEN255254 NEXTI:I=3255 K(I,3)=0:GOTO267256 A$=" * ":Z1=X:Z2=Y:GOSUB482:IFZ3=0THEN258257 PRINT"STAR AT"X3","Y3"WENT NOVA DUE TO TORPEDO":PRINT:PRINT:S3=S3-1:GOTO704258 A$=">S<":Z1=X:Z2=Y:GOSUB482:IFZ3=0THEN240259 PRINT"    ***STARBASE DESTROYED***":B3=B3-1:B9=B9-1:IFB9<1THENPRINT:PRINT"THE LAST STARBASE HAS BEEN DESTROYED.   WHEN CURRENT SHIP'S SUPPLIES ARE       EXHAUSTED, YOUR MISSION WILL END"260 GOSUB510267 Z1=X:Z2=Y:A$="   ":GOSUB468268 G(Q1,Q2)=K3*100+B3*10+S3:Z(Q1,Q2)=G(Q1,Q2):FORLQ=1TO200:NEXTLQ:IFK3<1 THEN GOSUB527:GOSUB316:GOTO92 ELSEIFTF<2 AND K3>0THEN 237 ELSE GOSUB527:GOSUB316:GOTO92269 PRINT"           TORPEDO MISSED":FORLQ=1TO200:NEXTLQ:IF TF<2 THEN 237 ELSE GOSUB510:GOSUB527:GOSUB316:GOTO92270 IFD(7)>=0THENGOTO272271 CLS:GOSUB513:PRINT"   SHIELD CONTROL INOPERABLE":GOSUB510:GOTO92272 CLS:PRINT:PRINT"   #########################"273 PRINT"   #                       #"274 PRINT"   #     SHIELD-CONTROL    #"275 PRINT"   #                       #"276 PRINT"   #########################":PRINT277 PRINT"     ENERGY AVAILABLE =";E+S278 INPUT"     UNITS TO SHIELDS = ";X279 IF X<0 OR S=X THENPRINT:PRINT"      <SHIELDS UNCHANGED>":GOSUB510:GOTO92280 IF X<=E+S THEN285281 PRINT:PRINT:PRINT"MR. SPOCK REPORTS: 'IT IS ILLOGICAL TO  REQUEST MORE ENERGY THAN THE SHIP HAS   AVAILABLE'":X=0:GOTO279285 E=E+S-X:S=X:CLS:GOSUB513:PRINT"MR. CHEKOV REPORTS: 'SHIELDS AT"S"       UNITS PER YOUR ORDER, KEPTIN'":GOSUB510:GOTO92288 IFD(6)>=0THEN308289 CLS:GOSUB513:PRINT"MR. SPOCK REPORTS: 'DAMAGE CONTROL      COMPUTER NOT FUNCTIONING'":GOSUB510:GOTO92290 D3=0:FORI=1TO8:IFD(I)<0THEND3=D3+.1291 NEXTI:IFD3=0THEN93292 PRINT:D3=D3+D4:IFD3>=1THEND3=.9293 CLS:GOSUB294:GOTO300294 PRINT"         ##################"295 PRINT"         #                #"296 PRINT"         # DAMAGE CONTROL #"297 PRINT"         #                #"298 PRINT"         ##################"299 PRINT:RETURN300 ER=INT(RND(375)+25):TR=INT(RND(0)*10)/10:PRINT"REPAIR WILL COST"ER"ENERGY UNITS":PRINT"   AND TAKE"TR"STARDATES"301 IFER>=E+S THEN PRINT"UNABLE TO EFFECT REPAIR":PRINT:GOSUB527:GOTO92302 INPUT"WILL YOU AUTHORIZE REPAIR (Y/N)";A$:A$=LEFT$(A$,1):IFA$<>"Y" THEN 92303 FORI=1TO8:D(I)=0:NEXTI:T=T+TR:E=E-ER:IFE<=0 THEN E=E+S:S=0:PRINT"SHIELDS LOWERED DURING REPAIR. NOW AT 0 UNITS"304 PRINT:PRINT:PRINT"ENERGY LEVEL"E:PRINT"STARDATE"T:PRINT:PRINT:GOSUB510308 CLS:PRINT:PRINT"DEVICE                  CONDITION"309 PRINT"----------------------------------"310 FOR R1=1TO8311 GOSUB473:PRINTG2$;        LEFT$(Z$,25-LEN(G2$));:IFINT(D(R1)*100)*.01>=0 THEN PRINT"NOMINAL" ELSE ATTR4,0,B:PRINT"DAMAGED":ATTR3,0312 NEXTR1313 PRINT"----------------------------------"314 PRINT:IFD0<>0THENGOSUB510:GOTO290315 GOSUB510:GOTO92316 IFK3<=0THENRETURN317 IFD0<>0THENCLS:GOSUB513:PRINT"  STARBASE SHIELDS PROTECT THE":PRINT"           ENTERPRISE":GOSUB510:RETURN318 FOR I=1TO3:IF K(I,3)<=0THEN326319 H=INT((RND(K(I,3))/10)+INT(K(I,3))):S=S-H:K(I,3)=K(I,3)/(1+RND(0))320 CLS:GOSUB513:PRINTH;"UNIT HIT ON ENTERPRISE FROM KLINGON            AT SECTOR";K(I,1);",";K(I,2):PRINT321 IFS<=0THEN332322 PRINTTAB(6);"<SHIELDS DOWN TO";S;"UNITS>":GOSUB510:IFH<50THEN326323 IFRND(0)>.6ORH/S<=.02THEN326324 R1=FNR(1):D(R1)=D(R1)-H/S-.5*RND(0):GOSUB473325 CLS:GOSUB513:PRINT"MR. SPOCK REPORTS: '"G2$:PRINT"  HIT - NOW INOPERATIVE'":GOSUB510326 NEXTI:RETURN327 CLS:PRINT"     ###########################"328 PRINT"     #     END   OF   GAME     #"329 PRINT"     ###########################"330 PRINT:RETURN332 PRINT"ON STARDATE"T"THE ENTERPRISE WAS   DESTROYED. THE"K9"REMAINING KLINGON":PRINT"CRUISERS ATTACKED FEDERATION HQ AND     SCORED A MAJOR VICTORY"333 PRINT"YOUR MISSION WAS A COMPLETE FAILURE":GOTO346344 GOSUB327:PRINT"THE LAST KNOWN KLINGON CRUISER HAS BEEN DESTROYED. CONGRATULATIONS, CAPTAIN!":PRINT"ADVANCE INFORMATION CONFIRMS ANOTHER    SQUAD OF KLINGON CRUISERS APPROACHING   THE NEUTRAL ZONE"346 PRINT:PRINT:PRINT"PRESS 'F1' TO REENLIST, ANY OTHER KEY TOEND THIS MISSION":GOTO709347 GOTO351348 CLS:PRINT"     * * SHORT RANGE TACTICAL * *"349 PRINT"     QUADRANT";Q1;",";Q2" SECTOR";S1;","S2350 G5=0:GOSUB485:U=LEN(G2$):UU=20-(U/2):PRINT TAB(UU) G2$:RETURN351 FORI=S1-1TOS1+1:FORJ=S2-1TOS2+1352 IFINT(I+.5)<1ORINT(I+.5)>8ORINT(J+.5)<1ORINT(J+.5)>8THEN354353 A$=">S<":Z1=I:Z2=J:GOSUB482:IFZ3=1THEN355354 NEXTJ:NEXTI:D0=0:GOTO365355 LET D0=1:C$="DOCKED" :E=E0:P=P0356 CLS:PRINT:PRINT:PRINT357 PRINT"     ######################"358 PRINT"     #                    #"359 PRINT"     #   SHIELDS DROPPED  #"360 PRINT"     #     FOR DOCKING    #"361 PRINT"     #      PURPOSES      #"362 PRINT"     #                    #"363 PRINT"     ######################"364 S=0:FORU=1TO10:SOUND9,5:NEXTU:GOTO367365 IFK3>0THENC$="*RED*":GOTO367366 C$="GREEN":IFE<E0*.1THENC$="YELLOW" 367 IFD(2)>=0THEN369368 PRINT:PRINT "**SHORT RANGE TACTICAL IS OUT**":PRINT:RETURN369 GOSUB348:LQ=1:LET O1$= "   --------------------------------":PRINT:PRINT"     1   2   3   4   5   6   7   8":PRINT O1$:PRINTLQ" ";:LQ=LQ+1:FOR I=1TO8370 FORJ=((I-1)*24+1) TO ((I-1)*24+22) STEP 3:IFMID$(Q$,J,3)="<E>" THEN ATTR1,0 ELSE IFMID$(Q$,J,3)="<K>" THEN ATTR4,0,B ELSE IFMID$(Q$,J,3)=">S<" THEN ATTR2,0 ELSE ATTR 3,0371 PRINT" ";MID$(Q$,J,3);:ATTR3,0:NEXTJ:PRINT:IFI<>8 THENPRINTLQ" ";:LQ=LQ+1:NEXTI ELSE NEXTI:PRINTO1$372 PRINT"    STARDATE:";INT(T*10)*.1"DAYS LEFT:".1*INT((T0+T9-T)*10):PRINT"    ENERGY:"E"  SHIELDS:"S:PRINT"    TORPEDOS:"P;:IFP<10 THEN PRINT"   "; ELSE PRINT"  ";373 PRINT"KLINGONS:"K9:PRINT"    CONDITION: ";:IFC$="*RED*" THEN ATTR 4,0,B ELSE IF C$="YELLOW" THEN ATTR 2,0,B ELSE ATTR 1,0374 PRINTC$:ATTR 3,0:LOCATE7,21:RETURN375 IFD(8)<0THENCLS:GOSUB513:PRINT"MR. SPOCK REPORTS: 'COMPUTER OFFLINE -    DISABLED'":GOSUB510:GOTO92376 CLS377 PRINT"   ++++++++++++++++++++++++++":PRINT"   +                        +"378 PRINT"   +    LIBRARY-COMPUTER    +"379 PRINT"   +                        +"380 PRINT"   ++++++++++++++++++++++++++"383 PRINT"      COMPUTER FUNCTIONS:":PRINT384 PRINT" 1 = CUMULATIVE GALACTIC RECORD"386 PRINT" 2 = PHOTON TORPEDO DATA"387 PRINT" 3 = STARBASE NAV DATA"388 PRINT" 4 = NAVIGATION CALCULATOR":PRINT" 5 = STARBASE LOCATIONS"389 PRINT:INPUT"   YOUR COMMAND";CH:H8=1:ON CH GOTO391,420,463,426,713391 CLS:PRINT"    COMPUTER CHARTS OF THIS PARSEC":PRINT394 PRINT"     1   2   3   4   5   6   7   8 "395 O1$="    --- --- --- --- --- --- --- ---":PRINTO1$396 FORI=1TO8:PRINTI;397 FORJ=1TO8:PRINT" ";:IFZ(I,J)=0THENPRINT"***";:GOTO399398 PRINTRIGHT$(STR$(Z(I,J)+1000),3);399 NEXTJ:PRINT:PRINTO1$:GOTO403403 NEXTI:PRINT:GOSUB510:GOTO92420 IFK3<=0THEN215421 X$="":IFK3>1THENX$="S"422 CLS:PRINT"FROM ENTERPRISE TO KLINGON CRUISER";X$423 H8=0:FORI=1TO3:IFK(I,3)<=0THEN462424 W1=K(I,1):X=K(I,2)425 C1=S1:A=S2:GOTO447426 CLS:PRINT:PRINT" DIRECTION/DISTANCE CALCULATOR:"427 PRINT"CURRENT LOCATION: QUADRANT"Q1","Q2:C1=Q1:A=Q2:PRINT:PRINT437 PRINT"ENTER FINAL COORDINATES (X,Y)"438 U$=INKEY$:IFU$=""THEN438439 GOSUB518:IFU=0THEN438440 PRINTU;",";:W1=U441 U$=INKEY$:IFU$=""THEN441442 GOSUB518:IFU=0THEN441443 PRINTU:X=U444 CLS445 PRINT"FROM:  QUADRANT";C1;",";A446 PRINT"TO  :  QUADRANT";W1;",";X:PRINT447 X=X-A:A=C1-W1:IFX<0THEN455448 IFA<0THEN457449 IFX>0THEN451450 IFA=0THENC1=5:GOTO452451 C1=1452 IFABS(A)<=ABS(X)THEN454453 PRINT"       DIRECTION=";C1+(((ABS(A)-ABS(X))+ABS(A))/ABS(A)):GOTO461454 PRINT"       DIRECTION=";C1+(ABS(A)/ABS(X)):GOTO461455 IFA>0THENC1=3:GOTO458456 IFX<>0THENC1=5:GOTO452457 C1=7458 IFABS(A)>=ABS(X)THEN460459 PRINT"       DIRECTION=";C1+(((ABS(X)-ABS(A))+ABS(X))/ABS(X)):GOTO461460 PRINT"       DIRECTION=";C1+(ABS(X)/ABS(A))461 IFH8<>1 THEN 462 ELSE PRINT"       DISTANCE=";:IFCH=3 THEN PRINT (SQR(X^2+A^2)/10)-.1:GOSUB510:GOTO92 ELSE PRINTSQR(X^2+A^2):GOSUB510:GOTO92462 NEXTI:GOSUB510:GOTO92463 IFB3<>0THENCLS:PRINT"FROM ENTERPRISE TO STARBASE:":W1=B4:X=B5:GOTO425464 CLS:PRINT:PRINT"MR. SPOCK REPORTS: 'SENSORS SHOW NO     STARBASES IN THIS QUADRANT'":GOSUB510:GOTO92466 R1=FNR(1):R2=FNR(1):A$="   ":Z1=R1:Z2=R2:GOSUB482:IFZ3=0THEN466467 RETURN468 S8=INT(Z2-.5)*3+INT(Z1-.5)*24+1469 IFLEN(A$)<>3THENPRINT"ERROR":STOP470 IFS8=1THENQ$=A$+RIGHT$(Q$,189):RETURN471 IFS8=190THENQ$=LEFT$(Q$,189)+A$:RETURN472 Q$=LEFT$(Q$,S8-1)+A$+RIGHT$(Q$,190-S8):RETURN473 ON R1 GOTO 474,475,476,477,478,479,480,481474 G2$="WARP DRIVE":RETURN475 G2$="SHORT RANGE TACTICAL":RETURN476 G2$="LONG RANGE SENSORS":RETURN477 G2$="PHASER CONTROL":RETURN478 G2$="PHOTON TUBES":RETURN479 G2$="DAMAGE CONTROL":RETURN480 G2$="SHIELD CONTROL":RETURN481 G2$="LIBRARY-COMPUTER":RETURN482 Z1=INT(Z1+.5):Z2=INT(Z2+.5):S8=(Z2-1)*3+(Z1-1)*24+1:Z3=0483 IFMID$(Q$,S8,3)<>A$THENRETURN484 Z3=1:RETURN485 IF Z5<=4 AND Z4<=8 THEN ON Z4 GOTO 487,488,489,490,491,492,493,494486 GOTO495487 G2$="TRAKEN":GOTO504488 G2$="RIGEL":GOTO504489 G2$="PROCYON":GOTO504490 G2$="VEGA":GOTO504491 G2$="CANOPUS":GOTO504492 G2$="CLARKE'S STAR":GOTO504493 G2$="MEDEA":GOTO504494 G2$="POLLUX":GOTO504495 IF Z5>=5 AND Z4<=8 THEN ON Z4 GOTO 496,497,498,499,500,501,502,503496 G2$="SIRIUS":GOTO504497 G2$="DENEB":GOTO504498 G2$="CEREBRUS":GOTO504499 G2$="MEDUSA":GOTO504500 G2$="ANDROZANI":GOTO504501 G2$="REGULUS":GOTO504502 G2$="ARCTURUS":GOTO504503 G2$="CHARON":GOTO504504 IF G5<>1 AND Z5<=8 THEN ON  Z5 GOTO 506,507,508,509,506,507,508,509505 RETURN506 G2$=G2$+" I":RETURN507 G2$=G2$+" II":RETURN508 G2$=G2$+" III":RETURN509 G2$=G2$+" IV":RETURN510 PRINT:PRINTTAB(7);"PRESS <ENTER> WHEN READY"511 FORU=1TO80:U$=INKEY$:IFU$=CHR$(13)THEN512ELSENEXTU:GOTO511512 RETURN513 PRINT:PRINT"      ***************************"514 PRINT"      *  SUPPLEMENTARY STATUS   *"515 PRINT"      *         REPORT          *"516 PRINT"      ***************************":PRINT:PRINT517 RETURN518 IF U$="1"THENU=1:RETURN519 IF U$="2"THENU=2:RETURN520 IF U$="3"THENU=3:RETURN521 IF U$="4"THENU=4:RETURN522 IF U$="5"THENU=5:RETURN523 IF U$="6"THENU=6:RETURN524 IF U$="7"THENU=7:RETURN525 IF U$="8"THENU=8:RETURN526 U=0:RETURN527 IF K3<=0THENRETURN528 FORI=1TOK3:IFK(I,3)=0THEN531529 A$="   ":Z1=K(I,1):Z2=K(I,2):GOSUB468:GOSUB466530 K(I,1)=Z1:K(I,2)=Z2:A$="<K>":GOSUB468531 NEXTI:RETURN696 CLS:PRINT"ARE YOU SURE?"697 S$=INKEY$:IFS$=""THEN697698 IFS$<>"Y"THEN102ELSECLS:PRINT"   DESTRUCT SEQUENCE ENGAGED":FORX=1TO400:NEXTX:PRINT699 PRINT"          ENTER CODE":PRINT:FORX=1TO3:PRINT"  0   ";:FORY=1TO500:NEXTY:NEXTX:PRINT"DESTRUCT  ";:FORX=1TO100:NEXTX:PRINT"0":PRINT700 PRINT"     CODE SEQUENCE ACCEPTED":PRINT:PRINT"   BEGIN 30 SECOND COUNTDOWN":PRINT:FORX=30TO1STEP-1:PRINTX;:FORY=1TO750:NEXTY:NEXTX:PRINT701 PRINT"     ANTI-MATTER FIELD OFF":PRINT"            DESTRUCT":FORX=1TO900:NEXTX:FORX=1TO500:CLS5:NEXTX:FORX=1TO800:CLS1:NEXTX703 POKE&HFFD8,0:END704 IFK3=0THEN 92 ELSE TG=G(Q1,Q2):FORLQ=1TO3705 IFK(LQ,1)=X3 OR K(LQ,1)=X3+1 OR K(LQ,1)=X3-1 THEN707706 NEXTLQ:FORLQ=1TO100:NEXTLQ:G(Q1,Q2)=TG-1:IFTF=2 THEN 92 ELSE GOTO 269707 IFK(LQ,2)=Y3 OR K(LQ,2)=Y3+1 OR K(LQ,2)=Y3-1 THEN PRINT"NOVA DESTROYED KLINGON AT"K(LQ,1)","K(LQ,2):ER=INT(RND(500)):E=E-ER:PRINT"THE SHIP LOST"ER"ENERGY UNITS":PRINT"PROTECTING ITSELF FROM THE NOVA"708 X=K(LQ,1):Y=K(LQ,2):X3=K(LQ,1):Y3=K(LQ,2):GOTO251709 A$=INKEY$:IFA$=""THEN 709 ELSEIFA$="g"THEN 1 ELSE 703710 TM=RND(-TIMER):RETURN711 FK$=INKEY$:IFFK$=""THEN711712 IFFK$="g"THEN A$="PHA":RETURN ELSE IFFK$=CHR$(4)THEN A$="TOR":RETURN ELSE PRINTFK$;:LINEINPUTRT$:A$=FK$+RT$:RETURN713 CLS:LOCATE9,3:PRINT"STARBASE LOCATIONS:":PRINT:PRINT:FORL1=1TO8:FORL2=1TO8:IFG(L1,L2)<=9 THEN NEXTL2:NEXTL1:GOSUB510:GOTO92714 SB=G(L1,L2)/100:SB=INT((SB-INT(SB))*10):IFSB<=0 THEN NEXTL2:NEXTL1:GOSUB510:GOTO92715 PRINT"     QUADRANT"L1","L2:PRINT:NEXTL2:NEXTL1:GOSUB510:GOTO92