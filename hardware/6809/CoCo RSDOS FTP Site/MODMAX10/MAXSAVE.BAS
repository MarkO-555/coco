
10 POKE&HFFD9,0:CLEAR500,&H5FFF
20 DSKCON=PEEK(&HC004)*256+PEEK(&HC005)
30 WIDTH32:PRINT"PLEASE INSERT FORMATTED DISK AND        PRESS <ENTER>
40 EXEC44539
50 PRINT:PRINT"CHANGING FILE ALLOCATION TABLE..
60 DSKI$0,17,2,A$,B$
70 FORA=1 TO 56
80 MID$(A$,A,1)=CHR$(A)
90 NEXT
100 MID$(A$,57,1)=CHR$(&HC9)
110 DSKO$0,17,2,A$,B$
120 A$="":B$="":DSKI$0,17,3,A$,B$
130 MID$(A$,1,11)="MAX-10  BIN":MID$(A$,12,21)=CHR$(2)+CHR$(0)+CHR$(0)+CHR$(1)+STRING$(17,CHR$(0))
140 DSKO$0,17,3,A$,B$
150 PRINT"SAVING PROGRAM ON TRACK ...
160 FORA=0 TO 15 'BLOCK
180 POKE&HFFA3,A+30
190 FORB=0 TO 31 'PAGE IN BLOCK
200 PT=&H60+B:V=A*32+B:TR=INT(V/18):SE=V-(TR*18)+1:IF TR>16 THEN TR=TR+1
201 IF OT=TR THEN 210 ELSE PRINT OT;:OT=TR
210 GOSUB280
220 NEXTB,A
221 PRINT TR
230 '
240 POKE&HFFA3,2:PT=&H60:GOSUB280
250 POKE&HFFA3,10:SE=SE+1:PT=&H61:GOSUB280
260 PRINT"MAX-10 SAVED."
270 POKE&HFFD8,0:END
280 POKE&HFFD8,0:POKE&HEA,3:POKE&HEB,0:POKE&HEC,TR:POKE&HED,SE:POKE&HEE,PT:POKE&HEF,0:EXEC DSKCON:POKE&HFFD9,0:RETURN
