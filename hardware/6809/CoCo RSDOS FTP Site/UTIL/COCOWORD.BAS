1 'COCOWORD/BAS V1.0 Copyright 2/21/87 For nonprofit use of all2 'Written by Brian Stretch/Falcon Enterprizes3 'Call the Falcon's Lair BBS and see the HQ TUBBS system!4 'TUBBS is only $39.95 a copy! ($49.95 when V3.0 comes out)5 'Give it a call today! TUBBS runs on all CoCo's, but best on the CoCo3!6 ' The Falcon's Lair BBS        ! TUBBS supports 300/1200/2400 baud modems,7 ' 300/1200 baud 10pm-10am EST  ! 1-? drives, req's RS-232 Pak and MPI8 ' 10pm-4pm weekdaze            ! Coming soon: Network Mail!9 ' 313-429-2150 Running on a 512k CoCo3 and 1+MEG ONLINE! All for the CoCo3!10 CLEAR11000:PCLEAR1:DIML$(1500):CR$=CHR$(13):LF$=CHR$(10):BS$=CHR$(8):NU$=CHR$(0):BL$=CHR$(7):SC$=CHR$(92):LL=80:ONERRGOTO100020 PRINTCHR$(12);:CLS:PRINTTAB(34)"CoCo Word 3":PRINTTAB(23)"Copyright 2/21/87 by Brian Stretch":PRINT30 PRINT"<F>ile I/O"TAB(10)"<I>nsert"TAB(12)"<D>elete"TAB(12)"<E>dit"35 PRINT"<R>eplace"TAB(11)"<B>order"TAB(12)"<C>enter text"TAB(7)"<S>pecial F/X"40 PRINT"<L>ine length"TAB(7)"<?>Help"TAB(13)"<Q>uit"TAB(14)"<P>rint"50 PRINT"<N>ew"TAB(15)"<M>argin"TAB(12)"<G>lobal replace"60 PRINT"<ENTER> to continue"85 GOTO10089 'Ask Y/N90 PRINT"? (Y/N):";92 EXEC44539:A$=INKEY$:I=INSTR("NnYy",A$):IFI=0THEN92ELSEPRINTA$94 IFI<3THENA$="N":RETURNELSEA$="Y":RETURN95 'Check mem96 IFML>10000THENPRINT"**Outta room!":GOTO100ELSERETURN97 '# of lines98 PRINT"? (1 -"STR$(NL)") :";:INPUTX:RETURN99 'Command level100 ONERRGOTO1000:POKE41954,LL:PRINTCR$"Lines:"NL" Mem used:"ML" Filename: "F$CR$"Choice? :";105 EXEC44539:A$=INKEY$:A=ASC(A$):IFA>96ANDA<123THENA$=CHR$(A-32)110 I=INSTR(CR$+"?IDERLQPCNBMGFS",A$):IFI=0THEN105ELSEPRINTA$CR$:ONI GOTO200,20,250,300,350,400,450,500,550,600,650,700,750,800,850,1500199 'Continue entering text200 GOSUB96:PRINT"Line:"NL+1"Mem used:"ML205 NL=NL+1:LINEINPUTL$(NL):IFL$(NL)="@"THENNL=NL-1:GOTO100210 ML=ML+LEN(L$(NL)):GOTO200220 GOTO200249 'Insert250 IFNL=0THEN100ELSEGOSUB96:PRINT"Insert after what line? (0 to"STR$(NL)")? :";:INPUTX260 IFX<0THEN100ELSEIFX>=NL THEN200270 PRINT"Enter line:"275 LINEINPUTX$:FORY=NL TOX STEP-1:L$(Y+1)=L$(Y):NEXTY:L$(X+1)=X$:NL=NL+1280 ML=ML+LEN(X$):PRINT"Continue";:GOSUB90:IFA$="Y"THENX=X+1:GOTO275ELSE100299 'Delete300 IFNL=0THEN100ELSEPRINT"Delete starting where";:GOSUB98:IFX<1ORX>NL THEN100305 PRINT"# of lines? (1 -"STR$(NL-X+1)")";:INPUTN:IFN>NL-X+1ORN<1THEN100310 FORY=0TON-1:ML=ML-LEN(L$(X+Y)):L$(X+Y)=L$(X+Y+N):NEXTY:NL=NL-N315 FORY=X+N TONL+N:L$(Y)=L$(Y+N):NEXTY:GOTO100349 'Edit350 IFNL=0THEN100ELSEPRINT"Line to edit";:GOSUB98:IFX<1ORX>NL THEN100360 PRINTCR$"Present line reads:"CR$L$(X)CR$"Enter string to change:"365 LINEINPUTS$:IFS$=""THEN100ELSEI=INSTR(L$(X),S$):IFI=0THENPRINT"Non-existant!":GOTO100ELSES=LL-(LEN(L$(X))-LEN(S$)):PRINT"Enter new string (1 -"STR$(S)" chars):":POKE41954,S+1:LINEINPUTN$:POKE41954,LL370 ML=ML-LEN(L$(X)):L$(X)=LEFT$(L$(X),I-1)+N$+MID$(L$(X),I+LEN(S$)):ML=ML+LEN(L$(X)):PRINT"Line changed.":GOTO100399 'Replace400 IFNL=0THEN100ELSEPRINT"Replace which line";:GOSUB98:IFX<1ORX>NL THEN100405 PRINT"Enter new line:":LINEINPUTX$:ML=ML-LEN(L$(X))+LEN(X$):L$(X)=X$:GOTO100449 'Line Length450 PRINT"Current length:"LL:INPUT"Enter new length (CR=No change):";X460 IFX=0THEN100ELSELL=X:GOTO100499 'Quit500 PRINT"Are you sure";:GOSUB90:IFA$="Y"THENPOKE41954,255:CLEAR200:ENDELSE100549 'Print550 LP=0:PRINT"Print on the screen";:GOSUB90:IFA$="Y"THENDV=0ELSEDV=-2:INPUT"Upper margin";UP:INPUT"Lower margin";LW:PRINT#-2,STRING$(UP,13);552 INPUT"Starting line? (0=first):";Y:IFY<1THENY=1553 INPUT"Ending line? (0=last):";Z:IFZ<Y THENZ=NL555 PRINT"Include line #'s";:GOSUB90:IFA$="Y"THENDL=1ELSEDL=0560 FORX=Y TOZ:IFDL=1THENPRINT#DV,"Line"X:GOSUB580570 PRINT#DV,L$(X):GOSUB580:A$=INKEY$:IFA$="s"ORA$="S"THEN100ELSENEXTX:GOTO100580 IFDV<>-2THENRETURNELSELP=LP+1:IFLP+UP+LW=66THENPRINT#-2,STRING$(UP+LW,13);:LP=0585 RETURN599 'Center Text600 IFNL=0THEN100ELSEPRINT"Starting line";:GOSUB98:IFX<1ORX>NL THEN100605 INPUT"Ending line";Y:IFY<X ORY>NL THEN100610 FORZ=X TOY:N=LEN(L$(Z)):S$=STRING$(INT((LL-N)/2),32):ML=ML+LEN(S$):L$(Z)=S$+L$(Z):NEXTZ:GOTO100649 'New650 PRINT"About to clear memory!"CR$"Are you sure";:GOSUB90:IFA$="N"THEN100655 IFNL=0THEN100ELSEFORX=1TONL:L$(X)="":NEXTX:NL=0:ML=0:GOTO100699 'Border700 IFNL=0THEN100ELSEPRINT"Did you center the text";:GOSUB90:IFA$="N"THENA$="C":GOTO110705 PRINT"Starting line";:GOSUB98:IFX<1ORX>NL THEN100710 INPUT"Ending line";Y:IFY<X ORY>NL THEN100715 LINEINPUT"Boarder character(s):";B$:IFB$=""THEN100720 IFLEN(L$(X))>255-LL THENPRINT"Error! First line too long!":GOTO100725 C$="":B=LEN(B$):ML=ML-LEN(L$(X)):FORN=1TOINT((LL-1)/B):C$=C$+B$:NEXTN:L$(X)=C$+CR$+B$+MID$(L$(X),B+1)+STRING$(LL-1-LEN(L$(X))-B,32)+B$:ML=ML+LEN(L$(X))730 FORN=X+1TOY:ML=ML-LEN(L$(N)):L$(N)=B$+MID$(L$(N),B+1)+STRING$(LL-1-LEN(L$(N))-B,32)+B$:ML=ML+LEN(L$(N))735 NEXTN:ML=ML+LEN(C$)+1:L$(Y)=L$(Y)+CR$+C$:GOTO100749 'Margin750 IFNL=0THEN100ELSEPRINT"Starting line";:GOSUB98:IFX<1ORX>NL THEN100755 INPUT"Ending line";Y:IFY<X ORY>NL THEN100760 INPUT"Margin";Z:IFZ<1ORZ+LL>255THEN100765 FORN=X TOY:L$(N)=STRING$(Z,32)+L$(N):ML=ML+Z:NEXTN:GOTO100799 'Global search/replace800 IFNL=0THEN100ELSELINEINPUT"String to search for? :";S$:IFS$=""THEN100805 PRINT"Starting line";:GOSUB98:IFX<1ORX>NL THEN100810 INPUT"Ending line";Y:IFY<X ORY>NL THEN100815 LINEINPUT"Replace it with:";R$:FORN=X TOY820 I=INSTR(L$(N),S$):IFI=0THEN830ELSEML=ML-LEN(L$(N))825 L$(N)=LEFT$(L$(N),I-1)+R$+MID$(L$(N),I+LEN(S$)):ML=ML+LEN(L$(N)):GOTO820830 NEXTN:GOTO100849 'File I/O850 CLS:PRINTTAB(31)"File Input/Output"CR$855 PRINT"<L>oad"TAB(13)"<S>ave"TAB(13)"<D>irectory"TAB(9)"<C>hange default"860 PRINT"<A>bort"865 ONERRGOTO1000:PRINTCR$"Filename="F$"  Choice? :";870 EXEC44539:A$=INKEY$:A=ASC(A$):IFA>96ANDA<123THENA$=CHR$(A-32)875 I=INSTR("LSDCA",A$):IFI=0THEN870ELSEPRINTA$CR$:ONI GOTO900,925,950,975,100889 'Filename input890 POKE41954,15:LINEINPUT"Filename? :";G$:POKE41954,255:IFG$=""ANDF$=""THENRETURNELSEIFG$=""THENG$=F$:RETURNELSEIFINSTR(G$,".")>0ORINSTR(G$,"/")>0THEN894892 IFINSTR(G$,":")=0THENG$=G$+"/TXT"ELSEG$=LEFT$(G$,LEN(G$)-2)+"/TXT:"+RIGHT$(G$,1)894 IFLEN(G$)>14THENG$="":RETURNELSEF$=G$:RETURN899 'Load a file900 GOSUB890:IFG$=""THEN865ELSEPRINT"Erase file in memory";:GOSUB90905 IFA$="Y"THENNL=0:ML=0907 PRINT"Are you certain";:GOSUB90:IFA$="N"THEN865910 ONERRGOTO915:OPEN"I",#1,F$912 IFNOTEOF(1)THENLINEINPUT#1,X$:NL=NL+1:ML=ML+LEN(X$):L$(NL)=X$:GOTO912914 CLOSE:GOTO100915 PRINT"Bad filename!":CLOSE:GOTO865924 'Save a file925 IFNL=0THEN865ELSEGOSUB890:IFG$=""THEN865ELSEPRINT"Sure";:GOSUB90:IFA$="N"THEN925930 ONERRGOTO915:OPEN"O",#1,F$:FORX=1TONL:PRINT#1,L$(X):NEXTX:CLOSE:GOTO865949 'Directory950 PRINT"Drive #? :";:EXEC44539:A=VAL(INKEY$):ONERRGOTO960:IFA=0THENDIR:ELSEPRINTA;:DIRA955 PRINT" Free="FREE(PEEK(235))960 GOTO865974 'Change default drive975 INPUT"New default drive #";A:DRIVEA:GOTO865999 'Error Trap1000 PRINT"Error #"ERNO" in line"ERLIN"!!!":PRINT"Continue";:GOSUB901005 IFA$="Y"THEN100ELSESTOP1499 'Special F/X1500 PRINT"Sorry, this function is reserved for TUBBS 3.0...":GOTO100