5 ' ** CALENDAR III - BY BOB LAVINE (C) JULY 1987 **10 POKE65497,0:RGB:WIDTH80:PALETTE0,0:PALETTE8,0:PALETTE9,18:PALETTE10,27:PALETTE11,63:PALETTE12,60:PALETTE13,54:PALETTE14,61:PALETTE15,37:CLS115 CLEAR5000:DIMA(12),A$(12),B$(7),MO(250),DA(250),YR(250),C$(250),E$(100),V$(250),G2(30),G3(30):N=0:POKE150,717 ON ERR GOTO250018 ON BRK GOTO80520 A(1)=31:A(2)=28:A(3)=31:A(4)=30:A(5)=31:A(6)=30:A(7)=31:A(8)=31:A(9)=30:A(10)=31:A(11)=30:A(12)=31:PP$=STRING$(79," ")25 C=2:D$="*** CALENDAR III by Bob Lavine (C) July 1987 ***":LOCATE16,0:ATTR2,0:PRINTD$;:ATTR0,0:PRINT:GOSUB705:D$="Enter today's date (MM/DD/YY):  ":LOCATE20,6:ATTR4,0:PRINTD$;:ATTR1,0:LINEINPUTQ$:ATTR0,0:PRINT26 M=VAL(LEFT$(Q$,2)):AW=INSTR(1,Q$,"/"):D=VAL(MID$(Q$,AW+1,2)):Y=VAL(RIGHT$(Q$,2))30 D$="NEW DATA FILE (Y/N)  ":LOCATE(0+(79-LEN(D$))/2),12:ATTR4,0:PRINTD$;:ATTR0,0:LOCATE78,1232 P$=INKEY$:IFP$=""THEN32ELSEIFP$="Y"THEN35ELSEGOSUB75535 D1=1:IG=0:DG=0:GOSUB285:GOSUB120:GOTO5550 CLS:END55 CLS60 L=A(M):IF(M=2)*((INT(Y/4))*4=Y)THENL=2965 P=T:K=2:K1=470 RESTORE:FORI=1TOM:READA$:NEXTI75 LOCATE2,0:ATTR5,0:PRINTA$;:LOCATE24,0:PRINTY+1900;:ATTR0,080 LOCATE2,2:ATTR2,0:PRINT"SUN MON TUE WED THU FRI SAT":ATTR3,085 J=K+(T*4)-487 JJ=0:FORO=1TO N:IFMO(O)=M THENJJ=JJ+1:G2(JJ)=DA(O):G3(JJ)=YR(O)88 NEXTO90 FORI=1TOL95 IFT>7THENT=1:J=2:K1=K1+298 X7=3:FORO=1TO JJ:IFG2(O)=I AND Y=>G3(O) THEN X7=7:GOTO10099 NEXTO:IFD=I THEN X7=5100 LOCATEJ,K1:ATTRX7,0:PRINTUSING"##";I;105 T=T+1:J=J+4110 NEXTI:D1=D:GOSUB120:GOTO185115 STOP120 IF(D>A(M))OR (D<1)THENRUN125 A=INT(Y/12):B=Y-(A*12):C=INT(B/4):T=A+B+C+D1130 ON M GOTO160,145,145,165,155,140,165,150,135,160,145,135135 T=T+1140 T=T+1145 T=T+1150 T=T+1155 T=T+1160 T=T+1165 IFT>7THENT=T-7170 IFT>7THEN165175 IF Y/4=INT(Y/4) AND M<3THENT=T-1180 RETURN185 RESTORE:FORI=1TO M:READA$:NEXTI190 FORI=(M+1) TO (12+T):READB$:NEXTI200 LOCATE2,K1+2:ATTR2,0:AA$=LEFT$(A$,3):PRINTAA$;:ATTR5,0:PRINTD;:ATTR2,0:PRINT" IS A  ";:ATTR6,0:PRINTB$;:ATTR0,0:LOCATE0,K1+3:GOSUB710235 LOCATE0,22:ATTR4,0:PRINTSTRING$(80,"=");:LOCATE0,23:PRINT" <B>ack <C>al <D>el <E>xit <F>wd <I>nput <L>ocate <N>ew <P>rint <S>ort <*>Instr";:ATTR0,0:LOCATE79,23240 P$=INKEY$:IFP$=""THEN240242 IFP$="P"THENGOSUB605:GOTO240245 IFP$="C"THEN35247 IFP$="N"THENRUN250 IFP$="F"THENM=M+1:IFM>12THENY=Y+1:M=1252 IFP$="L"THEN1005253 IFH1>1AND P$=CHR$(13)THEN1010255 IFP$="B"THENM=M-1:IFM<1THENY=Y-1:M=12257 IFP$="I"THEN905260 IFP$="F"ORP$="B"THEND=1:GOTO35262 IFP$="D"THEN1505265 IFP$="E"THEN805267 IFP$="S"THEN2000270 IFP$="*"THEN3000272 GOTO240285 IFM<1OR M>12THENRUN ELSEIFD<1OR D>31THENRUN ELSEIFY<1THENRUN ELSERETURN290 DATA JANUARY,FEBRUARY,MARCH,APRIL,MAY,JUNE,JULY,AUGUST,SEPTEMBER,OCTOBER,NOVEMBER,DECEMBER295 DATA SUNDAY,MONDAY,TUESDAY,WEDNESDAY,THURSDAY,FRIDAY,SATURDAY600 '** PRINTER ROUTINE *****605 LOCATE0,23:PRINTPP$;:IFPEEK(65314)=4THEN615610 SOUND200,1:LOCATE2,23:ATTR2,0:PRINT"PLEASE TURN PRINTER ON AND HIT <ENTER> OR <F1> TO EXIT";:ATTR0,0:LOCATE0,21611 P$=INKEY$:IFP$=""THEN611ELSEIFP$=CHR$(103)THEN35ELSEIFP$=CHR$(13)THEN605ELSE611615 LOCATE2,23:ATTR2,0:PRINT"                                *** PRINTING ***                  ";:ATTR0,0:LOCATE0,21:SOUND200,1:ATTR6,0617 FORNN=0TO21620 FORX=0TO79625 LOCATEX,NN:HSTATE$,WW,EE,RR630 PRINT#-2,E$;635 NEXTX,NN637 FORX=1TO12:PRINT#-2:NEXTX640 ATTR0,0:LOCATE0,21:SOUND200,1:GOTO35705 FORXX=1TO600:NEXTXX:RETURN710 D$="* * *  D A T E S  * * *":LOCATE44,0:ATTR5,0:PRINTD$;:ATTR0,0:PRINT" ";712 Z=2:FORX=1TO N:IFMO(X)=M AND Y=>YR(X) THEN LOCATE34,Z:ATTR1,0:PRINTUSING"##";MO(X);:PRINT"/";:PRINTUSING"##";DA(X);:PRINT"/";:PRINTUSING"##";YR(X);:GOTO720ELSE715713 PRINT" ";V$(X);:ATTR0,0:LOCATE34,Z+1:Z=Z+1:Q$(Z)=STR$(X):GOTO715714 PRINT" ";C$(X);:ATTR0,0:LOCATE34,Z+1:Z=Z+1:Q$(Z)=STR$(X)715 IFZ=22THEN716ELSENEXTX716 RETURN720 NU=INSTR(1,C$(X),"#"):IFNU>0THENYS=Y-YR(X) ELSE714725 IFYS<0THEN714ELSEV$(X)=LEFT$(C$(X),NU-1)+RIGHT$(STR$(YS),2)+RIGHT$(C$(X),LEN(C$(X))-NU-1):GOTO713730 STOP750 '** LOAD DAT FILE **755 N=0:POKE65496,0:OPEN"I",#1,"CALENDAR.DAT"760 IF EOF(1)=-1THEN770765 N=N+1:INPUT #1,MO(N),DA(N),YR(N),C$(N):GOTO760770 CLOSE #1:POKE65497,0:RETURN800 '** END PROGRAM ROUTINE **805 SOUND200,1:LOCATE2,18:ATTR7,0:PRINT"DO YOU REALLY WANT TO END THIS PROGRAM ";:ATTR6,0,B:PRINT" ?";:ATTR0,0:LOCATE78,18810 P$=INKEY$:IFP$=""THEN810ELSEIFP$="Y"THENCLS1:ATTR1,0:POKE65496,0:ENDELSE35815 STOP900 ' ** INPUT ROUTINE **905 IG=1:LOCATE0,23:PRINTPP$;:SOUND200,1:LOCATE0,23:ATTR4,0:PRINT" INPUT DATA AS: MM/DD/YY DATA.................. (46 Characters of data is MAX).";:ATTR0,0:LOCATE79,23:V5=1:Q$=""910 LOCATE2,19:ATTR7,0:PRINT"##/##/## /----/----/----/----/----/----/----//":ATTR1,0:LOCATE2,18911 P$=INKEY$:IFP$=""THEN911ELSEIFP$=CHR$(13)THEN912ELSEIFP$=CHR$(8)THENQ1=LEN(Q$):Q$=LEFT$(Q$,Q1-1):LOCATEV5,18:PRINT" ";:LOCATEV5,18:V5=V5-1:GOTO911ELSEV5=V5+1:IFV5=48THEN912ELSEQ$=Q$+P$:LOCATEV5,18:PRINTP$;:GOTO911912 AA=INSTR(1,Q$," "):IFAA<>9THEN35915 M2=VAL(LEFT$(Q$,2)):D2=VAL(MID$(Q$,4,2)):Y2=VAL(MID$(Q$,7,2)):A2=LEN(Q$):Q$=RIGHT$(Q$,A2-9)918 N=N+1:IG=0:MO(N)=M2:DA(N)=D2:YR(N)=Y2:C$(N)=Q$919 DF=0:SOUND200,1:LOCATE2,20:ATTR5,0:PRINT"  ** SAVE DATA TO MEMORY (Y/N) **";:ATTR7,0,B:PRINT"  ?";:ATTR0,0:PRINT"                     ";:DF=1:GOTO925920 ATTR0,0:LOCATE0,20:PRINTPP$;:SOUND200,1:LOCATE2,21:ATTR5,0:PRINT"  ** SAVE DATA TO DISK (Y/N) **";:ATTR7,0,B:PRINT"  ?  ";:ATTR0,0:PRINT" ";:DF=2925 P$=INKEY$:IFP$=""THEN925ELSEIFP$="Y"THEN928ELSEIFDF=2AND IG=1THENN=N-1:GOTO35ELSEIFDF=2 AND IG<>1 THEN35ELSEN=N-1:GOTO35928 IFDF=1THEN920ELSE930930 LOCATE0,21:PRINTPP$;:SOUND200,1:LOCATE2,21:ATTR7,0:PRINT"  ** SAVING DATA TO DISK **";:ATTR0,0:PRINT" ";:POKE65496,0940 OPEN"O",#1,"CALENDAR.DAT"945 FORX=1TO N:WRITE #1,MO(X),DA(X),YR(X),C$(X):NEXTX:CLOSE #1950 SOUND200,1:OPEN"O",#1,"CALENDAR.BAK"955 FORX=1TO N:WRITE #1,MO(X),DA(X),YR(X),C$(X):NEXTX:CLOSE #1995 POKE65497,0:GOTO351000 '** SEARCH ROUTINE **1005 LOCATE0,23:PRINTPP$;:SOUND200,1:LOCATE2,23:ATTR4,0:PRINT"***************** LOCATE: MM/YY - MM/DD/YY - DATA - <N>EXT *****************";:ATTR0,0:LOCATE78,231010 LOCATE2,18:ATTR5,0:PRINT"ENTER SEARCH DATA";:ATTR0,0:PRINT" ";:LOCATE2,20:ATTR1,0:PRINT"";:LINEINPUTQ$:ATTR1,0:LOCATE78,201015 IFQ$="N"THEN1135ELSEIFQ$=""THEN35ELSEIFMID$(Q$,6,1)="/"THEN1040ELSEIFMID$(Q$,3,1)="/"THEN1080ELSE11201040 M=VAL(LEFT$(Q$,2)):D=VAL(MID$(Q$,4,2)):Y=VAL(MID$(Q$,7,2))1045 GOTO351080 M=VAL(LEFT$(Q$,2)):D=1:Y=VAL(MID$(Q$,4,2))1085 GOTO351120 Y=87:W$=Q$1125 FORBB=1TO N1130 IFINSTR(C$(BB),W$)THENM=MO(BB):D=1:GOTO351135 NEXTBB:CLS:SOUND200,1:LOCATE2,5:ATTR2,0:PRINT"*** ALL RECORDS LOCATED ***";:ATTR0,0:LOCATE0,6:GOSUB7051140 GOTO351500 '** DELETE ROUTINE **1505 DG=1:LOCATE0,23:PRINTPP$;:SOUND200,1:LOCATE2,23:ATTR4,0:PRINT"** DELETE DATA LINE BY PRESSING ARROWS TO DATA LINE -- THEN PRESS <ENTER> **";:ATTR0,0:LOCATE78,231507 H=2:GOTO15201510 P$=INKEY$:IFP$=""THEN15101513 IFP$="^"THENLOCATE32,H:PRINT" ";:H=H-1:IFH<2THENH=21515 IFP$=CHR$(10)THENLOCATE32,H:PRINT" ";:H=H+1:IFH>Z-1 THENH=H-11520 LOCATE32,H:ATTR5,0:PRINT">";:ATTR0,0:LOCATE32,H+1:PRINT" ";1525 IFP$=CHR$(13)THEN15301527 GOTO15101530 Q=VAL(Q$(H+1)):LOCATE34,H:ATTR6,0,B:PRINTUSING"##";MO(Q);:PRINT"/";:PRINTUSING"##";DA(Q);:PRINT"/";:PRINTUSING"##";YR(Q);:PRINT" ";C$(Q);:ATTR0,0:LOCATE31,H+11535 LOCATE2,18:ATTR7,0:PRINT"DELETE THIS DATA LINE (Y/N)  ";:ATTR4,0,B:PRINT"?";:ATTR0,0:PRINT" ";1540 P$=INKEY$:IFP$=""THEN1540ELSEIFP$="Y"THEN1545ELSE351545 LOCATE0,18:PRINTPP$;:LOCATE2,18:ATTR5,0:PRINT"* * *  D E L E T I N G   L I N E   # ";Q;:ATTR0,0:PRINT" ";:SOUND200,1:FORX=1TO600:NEXTX1550 FORX=Q TO N-1:MO(X)=MO(X+1):DA(X)=DA(X+1):YR(X)=YR(X+1):C$(X)=C$(X+1)1555 NEXTX:N=N-1:LOCATE0,18:PRINTPP$;:GOTO9202000 '** SORT ROUTINE **2005 IFN<=1THEN35ELSESOUND200,1:LOCATE2,18:ATTR7,0:PRINT"* * *  S O R T I N G  * * *";:ATTR0,0:LOCATE78,182010 FORX=1TO N-1:FORJ=X+1TO N:IFDA(X)<=DA(J)THEN20302015 T1=MO(X):T2=DA(X):T3=YR(X):T4$=C$(X)2020 MO(X)=MO(J):DA(X)=DA(J):YR(X)=YR(J):C$(X)=C$(J)2025 MO(J)=T1:DA(J)=T2:YR(J)=T3:C$(J)=T4$2030 NEXTJ:NEXTX2035 LOCATE0,18:PRINTPP$;:GOTO9202500 GOTO353000 '** INSTRUCTIONS ROUTINE **3005 GOSUB3990:LOCATE43,0:PRINTSTRING$(30," ");:SOUND200,1:LOCATE47,0:ATTR2,0:PRINT"** INSTRUCTIONS **";3010 LOCATE34,2:PRINT"<F> = Months forward";:LOCATE34,4:PRINT"<B> = Months backward";:LOCATE34,6:PRINT"<C> = Clear & restore last screen";:LOCATE34,8:PRINT"<N> = New restart of program";:LOCATE34,10:PRINT"<L> = Locate/Search by month/year or data -";3015 LOCATE34,11:PRINT"      which is the characters (text) - will";:LOCATE34,12:PRINT"      locate, if in file, and show month";:LOCATE34,13:PRINT"      and current year of first match. ";:LOCATE34,14:PRINT"      Pressing <L> for Locate and then";3020 LOCATE34,15:PRINT"      by pressing <N> from Locate Menu will";:LOCATE34,16:PRINT"      search for a second match, if found";:LOCATE34,17:PRINT"      will show that screen, etc. Entering";3025 LOCATE34,18:PRINT"      month/day/year will show screen for";:LOCATE34,19:PRINT"      that exact date. '##' will caluclate";:LOCATE34,20:PRINT"      number of years to current year.";:GOSUB3970:ATTR0,0:PRINT" ";:GOSUB39803030 '** SECOND SCREEN DATA **3035 LOCATE34,2:ATTR2,0:PRINT"<P> = Printer screen dump routine";:LOCATE34,4:PRINT"<I> = Input data. Data must be put in as:";:LOCATE34,5:PRINT"      00/00/00 WHATEVER TXT YOU WANT HERE and";3040 LOCATE34,6:PRINT"      must be no greater then 46 characters";:LOCATE34,7:PRINT"      long. If you do not know the year, then";:LOCATE34,8:PRINT"      enter 00 (zero-zero). If you need more";3045 LOCATE34,9:PRINT"      lines on an entry, you will need to";:LOCATE34,10:PRINT"      press <ENTER> and start again with the";:LOCATE34,11:PRINT"      same date and finish entry. You are";3050 LOCATE34,12:PRINT"      limited to a Max of 20 lines of data.";:LOCATE34,13:PRINT"      Enter ## to calculate # of years.";3052 LOCATE34,15:PRINT"<E> = Exit/End program w/excape back.";:GOSUB3970:ATTR0,0:LOCATE34,16:GOSUB39803055 '** THIRD SCREEN DATA **3060 LOCATE34,2:ATTR2,0:PRINT"<D> = Delete an entry. If you want to change";:LOCATE34,3:PRINT"      an entry, you should type in the new";:LOCATE34,4:PRINT"      entry in the Input mode, then Delete";3065 LOCATE34,5:PRINT"      the entry you don't want.";:LOCATE34,7:PRINT"<S> = Sort by Day. This will put your month";:LOCATE34,8:PRINT"      in order by days. After sorting, Save";3070 LOCATE34,9:PRINT"      to disk and you won't have to sort again.";:LOCATE0,10:PRINT" ";:LOCATE34,10:LOCATE34,11:PRINT"You can save your data to disk in some options";:LOCATE34,12:PRINT"and the program will create a data file named";3075 LOCATE34,13:PRINT"'CALENDAR.DAT'. It saves a backup copy, also.";:LOCATE34,14:PRINT"When you enter a 'N' for NEW FILE (Y/N), it";:LOCATE34,15:PRINT"will automatically load in file. Label and";3080 LOCATE34,16:PRINT"place all new files on a seperate disk or";:LOCATE34,17:PRINT"modify this program. You might have to change";:LOCATE34,18:PRINT"baud rate for printer - POKE150,7  (9600 BAUD)";3085 LOCATE34,19:PRINT"as double speed produces 2x4800 baud.";:GOSUB3970:ATTR0,0:LOCATE34,20:GOSUB39803090 GOTO353970 LOCATE47,21:ATTR7,0:PRINT"<ENTER> TO CONTINUE.";:ATTR0,0:LOCATE78,21:RETURN3980 P$=INKEY$:IFP$=""THEN39803985 IFP$=CHR$(103)THEN353990 EE=2:FORX=1TO20:LOCATE34,EE:PRINTSTRING$(46," ");:EE=EE+1:NEXTX:RETURN