10 '**RAINBOW-CALC SPREADSHEET**20 '  VERSION 1.0   2/20/8530 '  BY  FRED W. STRAUB35 PMODE0,1:GOTO500040 GOTO501050 XS=0:YS=0:XP=1:YP=160 FORY=1TO12:P=64+32*Y:PRINT@P,RIGHT$(STR$(YS+Y),2):POKE1024+P,PEEK(1024+P)-64:POKE1024+P+1,PEEK(1024+P+1)-64:NEXT70 PRINT@64,STRING$(32,128);:POKE1094,1+XS:POKE1104,2+XS:POKE1114,3+XS:FORX=1TO3:FORY=1TO12:XX=X+XS-1:YY=Y+YS-1:GOSUB80:NEXTY,X:GOTO19080 C$=C$(XX,YY):F$=MID$(C$,2,1):C=C(XX,YY):P=Y*32+X*10+56:IFLEN(C$)=2THENPRINT@P,STRING$(10,32);:GOTO15090 IFF$="0"THEN100ELSEIFF$="1"THEN110ELSEIFF$="2"THEN120ELSEIFF$="3"THEN130ELSE140100 IFABS(C)<9999999.5 THENPRINT@P,USINGP0$;C;:GOTO150 ELSE160110 IFABS(C)<999999.95 THENPRINT@P,USINGP1$;C;:GOTO150 ELSE160120 IFABS(C)<999999.995THENPRINT@P,USINGP2$;C;:GOTO150 ELSE160130 IFABS(C)<99999.9995THENPRINT@P,USINGP3$;C;:GOTO150 ELSE160140 PRINT@P,USINGPL$;MID$(C$,3);150 RETURN160 PRINT@P,USINGPL$;STRING$(10,42);:GOTO150190 X=XP:Y=YP:PRINT@0,STRING$(33,32)200 PRINT@0,STRING$(33,32):XX=X+XS-1:YY=Y+YS-1:Z$=CHR$(48+YY+1):IF(YY+1)>9THENZ$=CHR$(48+INT((YY+1)/10))+CHR$(48+YY+1-INT((YY+1)/10)*10)210 F$=LEFT$(C$(XX,YY),2):PRINT@0,CHR$(64+XX+1);Z$;:PRINT@4,"(";F$;") ";LEFT$(RIGHT$(C$(XX,YY),LEN(C$(XX,YY))-2),55);220 P=Y*32+X*10+56:POKESB,&H80:Z=USR0(P):XP=X:YP=Y230 I$=INKEY$:IFI$=""THENGOTO230ELSEAI=ASC(I$)240 IFAI=47THEN1700ELSEIFAI=12THEN430ELSEIFAI=94THEN260ELSEIFAI=10THEN270ELSEIFAI=8THEN280ELSEIFAI=9THEN290250 IFAI=95THENL=1:GOTO520ELSEIFAI=91THENL=1:GOTO530ELSEIFAI=21THENL=1:GOTO500ELSEIFAI=93THENL=1:GOTO510ELSEGOTO300260 IFY=1THENL=0:GOTO520ELSEY=Y-1:GOTO430270 IFY=12THENL=0:GOTO530ELSEY=Y+1:GOTO430280 IFX=1THENL=0:GOTO500ELSEX=X-1:GOTO430290 IFX=3THENL=0:GOTO510ELSEX=X+1:GOTO430300 IFAI<32ORAI>122THENSOUND200,1:GOTO430ELSEC$=I$310 IFLEFT$(F$,1)<>"F"THEN330ELSEPRINT@32,"PROTECTED FORMULA -- USE:  /eDIT";:SOUND200,1320 IFINKEY$=""THEN320ELSE430330 IFLEN(C$(XX,YY))>2THEN340ELSEIFF$="' "ANDAI>42ANDAI<58ANDAI<>44ANDAI<>47THENF$="N0"ELSEIFF$="' "AND(AI=40ORAI=64)THENF$="F0"340 PRINT@9,STRING$(32,32):PRINT@9,RIGHT$(C$,54);:IFLEN(C$)>250THENSOUND200,1:GOTO380350 I$=INKEY$:IFI$=""THEN350ELSEAI=ASC(I$):IFAI=13ORAI=9ORAI=10ORAI=94THEN380ELSEIFAI=12THEN430ELSEIFAI=8THEN360ELSEIFAI<32ORAI>122THENSOUND200,1:GOTO350360 IFAI=8 ANDLEN(C$)>0THENC$=LEFT$(C$,LEN(C$)-1):GOTO340 ELSEIFAI=8THENGOTO340370 C$=C$+I$:GOTO340380 C$(XX,YY)=F$+C$:F1$=LEFT$(F$,1)390 IFF1$="N"THENC(XX,YY)=VAL(C$):GOTO420400 IFF1$="F"THENC(XX,YY)=0:GOSUB700:GOTO420410 IFF1$="'"THENPRINT@P,STRING$(10,32);:GOTO420420 GOSUB80:IFAI=13THEN200ELSEPOKESB,&H80:Z=USR0(P):GOTO240430 POKESB,&H8B:Z=USR0(P):GOTO200500 IFXS=0THENSOUND220,1:GOTO430ELSEYP=Y:XP=1:IFL=1ANDXS>2THENXS=XS-3:XP=3:GOTO60ELSEXS=XS-1:GOTO60510 IFXS>=MX-2THENSOUND220,1:GOTO430ELSEYP=Y:XP=3:IFL=1ANDXS<=MX-5THENXS=XS+3:XP=1:GOTO60ELSEXS=XS+1:GOTO60520 IFYS=0THENSOUND220,1:GOTO430ELSEXP=X:YP=1:IFL=1THENYS=YS-10:YP=10:IFYS<0THENYS=0:GOTO60ELSEGOTO60    ELSEYS=YS-1:GOTO60530 IFYS>=MY-11THENSOUND220,1:GOTO430ELSEXP=X:YP=12:IFL=1ANDYS<MY-11THENYS=YS+10:YP=3:IFYS>MY-11THENYS=MY-11:GOTO60ELSE60  ELSEYS=YS+1:GOTO60600 T=1:IFC$<>""THENM$=MID$(C$,T,1):M=ASC(M$) ELSEZ$=C$:X1=0:GOTO630610 X1=M-64-1:Z$=""620 T=T+1:IFT>MC THEN630ELSEM$=MID$(C$,T,1):M=ASC(M$):IFM<48ORM>57THEN630ELSEZ$=Z$+M$:GOTO620630 Y1=VAL(Z$)-1:RETURN700 PRINT@34,"calculating--PLEASE WAIT":N=0:V1=0:VV=1:OP=1:S1=0:S2=0:C$=RIGHT$(C$(XX,YY),LEN(C$(XX,YY))-2):IFC$=""THEN1380710 MC=LEN(C$):T=1720 M$=MID$(C$,T,1):M=ASC(M$)730 IFM=32THENC$=LEFT$(C$,T-1)+RIGHT$(C$,MC-T):T=T-1:MC=LEN(C$):GOTO1290740 IFM<40ORM>90ORM=44THEN1500750 IFM>57ANDM<64THEN1500760 IFM$<>"@"THEN1010ELSEFM$=MID$(C$,T+1,4):IFFM$="INT("THENS2=S2+1:T=T+4:GOTO1290ELSEIFFM$="ABS("THENS2=S2+2:T=T+4:GOTO1290770 IFFM$="SUM("ORFM$="AVG("ORFM$="MIN("ORFM$="MAX("ORFM$="CNT("THENT=T+5:GOTO790ELSE900790 M$=MID$(C$,T,1):M=ASC(M$):IFM<65ORM>90THEN1500ELSEGOSUB610:IFX1>MX ORY1>MY ORX1<0ORY1<0 ORM$<>"."THEN1500ELSEX2=X1:Y2=Y1800 T=T+1:IFT>MC THEN1500ELSEM$=MID$(C$,T,1):IFM$="."THENT=T+1:M$=MID$(C$,T,1)810 M=ASC(M$):GOSUB610:IFX1>MX ORY1>MY ORX1<X2 ORY1<Y2 ORM$<>")"THEN1500ELSEF1=0:F2=0:F3=0:F4=999999999999999820 FORX3=X2 TOX1:FORY3=Y2 TOY1:IFC$(X3,Y3)<>"  "ANDC(X3,Y3)<>0 THENF1=F1+C(X3,Y3):F2=F2+1830 IFC(X3,Y3)>F3 THENF3=C(X3,Y3)840 IFC(X3,Y3)<F4 AND LEN(C$(X3,Y3))>2THENF4=C(X3,Y3)850 NEXTY3,X3:IFFM$="SUM("THENF0=F1 ELSEIFFM$="CNT("THENF0=F2 ELSEIFFM$="MAX("THENF0=F3 ELSEIFFM$="MIN("THENF0=F4 ELSEIFFM$="AVG("ANDF2>0THENF0=F1/F2 ELSEF0=0860 GOTO1130900 'SPACE FOR ADDITIONAL @ FUNCTIONS1000 IFM$="@"THEN15001010 IFM$="("ANDMID$(C$,T+1,1)="-"THENS1=1:T=T+1:GOTO12901020 IFM$="+"ORM$="-"ORM$="/"THENOP$(OP)=M$:OP=OP+1:GOTO12901030 IFM$="*"THENOP$(OP)="*":OP=OP+1:GOTO11201040 IFM=40ORM=41THEN12901050 IFM<58THEN10701060 GOSUB610:IFX1>MX ORY1>MY ORX1<0ORY1<0THEN1500ELSEF0=C(X1,Y1):GOTO11301070 IFM<45ORM>57ORM=47THEN1500ELSEC1$=M$1080 T=T+1:IFT>LEN(C$)THEN1100ELSEM$=MID$(C$,T,1):M=ASC(M$)1090 IFM<45ORM>57ORM=47THEN1100ELSEC1$=C1$+M$:GOTO10801100 F0=VAL(C1$):GOTO11301110 GOTO12901120 IFM$="*"ANDT+1<=LEN(C$)ANDMID$(C$,T+1,1)="*"THENT=T+1:OP$(OP-1)="**":GOTO1290 ELSE GOTO12901130 IFS1=1THENF0=F0*(-1):S1=01140 V(VV)=F0:VV=VV+1:T=T-11290 T=T+1:IFT<=MC THEN7201300 VV=1:V1=V(VV):VV=VV+1:IFOP=1THEN1370ELSEFORT=1TOOP-11310 IFOP$(T)="+"THENV1=V1+V(VV):VV=VV+1:GOTO13601320 IFOP$(T)="-"THENV1=V1-V(VV):VV=VV+1:GOTO13601330 IFOP$(T)="*"THENV1=V1*V(VV):VV=VV+1:GOTO13601340 IFOP$(T)="/"ANDV(VV)=0THENPRINT@0,"DIVISION BY ZERO AT ";CHR$(XX+64+1);RIGHT$(STR$(YY+1),LEN(STR$(YY+1))-1):GOTO1510 ELSE IFOP$(T)="/"THENV1=V1/V(VV):VV=VV+1:GOTO13601350 IFOP$(T)="**"THENV1=V1^V(VV):VV=VV+1:GOTO13601360 NEXT T1370 IFS2=1THENV1=INT(V1) ELSEIFS2=2THENV1=ABS(V1) ELSEIFS2=3THENV1=INT(ABS(V1))1380 C(XX,YY)=V11390 RETURN1500 PRINT@0,"FORMULA IN ERROR AT ";CHR$(XX+64+1);RIGHT$(STR$(YY+1),LEN(STR$(YY+1))-1);"  [";M$;"]"1510 SOUND200,1:C(XX,YY)=0:PRINT@32,"PRESS ANY KEY.   clear=SKIP ALL"1520 I$=INKEY$:IFI$=""THEN1520 ELSEPRINT@0,"":IFASC(I$)=12ORN=1THEN60 ELSEPRINT@32,"  calculating--PLEASE WAIT":GOTO13901700 XP=X:YP=Y:PRINT@0,"bLANK cOPY eDIT fORMAT gOTO lOAD pRINT sAVE tITLES uPDATE mORE1710 I$=INKEY$:IFI$=""THEN1710ELSEIFASC(I$)=12THEN4301720 PRINT@0,STRING$(33,32):PRINT@0,"";1730 IFI$="B"THENC(XX,YY)=0:C$(XX,YY)=LEFT$(C$(XX,YY),2):PRINT@P,STRING$(10,32);:GOTO2001740 IFI$="C"THEN2400ELSEIFI$="E"THEN2800ELSEIFI$="F"THEN2900ELSEIFI$="G"THEN2700ELSEIFI$="M"THEN18001750 IFI$="L"THEN2100ELSEIFI$="S"THEN2000ELSEIFI$="P"THEN2200ELSEIFI$="T"THEN2500ELSEIFI$="U"THEN19001790 SOUND220,1:GOTO17001800 PRINT@0," iNSERT-ROW  dELETE-ROW         cLEAR-WORKSHEET1810 I$=INKEY$:IFI$=""THEN1810ELSEIFASC(I$)=12THEN4301820 IFI$="I"THEN2550ELSEIFI$="D"THEN2600ELSEIFI$="C"THEN26501890 SOUND220,1:GOTO17001900 PRINT@34,"CALCULATING--PLEASE WAIT":FORYY=0TOMY:FORXX=0TOMX:F$=LEFT$(C$(XX,YY),1):IFF$="N"THEN C(XX,YY)=VAL(MID$(C$(XX,YY),3)):GOTO1920 ELSEIFF$<>"F"THENC(XX,YY)=0:GOTO19201910 GOSUB700:IFPEEK(1058)<>3THENPOKESB,&H80:Z=USR0(35)ELSEPOKESB,&H8B:Z=USR0(35)1920 NEXTXX,YY:GOTO 602000 IFDE=-1THEN2030ELSERF=0:PRINT@0,"SAVE WITH nEW NAME OR rEPLACE   OLD FILE--";TA$;"  (N/R)"2010 I$=INKEY$:IFI$=""THEN2010ELSEIFASC(I$)=12THEN1700ELSEIFI$="N"THENPRINT@0,STRING$(33,32):TA$=NA$:GOTO2030ELSEIFI$<>"R"ORTA$=""THENSOUND200,1:GOTO20102020 NA$=TA$:TA$="TEMP":RF=1:GOTO20502030 NA$="":PRINT@0,"":PRINT@32,"NEW FILENAME TO SAVE===>";2040 I$=INKEY$:IFI$=""THEN2040 ELSEAI=ASC(I$):IFAI=12THEN1700ELSEIFAI=13THENTA$=NA$:GOTO2050ELSEPRINTI$;:IFAI=8ANDLEN(NA$)>0THENNA$=LEFT$(NA$,LEN(NA$)-1):GOTO2040ELSENA$=NA$+I$:GOTO20402050 IFTA$=""THEN2000ELSEIFDE=1THENOPEN"O",#1,LEFT$(TA$+STRING$(8,32),8)+".CLC" ELSE OPEN"O",#-1,TA$2060 FORX3=0TOMX:FORY3=0TOMY:PRINT#DE,C$(X3,Y3):NEXTY3,X3:CLOSE2070 IFRF=1THENKILLNA$+".CLC":RENAMETA$+".CLC"TONA$+".CLC":TA$=NA$:GOTO430ELSEGOTO4302100 NA$="":PRINT@0,STRING$(33,32):PRINT@0,"FILE NAME TO LOAD ===>";2110 I$=INKEY$:IFI$=""THEN2110ELSEAI=ASC(I$):IFAI=12THEN1700ELSEIFAI=13THENGOTO2120 ELSEPRINTI$;:IFAI=8ANDLEN(NA$)>0THENNA$=LEFT$(NA$,LEN(NA$)-1):GOTO2110ELSENA$=NA$+I$:GOTO21102120 TA$=NA$:IFTA$=""THEN2100ELSEIFDE=1THENOPEN"I",#1,LEFT$(TA$,8)+".CLC" ELSE OPEN"I",#-1,TA$2130 FORX3=0TOMX:FORY3=0TOMY:LINEINPUT#DE,C$(X3,Y3):IFLEFT$(C$(X3,Y3),1)="N"THENC(X3,Y3)=VAL(MID$(C$(X3,Y3),3))ELSEC(X3,Y3)=02140 NEXTY3,X3:CLOSE:XS=0:YS=0:XP=1:YP=1:GOTO19002200 N=1:PRINT@0,STRING$(33,32):PRINT@0,"enter UPPER LEFT-HAND CORNER TO PRINT ===>";:C$=""2210 I$=INKEY$:IFI$=""THEN2210ELSEAI=ASC(I$):IFAI=12THEN430ELSEIFAI=13THEN2220ELSEPRINTI$;:IFAI=8ANDLEN(C$)>0THENC$=LEFT$(C$,LEN(C$)-1):GOTO2210ELSEC$=C$+I$:GOTO22102220 MC=LEN(C$):GOSUB600:IFX1>MX ORY1>MY THENSOUND200,1:GOTO2200ELSEIFX1<0ORY1<0THENX2=0:Y2=0:PRINT"A1"ELSEX2=X1:Y2=Y12225 PRINT@0,"enter LOWER RIGHT-HAND CORNER TO";:PRINT@54,"===>";:C$=""2230 I$=INKEY$:IFI$=""THEN2230ELSEAI=ASC(I$):IFAI=12THEN430ELSEIFAI=13THEN2240ELSEPRINTI$;:IFAI=8ANDLEN(C$)>0THENC$=LEFT$(C$,LEN(C$)-1):GOTO2230ELSEC$=C$+I$:GOTO22302240 MC=LEN(C$):GOSUB600:IFX1<0ORY1<0THENX1=MX:Y1=MY ELSEIFX1>MX ORY1>MY ORX1<X2 ORY1<Y2 THENSOUND200,1:GOTO22002245 PRINT@0,"CHECK THAT PRINTER IS READY AND ENTER OPTIONAL TITLE LINE.":C$=""2250 I$=INKEY$:IFI$=""THEN2250ELSEPRINT@0,STRING$(33,32):IFASC(I$)=13THEN2270ELSEIFASC(I$)=12THEN430ELSEC$=I$:PRINT@0,I$;2260 I$=INKEY$:IFI$=""THEN2260ELSEAI=ASC(I$):IFAI=13THEN2270ELSEPRINTI$;:IFAI=8ANDLEN(C$)>0THENC$=LEFT$(C$,LEN(C$)-1):GOTO2260ELSEC$=C$+I$:GOTO22602270 PRINT#-2,TAB(40-(LEN(C$)/2));C$:PRINT#-2,"":PRINT@0,"PLEASE WAIT FOR PRINTER         "2280 FORY3=Y2 TOY1:FORX3=X2 TOX1:F$=MID$(C$(X3,Y3),2,1):C=C(X3,Y3):PRINT#-2,TAB((X3)*9);2290 IFLEN(C$(X3,Y3))=2THENPRINT#-2,STRING$(10,32);:GOTO23602300 IFF$="0"THEN2310ELSEIFF$="1"THEN2320ELSEIFF$="2"THEN2330ELSEIFF$="3"THEN2340ELSE23502310 IFABS(C)<9999999.5 THENPRINT#-2,USINGP0$;C;:GOTO2360ELSE23702320 IFABS(C)<999999.95 THENPRINT#-2,USINGP1$;C;:GOTO2360ELSE23702330 IFABS(C)<999999.995 THENPRINT#-2,USINGP2$;C;:GOTO2360 ELSE23702340 IFABS(C)<99999.9995 THENPRINT#-2,USINGP3$;C;:GOTO2360ELSE23702350 PRINT#-2,USINGPL$;MID$(C$(X3,Y3),3); 2360 NEXTX3:PRINT#-2,CHR$(13);:NEXTY3:GOTO4302370 PRINT#-2,USINGPL$;STRING$(10,42);:GOTO23602400 PRINT@0,"enter CELL TO MOVE FROM===>     ":PRINT@27,"";:C$=""2410 I$=INKEY$:IFI$=""THEN2410ELSEAI=ASC(I$):IFAI=12THEN430ELSEIFAI=13THEN2420ELSEPRINTI$;:IFAI=8ANDLEN(C$)>0THENC$=LEFT$(C$,LEN(C$)-1):GOTO2410ELSEC$=C$+I$:GOTO24102420 MC=LEN(C$):GOSUB600:IFX1>MX ORY1>MY ORX1<0ORY1<0THENSOUND200,1:GOTO2400ELSEF1=X1:F2=Y1:PRINT@32,"MOVE TO===>?     THROUGH===>":PRINT@43,"";:C$=""2430 I$=INKEY$:IFI$=""THEN2430ELSEAI=ASC(I$):IFAI=12THEN430ELSEIFAI=13THEN2440ELSEPRINTI$;:IFAI=8ANDLEN(C$)>0THENC$=LEFT$(C$,LEN(C$)-1):GOTO2430ELSEC$=C$+I$:GOTO24302440 MC=LEN(C$):GOSUB600:IFX1>MX ORY1>MY ORX1<0ORY1<0THENSOUND200,1:GOTO2400 ELSEX2=X1:Y2=Y1:PRINT@60,"?":PRINT@60,"";:C$=""2450 I$=INKEY$:IFI$=""THEN2450ELSEAI=ASC(I$):IFAI=12THEN430ELSEIFAI=13THEN2455ELSEPRINTI$;:IFAI=8ANDLEN(C$)>0THENC$=LEFT$(C$,LEN(C$)-1):GOTO2450ELSEC$=C$+I$:GOTO24502455 MC=LEN(C$):IFMC<2THENX1=X2:Y1=Y2 ELSEGOSUB6002460 IFX1>MX ORY1>MY ORX1<X2 ORY1<Y2 THENSOUND200,1:GOTO2400ELSEFORX3=X2 TOX1:FORY3=Y2 TOY1:C$(X3,Y3)=C$(F1,F2):C(X3,Y3)=C(F1,F2):NEXTY3,X3:GOTO602500 X1=XX:Y1=YY:PRINT@0,"TITLES:  tOP  sIDE   bOTH"2510 I$=INKEY$:IFI$=""THEN2510ELSEIFI$="T"THENGOSUB2530:GOTO2520ELSEIFI$="S"THENGOSUB2540:GOTO2520ELSEIFI$="B"THENGOSUB2540:GOSUB2530:GOTO2520ELSEIFASC(I$)=12THEN430ELSEGOTO25102520 X=XP:Y=YP:XX=X1:YY=Y1:P=Y*32+X*10+56:IF(Y=1ANDI$<>"S")OR(X=1ANDI$<>"T")OR(Y=1ANDX=1)THEN200ELSE4302530 YY=0:Y=1:PRINT@96,CHR$(128);CHR$(116):FORX=1TO3:XX=XS+X-1:GOSUB80:NEXTX:RETURN2540 XX=0:X=1:PRINT@70,"t";:FORY=1TO12:YY=YS+Y-1:GOSUB80:NEXTY:RETURN2550 PRINT@0,"INSERTING MAY CAUSE FORMULAS TO BE WRONG!!  INSERT?  y/n"2560 I$=INKEY$:IFI$="N"THEN430ELSEIFI$="Y"THEN2570ELSE25602570 PRINT@43,"WAIT--inserting":FORY3=MY TOYY+1 STEP-1:FORX3=0TOMX:C$(X3,Y3)=C$(X3,Y3-1):C(X3,Y3)=C(X3,Y3-1):NEXTX3:NEXTY32580 FORX3=0TOMX:C$(X3,YY)="' ":C(X3,YY)=0:NEXTX3:GOTO602600 PRINT@0,"DELETING MAY CAUSE FORMULAS TO  BE WRONG!!   DELETE ??y/n"2610 I$=INKEY$:IFI$="N"THEN430ELSEIFI$="Y"THEN2620ELSE26102620 PRINT@43,"WAIT--deleting":FORY3=YY TOMY-1:FORX3=0TOMX:C$(X3,Y3)=C$(X3,Y3+1):C(X3,Y3)=C(X3,Y3+1):NEXTX3:NEXTY32630 FORX3=0TOMX:C$(X3,MY)="' ":C(X3,MY)=0:NEXTX3:GOTO602650 PRINT@0,"CLEARING WILL ERASE ENTIRE      WORKSHEET !!!    CLEAR??y/n"2660 I$=INKEY$:IFI$="N"THEN430ELSEIFI$="Y"THEN2670ELSE26602670 PRINT@46,"":FORX3=0TOMX:FORY3=0TOMY:C$(X3,Y3)="' ":C(X3,Y3)=0:NEXTY3:NEXTX3:GOTO502700 PRINT@0,STRING$(33,32):PRINT@0,"ENTER ADDRESS TO GO TO ===>";:C$=""2710 I$=INKEY$:IFI$=""THEN2710ELSEAI=ASC(I$):IFAI=12THEN430ELSEIFAI=13THEN2720ELSEPRINTI$;:IFAI=8ANDLEN(C$)>0THENC$=LEFT$(C$,LEN(C$)-1):GOTO2710ELSEC$=C$+I$:GOTO27102720 XP=1:YP=1:MC=LEN(C$):GOSUB600:IFX1>MX-2THENXS=MX-2ELSEIFX1<1THENXS=0ELSEXS=X12730 IFY1>MY-11THENYS=MY-11ELSEIFY1<1THENYS=0ELSEYS=Y12740 GOTO602800 F$=LEFT$(C$(XX,YY),2):C$=RIGHT$(C$(XX,YY),LEN(C$(XX,YY))-2):C1=1:PP=LEN(C$)+1:IFPP>64THENPP=642810 PRINT@0,STRING$(33,32);:PRINT@0,MID$(C$,C1,64);:Z=1023+PP:IFPEEK(Z)>63THENPOKEZ,PEEK(Z)-64ELSEPOKEZ,1282820 I$=INKEY$:IFI$=""GOTO2820ELSEAI=ASC(I$):IFAI=12THEN430ELSEIFAI=13THEN380ELSEIFAI=9THEN2830ELSEIFAI=8THEN2840ELSEIFAI=21THEN2850ELSE28602830 IFPP<64ANDC1+PP-2<LEN(C$)THENPP=PP+1:GOTO2810ELSEIFPP=64ANDC1+PP<LEN(C$)THENC1=C1+1:GOTO2810ELSESOUND200,1:GOTO28202840 IFPP>1THENPP=PP-1:GOTO2810ELSEIFPP=1ANDC1>1THENC1=C1-1:GOTO2810 ELSESOUND200,1:GOTO28202850 IFAI=21ANDPP>1THENC$=LEFT$(C$,C1+PP-3)+RIGHT$(C$,LEN(C$)-PP+1):PP=PP-1:GOTO28102860 IFAI>31ANDAI<123ANDLEN(C$)<250THENC$=LEFT$(C$,C1+PP-2)+I$+RIGHT$(C$,LEN(C$)-C1-PP+2):GOTO2830ELSESOUND200,1:GOTO28202900 PRINT@0,"ENTER FORMAT DESIRED:":PRINT@32,"  fORMULA     nUMBER    rEMOVE"2910 I$=INKEY$:IFI$=""THEN2910ELSEIFI$="N"THENF$="N"ELSEIFI$="F"THENF$="F"ELSEIFASC(I$)=12THEN1700ELSEIFI$="R"THENMID$(C$(XX,YY),1,2)="' ":C(XX,YY)=0:GOTO2960ELSESOUND200,1:GOTO29002920 PRINT@0,"ENTER NUMBER OF DECIMAL PLACES     0   1   2   3"2930 I$=INKEY$:IFI$=""THEN2930ELSEAI=ASC(I$):IFAI=12THEN1700ELSEIFAI<48ORAI>51THENSOUND200,1:GOTO29202940 F$=F$+I$:MID$(C$(XX,YY),1,2)=F$:C(XX,YY)=0:IFLEFT$(F$,1)="N"THENC(XX,YY)=VAL(RIGHT$(C$(XX,YY),LEN(C$(XX,YY))-2))2950 IFLEFT$(F$,1)="F"ANDLEN(C$(XX,YY))>2THENPRINT@0,"":GOSUB7002960 GOSUB80:GOTO2005000 CLS0:PRINT@297," RAINBOW-CALC ";:PMODE0,1:PCLEAR1:GOTO405010 CLEAR10400,32735:MX=8-1:MY=60-1:DIMC$(MX,MY),C(MX,MY),V(20),OP$(20)5020 PRINT@11,"PLEASE WAIT";:FORX3=0TOMX:FORY3=0TOMY:C$(X3,Y3)="' ":NEXTY3,X35030 PL$="%        %":P0$="#,###,###-":P1$="###,###.#-":P2$="######.##-":P3$="#####.###-"5040 IFPEEK(&HC000)=68ANDPEEK(&HC001)=75THENDE=1ELSEDE=-15050 FORX3=32736TO32765:READI$:POKEX3,VAL("&H"+I$):NEXT:DEFUSR0=32736:SB=327535060 DATA BD,B3,ED,C3,4,0,1F,1,C3,0,0A,ED,8D,0,D,A6,84,8B,40,A7,80,AC,8D,0,3,26,F4,39,0,05070 GOTO50