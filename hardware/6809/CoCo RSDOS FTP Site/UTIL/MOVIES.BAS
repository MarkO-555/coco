5 '  *** STARTUP FOR 80 COLUMN CONFIQURATION. (VALUES FOR RGB MONITOR) ***7 CLEAR6000:FILES1,1000:FILES2,1000:DIMH$(600),X$(300):RGB:POKE150,418 POKE65497,09 ON BRK GOTO300010 POKE&HE047,0:REM BOARDER COLOR15 POKE&HFFB8,18:REM TEXT COLOR (GREEN)20 POKE&HFFB0,0:REM BACKGROUND COLOR (BLACK-SAME AS THE BORDER)25 FORX=1TO7:READA,B:PALETTEA,B:NEXTX:WIDTH80:SOUND200,2:R=0:ZZ=0:ST$=STRING$(80," ")30 DATA0,0,10,29,11,37,12,60,13,54,14,63,15,6135 LOCATE34,11:ATTR2,0:PRINT"M";:ATTR0,0:PRINT" ";:ATTR3,0:PRINT"O";:ATTR0,0:PRINT" ";:ATTR4,0:PRINT"V";:ATTR0,0:PRINT" ";:ATTR5,0:PRINT"I";:ATTR0,0:PRINT" ";:ATTR6,0:PRINT"E";:ATTR0,0:PRINT" ";:ATTR7,0:PRINT"S";:GOSUB200040 LOCATE34,12:ATTR1,0,B:PRINT"-----------";:GOSUB2000:FORX=1TO1000:NEXTX42 GOSUB36545 CLS1:Q$="***** MOVIE MENU *****":LOCATE(0+(79-LEN(Q$))/2),2:ATTR2,0:PRINTQ$;:GOSUB200050 X=28:Y=5:LOCATEX,Y:ATTR5,0:PRINT"1 - ADD NEW MOVIES";:GOSUB2000:LOCATEX,Y+2:PRINT"2 - DELETE OLD MOVIES";:GOSUB2000:LOCATEX,Y+4:PRINT"3 - LIST CURRENT MOVIES";:GOSUB2000:LOCATEX,Y+6:PRINT"4 - SORT CURRENT MOVIES";:GOSUB200055 LOCATEX,Y+8:PRINT"5 - SEARCH FOR A MOVIE";:GOSUB2000:LOCATEX,Y+10:PRINT"6 - PRINT A MOVIE LIST";:GOSUB2000:LOCATEX,Y+12:PRINT"7 - MOVIE DESCRIPTIONS";:GOSUB2000:LOCATEX,Y+14:PRINT"8 - END THIS PROGRAM";:GOSUB200058 ZZ$="####":LOCATE18,Y+17:ATTR7,0:PRINTUSINGZZ$;R;:PRINT" Movies on disk";:ATTR2,0:PRINT" / ";:ATTR3,0:PRINT"Choose (1-7) above";:ATTR4,0,B:PRINT"  ?";:GOSUB200060 I$=INKEY$:IFI$=""THEN60ELSEV=VAL(I$):IFV<1 OR V>9THEN6065 ONV GOTO 105,205,305,405,505,605,905,705100 '*** ADD MOVIES ***105 CLS1:Q$="ADD MOVIES":LOCATE(0+(79-LEN(Q$))/2),0:ATTR6,0:PRINTQ$;:GOSUB2000:GOSUB110:GOTO117110 LOCATE3,5:ATTR2,0:PRINT"Code   Title                            Time";:GOSUB2000115 LOCATE3,6:ATTR3,0:PRINT"----   -------------------------------  ----";:GOSUB2000:RETURN117 LOCATE3,9:ATTR1,0:PRINT"----   -------------------------------  ----";:GOSUB2000118 LOCATE3,8:ATTR1,0:LINEINPUTU1$:GOSUB125:D$=U1$+"   ":LOCATE10,8:LINEINPUTU2$:GOSUB130:D$=D$+U2$+"  ":LOCATE43,8:LINEINPUTU3$:GOSUB135:D$=D$+U3$120 IFD$=""THEN45ELSER=R+1:GOSUB805:LOCATE3,10:ATTR7,0:PRINT"SAVED *** ";:ATTR4,0:PRINT"ADD MORE MOVIES? (Y/N) ";:GOSUB2000122 I$=INKEY$:IFI$=""THEN122ELSEIFI$="Y"THENLOCATE0,8:ATTR0,0:PRINTST$;:LOCATE0,10:PRINTST$;:GOTO118ELSE45125 IFLEN(U1$)>4THENU1$=LEFT$(U1$,4)ELSEIFLEN(U1$)<4THENU1$=U1$+" ":GOTO125126 RETURN130 IFLEN(U2$)>31THENU2$=LEFT$(U2$,31)ELSEIFLEN(U2$)<31THENU2$=U2$+" ":GOTO130131 RETURN135 IFLEN(U3$)>4THENU3$=LEFT$(U3$,4)ELSEIFLEN(U3$)<4THENU3$=U3$+" ":GOTO135136 RETURN200 '*** DELETE MOVIES ***205 CLS1:Q$="DELETE MOVIE":LOCATE(0+(79-LEN(Q$))/2),0:ATTR7,0:PRINTQ$;:GOSUB2000210 LOCATE0,8:ATTR4,0:PRINT"There are ";R;" movies listed.  To DELETE a movie, the RECORD # must be known.  "215 PRINT"If RECORD # is not known, press <F1>, this will return you to the menu where youmay LIST movies to find the RECORD # of the movie you wish to DELETE.";:GOSUB2000220 LOCATE30,14:ATTR3,0:PRINT"DELETE RECORD # ";:ATTR6,0:LINEINPUTE$:E=VAL(E$):LOCATE26,14:ATTR0,0:PRINT" ";:GOSUB2000225 IFE<1 OR E>R THEN45ELSEFORX=8TO13:LOCATE0,X:PRINTSTRING$(80," ");:NEXTX230 GOSUB110:POKE65496,0:OPEN"D",#1,"MOVIES/DAT",48:GET#1,E:INPUT#1,D$:LOCATE3,8:ATTR1,0:PRINTD$;:ATTR3,0:PRINT"          DELETE (Y/N) ";:GOSUB2000:JJ$=MID$(D$,8,33):SP=INSTR(1,JJ$,"  "):JJ$=LEFT$(JJ$,SP)235 I$=INKEY$:IFI$=""THEN235ELSEIFI$="Y"THEN240ELSECLOSE#1:POKE65497,0:GOTO45240 OPEN"D",#2,"NEW/DAT",48245 IFE-1<=0THEN246ELSEFORX=1TO E-1:GET#1,X:INPUT#1,D$:WRITE#2,D$:PUT#2,X:NEXTX246 IFE+1>R THEN247ELSEFORX=E+1 TO R:GET#1,X:INPUT#1,D$:WRITE#2,D$:PUT#2,X-1:NEXTX247 CLOSE:R=R-1:KILL"MOVIES/DAT":RENAME"NEW/DAT"TO"MOVIES/DAT"250 C=0:OPEN"D",#1,"DESCRIPT/DAT",255255 C=C+1:GET#1,C:INPUT#1,DES$:IFINSTR(LEFT$(DES$,20),JJ$)THEN265260 IFLOF(1)<>C THEN255ELSECLOSE:POKE65497,0:GOTO45265 OPEN"D",#2,"NEW/DES",255270 IFC-1<=0THEN271ELSEFORX=1TO C-1:GET#1,X:INPUT#1,DES$:WRITE#2,DES$:PUT#2,X:NEXTX271 IFC+1>ZZ THEN272ELSEFORX=C+1 TO ZZ:GET#1,X:INPUT#1,DES$:WRITE#2,DES$:PUT#2,X-1:NEXTX272 CLOSE:ZZ=ZZ-1:KILL"DESCRIPT/DAT":RENAME"NEW/DES"TO"DESCRIPT/DAT"295 POKE65497,0:SOUND200,1:LOCATE32,17:ATTR5,0,B:PRINT"*** DELETED ***";:GOSUB2000:FORX=1TO1500:NEXTX:GOTO45300 '*** LIST MOVIES ***305 CLS1:Q$="LIST MOVIES":LOCATE(0+(79-LEN(Q$))/2),0:ATTR5,0:PRINTQ$;:GOSUB2000310 GOSUB110:N=0:T=8315 POKE65496,0320 OPEN"D",#1,"MOVIES/DAT",48321 IFLOF(1)=N THENCLOSE#1:POKE65497,0:GOTO45325 N=N+1330 GET#1,N335 INPUT#1,D$340 LOCATE3,T:ATTR1,0:PRINTD$;:GOSUB2000:LOCATE60,T:ATTR4,0:PRINT"Record # ";:PRINTUSING"###";N;:GOSUB2000:IFT=20THEN350ELSET=T+1345 IFLOF(1)<>N THEN325350 IFLOF(1)=N THENQ$="END OF LIST":LOCATE(0+(79-LEN(Q$))/2),22:ATTR3,0:PRINTQ$;:GOSUB2000:SOUND200,1ELSEQ$="PRESS <ENTER> FOR MORE":LOCATE(0+(79-LEN(Q$))/2),22:ATTR6,0:PRINTQ$;:GOSUB2000355 I$=INKEY$:IFI$=""THEN355ELSEIFI$=CHR$(103)THENCLOSE#1:POKE65497,0:GOTO45ELSEIFI$=CHR$(13)THEN360ELSE355360 IFLOF(1)=N THENCLOSE#1:POKE65497,0:GOTO45ELSEFORX=8TO22:LOCATE0,X:ATTR0,0:PRINTST$;:NEXTX:T=8:GOTO325365 POKE65496,0:N=0367 OPEN"D",#1,"MOVIES/DAT",48368 IFLOF(1)=N THEN377369 N=N+1371 GET#1,N373 INPUT#1,D$375 IFLOF(1)<>N THEN369377 CLOSE#1:R=N379 I=0:OPEN"D",#1,"DESCRIPT/DAT",255381 IFLOF(1)=I THEN387383 I=I+1:GET#1,I:INPUT#1,DES$385 IFLOF(1)<>I THEN383387 CLOSE#1:ZZ=I389 RETURN400 '*** SORT MOVIES ***405 CLS1:Q$="SORT MOVIES":LOCATE(0+(79-LEN(Q$))/2),0:ATTR4,0:PRINTQ$;:GOSUB2000410 LOCATE7,8:ATTR7,0:PRINT"To sort by title press <ENTER>.  To exit back to menu press <M>.";:GOSUB2000:R=0412 I$=INKEY$:IFI$=CHR$(13)THEN413ELSEIFI$="M"THEN45ELSE412413 Q$="*** S O R T I N G ***":LOCATE(0+(79-LEN(Q$))/2),12:ATTR2,0,B:PRINTQ$;:GOSUB2000:POKE65496,0415 OPEN"D",#1,"MOVIES/DAT",48420 OPEN"D",#2,"NEW/DAT",48423 R=R+1425 GET#1,R:INPUT#1,D$:H$(R)=D$430 IFLOF(1)<>R THEN423432 CLOSE#1:POKE65497,0435 FORX=1TO R-1440 FORJ=X+1 TO R445 IFRIGHT$(H$(X),37)<=RIGHT$(H$(J),37) THEN455450 W$=H$(X):H$(X)=H$(J):H$(J)=W$455 NEXTJ:NEXTX:POKE65496,0460 FORX=1TO R:WRITE#2,H$(X):PUT#2,X:NEXTX:CLOSE#2462 CLOSE465 KILL"MOVIES/DAT":RENAME"NEW/DAT"TO"MOVIES/DAT"470 POKE65497,0:FORX=1TO R:H$(X)="":NEXTX475 LOCATE0,12:ATTR0,0:PRINTST$;:SOUND200,1:LOCATE16,12:ATTR5,0:PRINT"< < <  FINISHED SORTING ";R;" MOVIE TITLES  > > >";:GOSUB2000480 FORX=1TO2000:NEXTX:GOTO45500 '*** SEARCH MOVIES ***505 CLS1:Q$="SEARCH MOVIES":LOCATE(0+(79-LEN(Q$))/2),0:ATTR2,0:PRINTQ$;:GOSUB2000510 LOCATE0,5:ATTR4,0:PRINT"To search for a movie or movies, enter any title, word, letters, or other phraseto search by.  Listing, if found, will be all movies with your search criteria.";:GOSUB2000512 PRINT"PRESS (^) (up arrow) To PRINT this movie.";:GOSUB2000515 LOCATE11,10:PRINT"Enter search criteria -or- press <ENTER> to exit to menu.";:GOSUB2000520 LOCATE11,14:ATTR1,0:LINEINPUTF$:ATTR0,0:LOCATE79,14:GOSUB2000525 IFF$=""THEN45ELSEIFLEN(F$)>31THEN505ELSEFORK=5TO14:LOCATE0,K:ATTR0,0:PRINTST$;:NEXTK:GOSUB110530 POKE65496,0:N=0:T=8:Z=0535 OPEN"D",#1,"MOVIES/DAT",48540 N=N+1:GET#1,N:INPUT#1,D$:IFINSTR(D$,F$)THENZ=Z+1:X$(Z)=D$:LOCATE3,T:ATTR1,0:PRINTD$;:GOSUB2000:LOCATE60,T:ATTR4,0:PRINT"Record # ";:PRINTUSING"###";N;:GOSUB2000:IFT=20THEN550ELSET=T+1545 IFLOF(1)<>N THEN540550 IFLOF(1)=N THENQ$="END OF SEARCH":LOCATE(0+(79-LEN(Q$))/2),22:ATTR6,0:PRINTQ$;:GOSUB2000:SOUND200,1ELSEQ$="PRESS <ENTER> FOR MORE":LOCATE(0+(79-LEN(Q$))/2),22:ATTR6,0:PRINTQ$;:GOSUB2000555 I$=INKEY$:IFI$=""THEN555ELSEIFI$=CHR$(94)THENFORX=1TO Z:PRINT#-2,TAB(18);X$(X):NEXTX:GOTO560ELSEIFI$=CHR$(13)THEN560ELSE555560 IFLOF(1)=N THENCLOSE#1:POKE65497,0:GOTO45ELSEFORY=8TO22:LOCATE0,Y:ATTR0,0:PRINTST$;:NEXTY:T=8:GOTO540565 CLOSE:POKE65497,0:GOTO45600 '*** PRINT MOVIES ***605 CLS1:Q$="PRINT MOVIES":LOCATE(0+(79-LEN(Q$))/2),0:ATTR1,0:PRINTQ$;:GOSUB2000610 LOCATE0,5:ATTR6,0:PRINT"This section will print a list of all the movies on file.  If you want to print by selection (certain movies only) you need to go back to menu and select SEARCH"615 LOCATE0,7:PRINT"FOR MOVIE, Upon entering Search, enter title of movie you wish to print.  When  it comes up on the screen, PRESS (^) (up arrow), and program will print movie."620 PRINT:PRINT"To EXIT to MENU - PRESS <M>":GOSUB2000:PRINT:PRINT"To PRINT A LIST of your movies to DMP printer -   PRESS <ENTER>";:GOSUB2000625 I$=INKEY$:IFI$=""THEN625ELSEIFI$="M"THEN45ELSEIFI$=CHR$(13)THENFORX=5TO14:LOCATE0,X:ATTR0,0:PRINTST$;:NEXTX:POKE65496,0:GOSUB627:GOTO630ELSE625627 PRINT#-2,TAB(30);"*** MOVIE LIST ***":PRINT#-2,TAB(30);STRING$(18,"-"):PRINT#-2:PRINT#-2,TAB(17);"CODE";TAB(28);:PRINT#-2,USING"####";R;:PRINT#-2," TITLES OF MOVIES";TAB(57);"TIME":PRINT#-2:U=0:RETURN630 GOSUB110:N=0:T=8:OPEN"D",#1,"MOVIES/DAT",48635 N=N+1:GET#1,N:INPUT#1,D$:LOCATE3,T:ATTR5,0:PRINTD$;:GOSUB2000:LOCATE60,T:ATTR2,0:PRINT"Record # ";:PRINTUSING"###";N;:GOSUB2000640 U=U+1:PRINT#-2,TAB(17);D$:IFU=48THENFORX=1TO13:PRINT#-2:NEXTX:GOSUB627645 IFT=20THEN655ELSET=T+1650 IFLOF(1)<>N THEN635655 IFLOF(1)=N THENQ$="END OF LIST":LOCATE(0+(79-LEN(Q$))/2),22:ATTR7,0:PRINTQ$;:GOSUB2000:CLOSE#1:POKE65497,0:SOUND200,1:FORX=1TO1500:NEXTX:GOTO45660 FORX=8TO22:LOCATE0,X:ATTR0,0:PRINTST$;:NEXTX:T=8:GOTO635665 CLOSE:POKE65497,0:GOTO45700 '*** END PROGRAM ***705 CLS1:SOUND150,2:GOTO3000800 '*** SAVE TO DISK ***805 IFLEN(D$)>46THEND$=LEFT$(D$,46)807 POKE65496,0810 OPEN"D",#1,"MOVIES/DAT",48815 WRITE#1,D$820 PUT#1,R825 CLOSE#1830 POKE65497,0:RETURN900 '*** MOVIE DESCRIPTIONS ***905 WIDTH40:Q$="*** MOVIE DESCRIPTIONS ***":LOCATE(0+(39-LEN(Q$))/2),0:ATTR2,0:PRINTQ$;:GOSUB2000910 LOCATE0,4:ATTR4,0:PRINT"To view a movie description you need to enter all or part of the title you wish to view.  Located, description will be"915 PRINT"shown.  You may print out this screen toyour printer by pressing the up arrow.^"920 PRINT:PRINT"To EXIT to MENU press <M>.":PRINT:PRINT"To WRITE & SAVE description press <W>":PRINT:PRINT"To VIEW description of movie - <ENTER>";:GOSUB2000925 I$=INKEY$:IFI$=""THEN925ELSEIFI$="M"THENWIDTH80:GOTO45ELSEIFI$="W"THEN955ELSEIFI$=CHR$(13)THEN930ELSE925930 PRINT:PRINT:PRINT:PRINT:ATTR1,0:PRINT"ENTER MOVIE TITLE: ";:ATTR5,0:LINEINPUTDD$:IFDD$=""THENWIDTH80:GOTO45ELSECLS1932 Q$="*** MOVIE DESCRIPTION ***":LOCATE(0+(39-LEN(Q$))/2),0:EE=RND(7):ATTREE,0:PRINTQ$;:GOSUB2000935 N=0:POKE65496,0:OPEN"D",#1,"DESCRIPT/DAT",255940 N=N+1:GET#1,N:INPUT#1,DES$:IFINSTR(LEFT$(DES$,20),DD$)THENEE=RND(7):LOCATE0,9:ATTREE,0:PRINTDES$;:GOSUB2000:Q$="<M> = Menu   <A> = Another Description":LOCATE(0+(39-LEN(Q$))/2),22:EE=RND(7):ATTREE,0:PRINTQ$;:GOSUB2000:CLOSE#1:POKE65497,0:GOTO945942 IFLOF(1)<>N THEN940ELSEQ$="NOT IN FILE":LOCATE(0+(39-LEN(Q$))/2),22:ATTR6,0:SOUND200,1:PRINTQ$;:GOSUB2000:CLOSE#1:POKE65497,0:FORX=1TO1500:NEXTX:WIDTH80:GOTO45945 I$=INKEY$:IFI$=""THEN945ELSEIFI$="M"THENWIDTH80:GOTO45ELSEIFI$="A"THEN905ELSEIFI$=CHR$(94)THEN946ELSE945946 POKE65496,0:FORX=9TO14:FORY=0TO39:LOCATEY,X:HSTATA$,BB,CC,FF:PRINT#-2,A$;:IFY=39THENPRINT#-2:NEXTY:NEXTX:PRINT#-2:PRINT#-2:POKE65497,0:GOTO905ELSENEXTY:NEXTX:PRINT#-2:PRINT#-2:POKE65497,0:GOTO905950 '*** SAVE DESCRIPTION DATA ***955 WIDTH40:Q$="*** SAVE DESCRIPTION ***":LOCATE(0+(39-LEN(Q$))/2),0:ATTR1,0:PRINTQ$;:GOSUB2000:LOCATE0,2:ATTR7,0:PRINT"Enter movie title then the description. Hit <ENTER> when all is finished.  You  are allowed 6 lines maximum for all.";:GOSUB2000957 FORX=9TO14:LOCATE0,X:ATTR3,0:PRINTSTRING$(40,".");:GOSUB2000:NEXTX960 LOCATE0,9:ATTR6,0:LINEINPUTDES$:CLS1:Q$="*** SAVING DESCRIPTION ***":LOCATE(0+(39-LEN(Q$))/2),11:EE=RND(7):ATTREE,0:PRINTQ$;:GOSUB2000965 IFLEN(DES$)>255THENDES$=LEFT$(DES$,255):POKE65496,0970 ZZ=ZZ+1:OPEN"D",#1,"DESCRIPT/DAT",255975 WRITE#1,DES$:PUT#1,ZZ:CLOSE#1:POKE65497,0980 LOCATE0,11:ATTR0,0:PRINTSTRING$(40," "):SOUND200,1:LOCATE12,11:ATTR5,0:PRINT"ANOTHER (Y/N)  ";:GOSUB2000:ATTR6,0,B:PRINT"?";:GOSUB2000985 I$=INKEY$:IFI$=""THEN985ELSEIFI$="Y"OR I$="y"THEN955ELSEWIDTH80:GOTO452000 POKE&HF812,&H21:POKE&HF91C,&H21:RETURN:REM ** VANISH CURSOR **3000 POKE65496,0:CLOSE:ATTR1,0:END