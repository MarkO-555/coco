0 '******VERSION 1.1*******10 '*** DIRECTORY UTILITY***20 '*******WRITTEN BY*******30 '*** DR. CHARLES SEA ****40 '*******11/22/83*********50 CLS0:PRINT@108,"COCODOC";:PRINT @201,"A DIR UTILITY";:PRINT@270,"BY";:PRINT@328,"DR. CHARLES SEA";:PRINT@396,"11/22/83";60 SCREEN 0,170 G=0100 CLEAR 5000110 DIM C$(11),D$(68),DD(23)120 F$(2)="##"+CHR$(223)+"%          %"199 ' GETS DIR AND SORTS200 FOR I=3 TO 11210 DSKI$ G,17,I,A$,B$220 IF LEFT$(A$,1)=CHR$(255) THEN 250230 C$(I)=A$+LEFT$(B$,127)240 NEXT I250 I=I-1:C=0260 FOR J=3 TO I270 FOR K=0 TO 7280 D$(C)=MID$(C$(J),K*32+1,8)+"/"+MID$(C$(J),K*32+9,3)290 OK$=LEFT$(D$(C),1)300 IF OK$=CHR$(0) OR OK$=CHR$(255) THEN 320310 C=C+1320 NEXT K330 NEXT J340 C=C-1399 'PRINTS DIR TO SCREEN400 ZZ=0:T=32410 FOR P=0 TO C STEP 24420 CLS0430 FOR Z=0 TO 23440 IF Z+P>67 THEN 520443 IF LEFT$(D$(Z+P),1)=CHR$(0) OR LEFT$(D$(Z+P),1)=CHR$(255) THEN 510446 IF LEFT$(D$(Z+P),1)=""THEN520450 PRINT@T,USING F$(2);Z+P;D$(Z+P);460 T=T+32470 IF T<402 THEN 510480 IF FLAG=1 THEN 500490 T=49:FLAG=1:GOTO510500 T=32:FLAG=0510 NEXT Z520 GOSUB600530 NEXT P599 'SUBROUTINE FOR EACH SCREEN600 PLAY"T100L24O3AA#A;":PRINT@448,"(N)EXT";:PRINT@456,"(K)ILL";:PRINT@464,"(C)OPY";:PRINT@472,"(R)UN";:PRINT@480,"(B)ACK";:PRINT@8,"WORK DRIVE #";G;:PRINT@488,"(D)RIVE,(M)EDIA CHANGE";620 Q$=INKEY$:IFQ$="" THEN 620630 IF Q$="N"THEN IF Z<C THEN RETURN ELSE PRINT@488,"THAT'S ALL OF DIR";STRING$(6,CHR$(192));:FORK=1TO300:NEXT:PRINT@488,"(D)RIVE, (M)EDIA CHANGE";635 IF Q$="B" THEN 400640 IF Q$="R" THEN 700650 IF Q$="K" THEN 800655 IF Q$="M" THEN 1600660 IF Q$="C" THEN 1100665 IF Q$="D" THEN 1500670 GOTO 620699 'SUBROUTINE TO RUN PROG.700 PRINT@488,"ENTER SELECTION #";STRING$(5,CHR$(192));:PRINT@505,"";:LINEINPUT X$:CLS0:X=VAL(X$)710 R$=RIGHT$(D$(X),3)715 D$(X)=D$(X)+":"+RIGHT$(STR$(G),1)720 IF R$="BAS" THEN PRINT@236,"LOADING";:PRINT@301,"BASIC";:SCREEN0,1:LOADD$(X),R730 IF R$="BIN" THEN PRINT@236,"LOADING";:PRINT@300,"MACHINE";:PRINT@359,"MAY OR MAY NOT RUN";:SCREEN0,1:LOADMD$(X):POKE&HFF40,0:EXEC740 PRINT@236,"NOT A PROG.";:SCREEN0,1:FORI=1TO300:NEXT:GOTO400750 GOTO620799 'SUBROUTINE TO KILL FILES800 PRINT@448,"(S)TART";:PRINT@456,"(Y)ES ";:PRINT@464," (N)O ";:PRINT@472,"(A)BORT";:PRINT@480,STRING$(8,CHR$(192));:PRINT@488,"ALSO USE UP/DOWN ARROWS";810 YY=0:XX=34:FORI=0TO23:DD(I)=0:NEXT:IF C>23 AND P>0 THEN C=C-24820 PRINT@XX,CHR$(159);830 Q$=INKEY$:IF Q$=""THEN 830835 IF Q$="A" THEN IF P>0 THEN C=C+24:GOTO400 ELSE 400840 IF Q$="N"THEN PRINT@XX,CHR$(223);:DD(YY)=0:YY=YY+1:XX=XX+32:GOTO920850 IF Q$="Y"THEN PRINT@XX,CHR$(191);:DD(YY)=1:YY=YY+1:XX=XX+32:GOTO920860 IF Q$="^"THEN IF DD(YY)=0 THEN PRINT@XX,CHR$(223); ELSE IF DD(YY)=1 THEN PRINT@XX,CHR$(191);870 IF Q$="^"THEN YY=YY-1:XX=XX-32:GOTO920880 IF Q$=CHR$(10) THEN IF DD(YY)=0 THEN PRINT@XX,CHR$(223); ELSE IF DD(YY)=1 THEN PRINT@XX,CHR$(191);890 IF Q$=CHR$(10) THEN YY=YY+1:XX=XX+32:GOTO920900 IF Q$="S" THEN 950910 GOTO830920 IF YY>C THEN YY=0 ELSE IF YY>23 THEN YY=0925 IF YY<0 AND C>23 THEN YY=23 ELSE IF YY<0 AND C<24 THEN YY=C:XX=(32*(YY+1))+2930 IF YY=0 THEN XX=34 ELSE IF YY=11 THEN XX=386 ELSE IF YY=12 THEN XX=51 ELSE IF YY=23 THEN XX=403940 GOTO820950 IF ZZ=1 THEN 1110 ELSE CLS0:R=98:PRINT@0,"KILLING THE FOLLOWING FILES";:PRINT@32,"FROM DRIVE #";G;:FORI=0 TO 23960 IF DD(I)=1 THEN PRINT@R,D$(I);:R=R+16:970 NEXT I980 PRINT@360,"ABORT (Y/N) :";990 Q$=INKEY$:IFQ$=""THEN 9901000 IF Q$="Y"THEN 4001010 IF Q$="N"THEN10301020 GOTO9901030 FOR I=0 TO 231040 IF DD(I)=1 THEN 1050 ELSE 10601050 D$(I)=D$(I)+":"+RIGHT$(STR$(G),1):KILL D$(I)1060 NEXTI:GOTO15101100 ZZ=1:GOTO8001110 CLS0:PRINT@2,"ONE OR TWO DRIVES :";1120 Q$=INKEY$:IF Q$="" THEN 11201130 IF Q$="1"THEN DR=1:GOTO11501140 IF Q$="2"THEN DR=2 ELSE 11201150 IF DR=1 THEN GT=0 ELSE IF DR=2 AND G=0 THEN GT=1 ELSE IF DR=2 AND G=1 THEN GT=01160 PRINT@2,"COPYING THESE FILES";:PRINT@34,"FROM DRIVE #";G;"TO DRIVE #";GT1170 R=98:FORI=0TO231180 IF DD(I)=1 THEN PRINT@R,D$(I);:R=R+161190 NEXT I1200 PRINT@360,"ABORT (Y/N) :";1210 Q$=INKEY$:IF Q$=""THEN12101220 IF Q$="Y"THEN 4001230 IF Q$="N"THEN IF DR=2 THEN 1250 ELSE 13101240 GOTO12101250 CLS0:PRINT@34,"COPYING FILE NOW:";:R=981260 FOR I=0 TO 231270 IF DD(I)=1 THEN 1280 ELSE 13001280 YA$=D$(I)+":"+RIGHT$(STR$(G),1):YB$=D$(I)+":"+RIGHT$(STR$(GT),1)1290 PRINT@R,D$(I);:R=R+16:COPY YA$ TO YB$1300 NEXT I:GOTO4001310 FOR I=0 TO 231320 IF DD(I)=1 THEN 1330 ELSE 13601330 CLS:PRINT@34,"FILE TO COPY: ";D$(I);:PRINT@98,"INSERT SOURCE DISKETTE";:PRINT@162,"PRESS <ENTER> TO CONTINUE";1340 Q$=INKEY$:IF Q$=""THEN13401350 COPY D$(I)1360 NEXT I1370 CLS:PRINT@34,"COPING DONE";:PRINT@98,"INSERT SOURCE DISKETTE";:PRINT@162,"PRESS <ENTER> TO CONTINUE";1380 Q$=INKEY$:IF Q$=""THEN13801390 GOTO4001500 CLS0:PRINT@34,"TWO DRIVES ARE PRESENT (Y/N)";1502 Q$=INKEY$:IF Q$="" THEN 15021504 IF Q$="Y" THEN 15081506 IF Q$="N" THEN 400 ELSE 15001508 IF G=1 THEN G=0 ELSE IF G=0 THEN G=11510 FOR I=1 TO 681520 D$(I)="":NEXT I1530 FOR I=1 TO 111540 C$(I)="":NEXT I1550 GOTO2001600 CLS:PRINT@34,"CHANGE DISKETTE FROM DRIVE #";RIGHT$(STR$(G),1);1610 PRINT@98,"PRESS ENTER TO CONTINUE";1620 Q$=INKEY$:IFQ$="" THEN16201630 PRINT@169,"***STANDBY***";:GO TO 1510