10 GOTO166020 REM BILL DREW30 REM 772 MAGNOLIA40 REM ST PAUL, MINNESOTA50 REM 5510660 ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''70 '          SET UP PARAMETERS75 CLS:PRINTTAB(9)"** BASICMAP **"80 PRINT:PRINT:PRINT:PRINT"DO YOU WANT INSTRUCTIONS, Y/N?90 A$=INKEY$:IFA$=""THEN90ELSEIFA$="Y"THENGOSUB1450100 CLEAR5000:DIM A$(20),GT$(150,1),GS$(100,1) 110 'A$ WILL HOLD SUB INSTRCTIONS120 'GS$ IS GOSUB, GT$ IS GOTO130 'GT$(J,0) IS THE DESTINATION140 'GT$(J,1) ARE THE SOURCE LINE150 PRINT:INPUT"OUTPUT TO SCREEN OR PRINTER,S/P";PF$:PF$=LEFT$(PF$,1)155 PRINT:INPUT"DO YOU WANT TO PRINT PROGRAM    LISTING ALSO (Y/N) ";ZZ$:SOUND 234,1160 PRINT:LINE INPUT "NAME OF BASIC PROGRAM INCLUDING EXTENSION : ";F$170 OPEN "I",#1,F$180 ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''190 '     READ, LIST AND CONTROL200 IF EOF(1)=-1 THEN CLOSE#1:GOSUB1181:END'PRINT AND END210 LINE INPUT#1,A$220 IF LEN(A$)=0 THEN 200225 IF ZZ$="Y" THEN GOTO 230 ELSE GOTO 240230 IF PF$="P"THENPRINT#-2,A$ELSE PRINTA$240 GOSUB340'STRIP BLANKS & PUT  LINE # INTO B$250 GOSUB400'REMOVE ALL STRING  CONSTANTS260 GOSUB450'REMOVE COMMENTS270 GOSUB510'BREAK UP IF-THEN    PUT EXPLICIT GOTOS280 GOSUB680'BREAK UP MULTIPLE   STATEMENT LINES290 GOSUB730'MAP OF GOTOS, COUNT OF GOTOS IN GC300 GOSUB 960'MAP OF GOSUB,COUNT OF GOSUBS IN GS310 GOTO200'READ NEXT LINE320 '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''330 '           STRIP LINE # AND PUT INTO B$340 B$=""350 B=ASC(A$):IFB<58ANDB>47THENB$=B$+CHR$(B):A$=RIGHT$(A$,LEN(A$)-1):GOTO350360 '         STRIP ALL BLANKS370 B=INSTR(A$," "):IFB=0THENRETURNELSEC$=LEFT$(A$,B-1):A$=RIGHT$(A$,LEN(A$)-B):A$=C$+A$:GOTO370380 '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''390 '           STRIP ALL QUOTES400 B=INSTR(A$,CHR$(34)):IFB=0THENRETURN410 C=INSTR(B+1,A$,CHR$(34)):IF C=0 THEN C=LEN(A$)420 C$=LEFT$(A$,B-1):A$=RIGHT$(A$,LEN(A$)-C):A$=C$+A$:GOTO400430 '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''440 '          STRIP COMMENTS450 B=INSTR(A$,"'"):IFB=0THEN470460 A$=LEFT$(A$,B-1):RETURN470 B=INSTR(A$,"REM"):IF B=0THENRETURN480 A$=LEFT$(A$,B-1):RETURN490 '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''500 '           BREAK UP IF-THEN510 B=INSTR(A$,"IF"):IFB=0THENRETURNELSEIFB=1THENA$=RIGHT$(A$,LEN(A$)-2):GOTO530520 C$=LEFT$(A$,B-1):A$=RIGHT$(A$,LEN(A$)-B-1):A$=C$+A$530 B=INSTR(A$,"IF"):IFB>0THEN520' REMOVE ALL IF'S540 B=INSTR(A$,"THEN") :IF B=0 THEN570550 C$=LEFT$(A$,B-1)+":":A$=RIGHT$(A$,LEN(A$)-B-3):C=ASC(A$):IF C<58ANDC>47 THENA$="GOTO"+A$560 A$=C$+A$:GOTO540'RMV THEN'S570 B=INSTR(A$,"ELSE"):IF B=0 THEN P=2:GOTO600580 C$=LEFT$(A$,B-1)+":":A$=RIGHT$(A$,LEN(A$)-B-3):C=ASC(A$) :IF C<58ANDC>47THENA$="GOTO"+A$590 A$=C$+A$:GOTO570'RMV ELSE'S600 B=INSTR(P,A$,"GOTO"):IF B=0 THEN P=2:GOTO630610 P=B+2:C$=MID$(A$,B-1,1):IFC$=":"THEN600620 C$=LEFT$(A$,B-1)+":":A$=C$+RIGHT$(A$,LEN(A$)-B+1):GOTO600630 B=INSTR(P,A$,"GOSUB"):IFB=0THEN RETURN640 P=B+2:C$=MID$(A$,B-1,1):IFC$=":"THEN630650 C$=LEFT$(A$,B-1)+":":A$=C$+RIGHT$(A$,LEN(A$)-B+1):GOTO630660 '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''670 '             BREAK UP MULTI STATEMENT LINES680 K=0690 B=INSTR(A$,":"):IFB=0THENA$(K)=A$:RETURN700 A$(K)=LEFT$(A$,B-1):A$=RIGHT$(A$,LEN(A$)-B):K=K+1:GOTO 690710 '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''720 '           TEST FOR GOTO'S,    MAKE MAP730 FOR I=0TO K740 B=INSTR(A$(I),"GOTO"):IF B=0  THEN 920750 C=INSTR(A$(I),"ON"):IFC=0THEN 870760 A$(I)=RIGHT$(A$(I),LEN(A$(I))-2)770 A$=LEFT$(A$(I),B-3)' WILL BECOME A$(I)780 C$=RIGHT$(A$(I),LEN(A$(I))-B-1)' DESINATION ADDRESSES790 A$(I)=A$800 B=INSTR(C$,","):IF B=0 AND   LEN(C$)=0 THEN 920810 IF B=0 THEN A$=C$:C$=""ELSE   A$=LEFT$(C$,B-1):C$=RIGHT$(C$,LEN(C$)-B)820 FOR J=0 TO GC830 IF A$=GT$(J,0) THEN GT$(J,1)=GT$(J,1)+","+B$:J=60000000840 NEXT J850 IFJ<50000000THENGC=GC+1 :GT$(GC,0)=A$:GT$(GC,1)=B$860 GOTO800870 A$=RIGHT$(A$(I),LEN(A$(I))-4)880 FOR J=0 TO GC890 IF A$=GT$(J,0) THEN GT$(J,1) =GT$(J,1)+","+B$:J=60000000900 NEXT J910 IF J<50000000 THEN GC=GC+1:  GT$(GC,0)=A$:GT$(GC,1)=B$920 NEXT I930 RETURN940 ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''950 '           TEST FOR GOSUB'S & MAKE MAP960 FOR I=0 TO K970 B=INSTR(A$(I),"GOSUB"):IF B=0 THEN 1150980 C=INSTR(A$(I),"ON"):IFC=0THEN 1100990 A$(I)=RIGHT$(A$(I),LEN(A$(I))-2)1000 A$=LEFT$(A$(I),B-3)' WILL BECOME A$(I)1010 C$=RIGHT$(A$(I),LEN(A$(I))-B-2)'DESTINATION ADDRESSES1020 A$(I)=A$1030 B=INSTR(C$,","):IFB=0 ANDLEN(C$)=0 THEN 11501040 IF B=0 THEN A$=C$:C$="" ELSE A$=LEFT$(C$,B-1):C$=RIGHT$(C$,LEN(C$)-B)1050 FOR J=0 TO GS1060 IF A$=GS$(J,0) THEN GS$(J,1)=GS$(J,1)+","+B$:J=600000001070 NEXT J1080 IF J<50000000 THEN GS=GS+1 : GS$(GS,0)=A$:GS$(GS,1)=B$1090 GOTO10301100 A$=RIGHT$(A$(I),LEN(A$(I))-5)1110 FOR J=0 TO GS1120 IF A$=GS$(J,0) THEN GS$(J,1)=GS$(J,1)+","+B$:J=600000001130 NEXTJ1140 IF J<50000000 THEN GS=GS+1 : GS$(GS,0)=A$:GS$(GS,1)=B$1150 NEXT I1160 RETURN1170 ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''1180 '              SORT & PRINT GOTO MAP1181 CLS:PRINT"PROGRAM : ";F$1190 IFPF$="P"THENFORI=1TO3:PRINT#-2," ":NEXTI1191 IF PF$="P" THEN PRINT#-2,"      PROGRAM : ";F$1200 A$="GOTO     FROM":IF PF$="P"THENPRINT#-2,"      "+A$ELSE GOTO 12051205 PRINT A$;1210 FOR J=GC-1 TO 1 STEP-11220 FOR I=0 TO J1230 IF VAL(GT$(I,0))>VAL(GT$(I+1,0)) THEN   A$=GT$(I,0):GT$(I,0)=GT$(I+1,0) :GT$(I+1,0)=A$ : A$=GT$(I,1) :  GT$(I,1)=GT$(I+1,1):GT$(I+1,1)=A$1240 NEXTI1250 NEXTJ1260 FOR I=0 TO GC1270 IFPF$="P"THENPRINT#-2,"      "+GT$(I,0)+"      "+GT$(I,1)ELSE PRINTGT$(I,0)+"      "+GT$(I,1):IFI>0THENIFI=12*INT(I/12)THENPRINT:INPUT"  PRESS <ENTER> TO CONTINUE";A$:CLS:PRINT"PROGRAM : ";F$:PRINT"GOTO     FROM"1280 NEXTI1290 ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''1300 '              SORT & PRINT GOSUB MAP1310 FOR J=GS-1 TO 1 STEP-11320 FOR I=0 TO J1330 IF VAL(GS$(I,0))>VAL(GS$(I+1,0)) THEN A$=GS$(I,0):GS$(I,0)=GS$(I+1,0):GS$(I+1,0)=A$:A$=GS$(I,1):GS$(I,1)=GS$(I+1,1):GS$(I+1,1)=A$1340 NEXTI1350 NEXTJ1360 IF PF$<>"P"THENPRINT"*******************************":INPUT"    PRESS <ENTER>TO CONTINE";A$:CLS1365 PRINT"PROGRAM : ";F$1370 IFPF$="P"THENPRINT#-2," ":PRINT#-2," ":PRINT#-2,"      GOSUB    FROM"ELSEPRINT"GOSUB    FROM"1380 FOR I=0 TO GS1390 IFPF$="P"THENPRINT#-2,"      "+GS$(I,0)+"      "+ GS$(I,1)ELSEPRINTGS$(I,0)+"      "+GS$(I,1):IFI>0THENIFI=12*INT(I/12)THENINPUT"   PRESS <ENTER> TO CONTINUE";A$:CLS:PRINT"PROGRAM : ";F$:PRINT"GOSUB    FROM"1400 NEXT I1410 CLOSE#11420 RETURN1430 ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''1440 '       PRINT INSTRUCTIONS1450 CLS:PRINT:PRINT:PRINT"BASICMAP PRODUCES A LISTING"1460 PRINT"OF BASIC PROGRAMS SAVED IN "1470 PRINT"ASCII FORMAT and A MAP OF"1480 PRINT"GOTO'S AND GOSUB'S."1490 PRINT:PRINT"BASICMAP IS AN ANTI-PASTA "1500 PRINT"PROGRAM, IT HELPS TO UNTANGLE"1510 PRINT"SPAGHETTI BOWL CODE"1520 PRINT:INPUT"   PRESS <ENTER> TO CONTIUE";A$:CLS1530 PRINT"TO SAVE A PROGRAM IN ASCII TYPE"1540 PRINT"   SAVE "+CHR$(34)+"PROGNAME"+CHR$(34)+",A <ENTER>"1550 PRINT "THE ,A SPECIFIES ASCII FORMAT"1560 PRINT:PRINT"THE DISK WITH PROGRAM IN ASCII"1570 PRINT"SHOULD NOW BE IN THE DISK DRIVE"1580 PRINT"AS IF YOU WERE ABOUT TO <LOAD>."1590 PRINT:PRINT"DEVELOPED USING LINE PRINTER"1600 PRINT"WITH THE OPTION OF USING SCREEN"1630 PRINT:INPUT"PRESS <ENTER> TO CONTINUE";A$:PRINT@448,"................................":PRINT:PRINT:PRINT:PRINT1640 RETURN1650 '''''''''''''''''''''''''''FOR REFERENCE OF USING PCLEAR   SEE: A BASIC BUG                     C.J.ROSLUND                     COLOR COMPUTER NEWS V1-#3       SEPT/OCT 1981, PAGE 321660 PMODE0:PCLEAR11670 GOTO 20