10 GOTO251020 DEFFNX(X0)=1+250*X0'PLOT30 DEFFNY(Y0)=191-190*Y0/VIN'PLOT40 PI=3.141592654:P2=2*PI50 GOSUB1700'INSTRUCTIONS60 'POKE &HFFD7,1 'SPEEDUP70 GOSUB740'INPUT COMPONENTS80 'INIT W-ARRAY:90 FORJ=0TO2:W(J)=-IOUT/C:NEXTJ100 'FW OR HW RECT?110 IFRCT>=1THENDEFFNV(T)=VIN*ABS(SIN(P2*T))-DIODE ELSE DEF FNV(T)=VIN*SIN(P2*T)-DIODE 120 'INITIAL VOLTS:130 CLS:PRINT:PRINT"INITIAL VOLTAGE, BETWEEN ZERO":PRINT"AND";:PRINTUSING"###.## VOLTS";VIN;:INPUTY0140 Y0=ABS(Y0):IFY0>VIN THENSOUND2,2:GOTO130150 'X0_TIME,Y0_VOLTS:160 X0=0:YOLD=Y0170 PCLS:SCREEN1,1180 STPS=50:H=1/STPS190 GOSUB620200 XX=FNX(X0-INT(X0+.1)):YY=FNY(Y0)210 LINE(XX,YY)-(XX,YY),PSET220 XX=INT(X0+.1)230 FORL=1TOSTPS240 GOSUB550'INTEGRATE ONE STEP250 LINE-(FNX(X-XX),FNY(Y)),PSET'FILTERED VOLTAGE260 X0=X:Y0=Y'UPDATE270 NEXTL280 IFABS(Y-YOLD)>VRMS/100 THEN YOLD=Y:GOTO 200290 PCLS300 STPS=2*STPS:H=1/STPS310 GOSUB620320 VMIN=VIN:VTOP=0:IMAX=0:PAV=0330 X=0:X0=0340 LINE(FNX(X0),FNY(Y0))-(FNX(X0),FNY(Y0)),PSET350 SOUND100,2360 FORL=1TOSTPS370 GOSUB550:IFY<VMIN THENVMIN=Y380 IFY>VTOP THENVTOP=Y390 IFC*F>IMAX THENIMAX=C*F400 IFIC$="Y"THENPAV=PAV+IOUT*ABS(Y-VDC) 'AVG IC POWER DISS.410 Y0=Y:X0=X420 LINE-(FNX(X),FNY(Y)),PSET430 NEXTL440 GOSUB1600450 GOTO2150'PRINT RESULTS460 REM F(Y,Y'=-IOUT/C):470 V=FNV(X)480 IFV>Y THENF=((V-Y)/REFF-IOUT)/C ELSEF=-IOUT/C490 RETURN500 ' SOLVE DIFFEQ BY510 'ADAMS-BASHFORTH 3-STEP520 ' DY/DX = F(Y, X);530 'F(Y, X) MUST BE LOCATED AT LINE 1000540 'GENERATE Y(X0+H):550 X=X0+H560 Y=Y0+H*(23*W(2)-16*W(1)+5*W(0))/12570 'UPDATE W-ARRAY:580 GOSUB470'F(Y, X)590 W(0)=W(1):W(1)=W(2):W(2)=F600 RETURN610 'DRAW RECTIFIED VOLTAGE:620 XX=0:YY=191:LINE(XX,YY)-(XX,YY),PSET630 FORL=1TOSTPS640 XX=XX+H:YY=FNV(XX):IFYY<0THENYY=0650 LINE-(FNX(XX),FNY(YY)),PSET660 NEXTL670 IFIC$="N"THEN720680 'MIN IC REG VOLTS:690 YY=FNY(VDC+2.5)700 IFYY<0THENYY=0710 LINE(0,YY)-(255,YY),PSET720 RETURN'FROM DRAW VOLTS730 REM INPUT COMPONENT VALUES740 CLS750 PRINT@64,"IS YOUR RECTIFIER:"760 PRINT@133,"1. HALF-WAVE (HW)";770 IFRCT=0THENPRINT" _"780 PRINT@197,"2. FULL-WAVE BRIDGE (FW)";790 IFRCT=1THENPRINT" _"800 PRINT@261,"3. FULL-WAVE CENTER-TAPPED":PRINT@310,"(FWCT)";810 IFRCT=2THENPRINT" _"820 PRINT@354,"CURRENTLY, IT IS ";830 PRINTUSING"#.";RCT+1;:PRINT" ("RCT$(RCT)")"840 PRINT@416,"INPUT 1-3, OR <ENTER> TO ACCEPT CURRENT VALUE:"850 GOSUB1600:IFASC(A$)=13THEN900860 'IF NOT YET ACCEPTED, TRY AGAIN:870 IFVAL(A$)<1ORVAL(A$)>3THENSOUND2,2ELSERCT=VAL(A$)-1:IFRCT=1THENDIODE=0.14ELSEDIODE=0.7'DIODE VOLT DROP880 GOTO740'DOUBLE CHECK890 REM900 MSG$="TRANSFORMER VOLTAGE (RMS)"910 CUR=VRMS:UNITS$=" VOLTS"920 GOSUB1500'GET NEW VRMS930 VRMS=CUR:VIN=SQR(2)*VRMS'VIN=PEAK INPUT VOLTS940 IF RCT=2THENVIN=VIN/2950 REM960 MSG$="REQUIRED OUTPUT CURRENT"970 CUR=IOUT:UNITS$=" AMPS"980 GOSUB1500990 IOUT=CUR1000 REM1010 MSG$="FILTER CAPACITOR (MICROFARADS)"1020 CUR=CMF:UNITS$=" MF"1030 GOSUB15001040 CMF=CUR:C=HZ*CMF*1E-6'CONVERT TO FARADS*CYCLES PER SECOND1050 REM1060 MSG$="EFFECTIVE INPUT RESISTANCE(REFF)"1070 CUR=REFF:UNITS$=" OHMS"1080 GOSUB15001090 REFF=CUR1100 REM1110 CLS:SOUND100,11120 PRINT@66,"ARE YOU USING AN INTEGRATED     CIRCUIT (IC) VOLTAGE REGULATOR":PRINT"CURRENT IS ";:IFIC$="Y"THENPRINT"'YES'"ELSEPRINT"'NO'"1130 PRINT:PRINT" (Y/N)?":GOSUB1600:IFASC(A$)=13THENA$=IC$1140 IFA$="N"THENIC$=A$:GOTO14801150 IFA$<>"Y"THENSOUND2,2:GOTO11101160 IC$=A$1170 'YES-GET IC PARAMETERS1180 MSG$="MAXIMUM RATED IC INPUT VOLTAGE"1190 CUR=VC:UNITS$=" VOLTS"1200 GOSUB15001210 VC=CUR1220 IFVC>1.1*VIN-DIODE THEN1390'SAFETY MARGIN OK1230 IFVC<VIN-DIODE THEN1340'VOLTAGE WAY TOO HIGH?1240 'IN DANGER ZONE:1250 CLS:PRINT@172,"WARNING"1260 PRINT:PRINT"LESS THAN 10% SAFETY MARGIN"1270 PRINT"BETWEEN MAX IC INPUT VOLTAGE":PRINTTAB(10)"";:PRINTUSING"###.##";VC1280 PRINT"AND MAX TRANSFORMER VOLTAGE":PRINTTAB(10)"";:PRINTUSING"###.##";VIN1290 PRINT:PRINT"DO YOU WANT TO CONTINUE (C)"1300 PRINT"OR START OVER (S)?"1310 GOSUB16001320 IFA$="S"THEN7401330 IFA$<>"C"THENSOUND2,2:GOTO1230ELSE13901340 CLS:PRINT@172,"ERROR"1350 PRINT:PRINT"MAX IC INPUT VOLTAGE";:PRINTUSING"###.##";VC;:PRINT" IS"1360 PRINT"LESS THAN THE MAX TRANSFORMER":PRINT"VOLTAGE";:PRINTUSING"###.##";VIN1370 GOTO12901380 'REGULATED DC VOLTS1390 MSG$="REGULATED DC VOLTS"1400 CUR=VDC:UNITS$=" VOLTS"1410 GOSUB15001420 VDC=CUR1430 'RIPPLE REJECTION1440 MSG$="RIPPLE REJECTION, IN DECIBELS"1450 CUR=DB:UNITS$=" DB"1460 GOSUB15001470 DB=CUR1480 RETURN1490 REM VALUE INPUT ROUTINE1500 CLS:SOUND100,11510 PRINT@64,MSG$1520 PRINT@160,"CURRENTLY, IT IS";1530 PRINTUSING"#####.###";CUR;1540 PRINTUNITS$1550 PRINT@226,"INPUT NEW VALUE"1560 PRINT:PRINT"(OR <ENTER> TO ACCEPT CURRENT)":PRINT@242,"";:INPUTA$1570 IFA$=""THEN1590'ACCEPT1580 CUR=ABS(VAL(A$)):GOTO 1500 'DOUBLECHECK1590 RETURN1600 A$=INKEY$1610 A$=INKEY$1620 IFA$=""THEN16101630 SOUND100,11640 RETURN1650 PRINT@483,"HIT ANY KEY TO CONTINUE";1660 GOSUB16001670 CLS1680 RETURN1690 REM INSTRUCTIONS1700 CLS1710 PRINT@162,"WOULD YOU LIKE INSTRUCTIONS?"1720 PRINT@237,"(Y/N)"1730 GOSUB16001740 IFA$="N"THENGOSUB1980:RETURN1750 IFA$<>"Y"THENSOUND2,1:GOTO17001760 CLS1770 PRINT" ** POWER SUPPLY SIMULATION **":PRINT1780 PRINT" SIMULATES A LINE-POWERED DC    POWER SUPPLY. YOU SPECIFY       COMPONENT VALUES -- TRANSFORMER,RECTIFIER, FILTER CAPACITOR,    EFFECTIVE FILTER RESISTANCE, ANDIF DESIRED, VOLTAGE REGULATOR.":PRINT1790 PRINT" (EFFECTIVE FILTER RESISTANCE = SUM OF THE TRANSFORMER WINDING  RESISTANCE, THE CAPACITOR'S     EFFECTIVE SERIES RESISTANCE, ANDANY CURRENT-LIMITING RESISTANCE YOU MAY ADD.)"1800 GOSUB 16501810 PRINTTAB(9)"* DATA ENTRY *":PRINT1820 PRINT" DEFAULTS FOR ALL VALUES CAN BE ACCEPTED BY JUST HITTING <ENTER>WHEN THE CURRENT VALUE IS SHOWN.OR, ENTER THE DESIRED VALUE. THENEW VALUE WILL BE DISPLAYED. YOUCAN CHANGE IT, OR ACCEPT IT BY  HITTING <ENTER>.":PRINT1830 PRINT" (TO SEE A PROGRAM DEMO, KEEP   HITTING <ENTER> UNTIL YOU SEE   THE GRAPHICS SCREEN. THEN HIT   ANY KEY TO SEE THE RESULTS.)"1840 GOSUB16501850 PRINTTAB(12)"* PLOT *":PRINT1860 PRINT" THE PROGRAM WILL PLOT THE      RECTIFIED TRANSFORMER VOLTAGE   AND, IF APPLICABLE, THE MINIMUM VOLTAGE REQUIRED FOR GOOD IC    REGULATION (= IC VOLTS + 2.5V).":PRINT1870 GOSUB1980'INITIALIZE1880 PRINT" THE FILTERED VOLTAGE IS THEN   ADDED. WHEN THE FILTERED VOLTAGEHAS STABILIZED, THE PLOT WILL BEREDRAWN. WHEN IT'S DONE, HIT ANYKEY TO VIEW THE RESULTS."1890 GOSUB16501900 PRINTTAB(6)"* TECHNICAL DETAILS *":PRINT1910 PRINT" THIS PROGRAM USES THE ADAMS-   BASHFORTH 3-STEP METHOD TO SOLVETHE DIFFERENTIAL EQUATION WHICH DESCRIBES THE RECTIFIER-FILTER  SYSTEM.1920 PRINT:PRINT" FOR DOUBLE-ENDED SUPPLIES (+AND-), WITH A CENTER-TAPPED TRANS- FORMER AND BRIDGE: USE THE FULL-WAVE BRIDGE OPTION WITH HALF THETRANSFORMER VOLTAGE.1930 GOSUB16501940 RETURN1950 REM RECTIFIER TYPES:1960 DATA HW,FW,FWCT1970 REM W USED TO SOLVE DIFFEQ1980 DIMW(2)1990 DIMRCT$(2):FORJ=0TO2:READRCT$(J):NEXTJ2000 REM DEFAULT COMPONENT VALUES:2010 DATA 0,24,.2,470,10,Y,55, 18.5,50,602020 'RCT - RECTIFIER TYPE2030 'VRMS - RMS TRANSFORMER VOLTS2040 'IOUT - DESIRED OUTPUT AMPS2050 'CMF - CAPACITOR (MICROFARADS)2060 'REFF - EFFECTIVE RESISTANCE2070 'IC$ - "Y" IF REGULATOR IC2080 'VC - MAX IC VOLTAGE2090 'VDC - IC REGULATED VOLTS2100 'DB - IC RIPPLE REJECTION (DECIBELS)2110 READRCT,VRMS,IOUT,CMF,REFF,IC$,VC,VDC,DB,HZ2120 'HZ - LINE FREQ2130 RETURN2140 REM PRINT RESULTS:2150 CLS2160 P$="####.##"2170 PRINT@65,"MAX DIODE CURRENT AT TURN-ON:"2180 PRINTUSING"       "+P$+" AMPS";VIN/REFF2190 PRINT:PRINT" MAX DIODE CURRENT UNDER LOAD:"2200 PRINTTAB(7)"";2210 PRINTUSING"###.### AMPS";IMAX2220 PRINT:PRINT"     MINIMUM DC VOLTAGE:"2230 PRINTTAB(7);:PRINTUSINGP$+" VOLTS";VMIN2240 PRINT:PRINT"        RIPPLE VOLTAGE:"2250 PRINTTAB(7);:PRINTUSINGP$+" VOLTS";VTOP-VMIN2260 GOSUB16502270 IFIC$="N"THEN23502280 PRINT@65,"REGULATOR IC POWER DISSIPATION:"2290 PRINT@103,"";:PRINTUSING"###.### WATTS";PAV/STPS2300 PRINT2310 PRINT"  RIPPLE IN REGULATOR OUTPUT:"2320 PRINTTAB(7)"";:PRINTUSING"###.### MILLIVOLTS";(VTOP-VMIN)*EXP(-DB/20)2330 IFVMIN<VDC+2.5THENPRINT:PRINTTAB(11)"WARNING":PRINT"MINIMUM VOLTAGE IS TOO LOW FOR":PRINT"GOOD REGULATION."2340 GOSUB16502350 CLS:PRINT@69,"1. REVIEW RESULTS"2360 PRINT@133,"2. REVIEW PLOT"2370 PRINT@197,"3. TRY NEW COMPONENT VALUES"2380 PRINT@261,"4. QUIT"2390 PRINT@322,"YOUR CHOICE?"2400 GOSUB1600:J=VAL(A$):IFJ<1THENSOUND2,2:GOTO23502410 ONJ GOTO2150,2430,60,24602420 SOUND2,2:GOTO23502430 SCREEN1,12440 GOSUB16002450 GOTO23502460 CLS:PRINT"TO REVIEW RESULTS,"2470 PRINT"OR RESTART PROGRAM,"2480 PRINT"ENTER "2490 POKE&HFFD6,1:END'SLOWDOWNEND2500 RETURN2510 CLEAR50:PCLEAR4:PMODE4:PCLS:GOTO20                                 