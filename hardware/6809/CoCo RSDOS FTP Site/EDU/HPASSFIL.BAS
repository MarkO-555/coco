5 IFPEEK(&H7CC2)=142 THEN1108 CLEAR1,&H7CC1:CLEAR300:S=319389 CLS:PRINT@232,"INITIALIZING"10 DA$="8E7D58FC0168BF0168FD7DB78E7CE1DCA99FA9FD7CF89EBABF7FFC7F7FFA39819E261534169EBABF7FFCCCFFFFED819CB726FA35167E100081872605737FFF20"11 DB$="F481402709812027EC7F7FFF20E77D7FFF27E27F7FFF3416862017009ABDB3E4108304C8102437201083003223088300337C7FFF20F286053D3404C407F77FFA"12 DC$="B67FFF3504545454D3BAFD7FFC7F7FFF35168620209F0D6F102600583416810826131700FD86208D4E86208D4A1700F21700EF2036810C26139EBABF7FFC7F7F"13 DD$="FACCFFFFED819CB726FA201F8D29BE7FFC9CB725163089FF00BF7FFC9EBAEC890100ED81BC7FFC26F520D6865F8D081700B035967E1000810D261186208DF817"14 DE$="00A07F7FFD7C7FFC7F7FFA39C604F77FFE80203DC37E8C1F02BE7FFCA6A034028A0F8D163502484848488A0F8D0C7A7FFE26E93089FF008D4239F67FFA5CF77F"15 DF$="FB3402CCF8008A08FD7FF83502C6FF7A7FFB270E1A0146561CFE767FF8767FF920ED3406FC7FF8AA84EA01A784E7013506A484E401ED8430882039F67FFACB05"16 DG$="C10723043001C008C107260F1E10C11F26074C5F1E015F20021E01F77FFABF7FFC393404F67FFABE7FFCC0052A14CB08301F1E10C1FF2608C61F1E10C6022002"17 DH$="1E10BF7FFCF77FFA3584FFFFFFFFDDDDDFDF55FFFFFF9909099FB17BD1BFF32DB4CFB55B25AFDBFFFFFFDB777BDFBDEEEDBFF69096FFFBB1BBFFFFFF9DBFFFF0"18 DI$="FFFFFFFFFDDFFDDBB77F9640269FD9DDDD8F96EDB70F96E9E69FD950DDDF071EE69FDB71669F0EEDB77F9669669F9668EDBFFDDFDDFFFDDFDDBFEDB7BDEFFF0F"19 DJ$="0FFF7BDEDB7F96EDBFBF9642478F9660666F3551661F9677769F1AAAAA1F0771770F0771777F9674669F6660666F8DDDDD8FCEEEE69F6533356F7777770F6006"20 DK$="666F6224446F9666669F1661777F966625AF1661356F9679E69F0DDDDDDF6666669F6666699F6666006F6699966F6660DDDF0EC9370F8BBBBB8FF77BBDDF1DDD"21 DL$="DD1FB55FFFFFFFFFFF0FBDFFFFFFFF1E868F7771661FFF87778FEEE8668FFF96079FDAB1BBBFF9668E8F7716666FDF9DDD8FEFEEE69FF764166F3BBBBB1FFF60"22 DM$="666FFF16666FFF96669FF166177FF8668EEFFF16777FFF070E0FBB1BBBBFFF66669FFF66699FFF66606FFF69966FF6668E9FFF0EDB0FFF00FF00FF00FF00"23 GOSUB10024 DA$=DB$:GOSUB10025 DA$=DC$:GOSUB10026 DA$=DD$:GOSUB10027 DA$=DE$:GOSUB10028 DA$=DF$:GOSUB10029 DA$=DG$:GOSUB10030 DA$=DH$:GOSUB10031 DA$=DI$:GOSUB10032 DA$=DJ$:GOSUB10033 DA$=DK$:GOSUB10034 DA$=DL$:GOSUB10035 DA$=DM$:GOSUB10036 GOTO108100 I=1101 FOR AD=S TO (S+LEN(DA$)/2)-1102 D=VAL("&H"+MID$(DA$,I,2))103 POKE AD,D104 I=I+2105 NEXT AD106 S=AD107 RETURN108 EXEC&H7CC2110 PMODE4,1:SCREEN1,1:POKE178,0:CLS120 PRINT"Program to design Hi-Pass multi-feedback Op-Amp    active filters."130 PRINT:PRINT"Type 'X' for Unknowns."140 PRINT:INPUT"Cutoff Frequency";F$:F=VAL(F$)150 CLS:GOSUB620:CIRCLE(61,76),10:CIRCLE(101,76),10:PRINT@1020,"Value of C2, C3 (uf.) ";:INPUTC2$:C2=VAL(C2$)155 C2=C2*1E-6160 CLS:GOSUB620:CIRCLE(81,61),10:PRINT@1020,"Value of C4 (uf.) ";:INPUTC4$:C4=VAL(C4$)165 C4=C4*1E-6170 CLS:GOSUB620:CIRCLE(81,105),10:PRINT@1020,"Value of R3";:INPUTR3$:R3=VAL(R3$)180 CLS:GOSUB620:CIRCLE(120,56),10:PRINT@1020,"Value of R5";:INPUTR5$:R5=VAL(R5$)190 CLS200 IFF$="X"THEN250210 IFR3$="X"THEN260220 IFR5$="X"THEN270230 IFC2$="X"THEN280240 IFC4$="X"THEN290250 F=.1591545/SQR(R3*R5*C2*C4):GOTO300260 R3=.0253301996/((F^2)*R5*C2*C4):GOTO300270 R5=.0253301996/((F^2)*R3*C2*C4):GOTO300280 C2=.0253301996/((F^2)*R3*R5*C4):GOTO300290 C4=.0253301996/((F^2)*R3*R5*C2)300 G=(.159145/(F*C4))/(.159145/(F*C2))310 IFF=>1E+6 THENF0$=" Mhz."ELSEIFF=>1000 THENF0$=" Khz."ELSEF0$=" Hz."320 IFR3=>1E+6 THENR0$="M"ELSEIFR3=>1000 THENR0$="K"ELSER0$=""330 IFR5=>1E+6 THENR1$="M"ELSEIFR5=>1000 THENR1$="K"ELSER1$=""340 IFC2=>1E-6 THENC0$=" uf"ELSEIFC2=>1E-9 THENC0$=" nf"ELSEC0$=" pf"350 IFC4=>1E-6 THENC1$=" uf"ELSEIFC4=>1E-9 THENC1$=" nf"ELSEC1$=" pf"360 IFF=>1E+6 THENF=F/1E+6ELSEIFF=>1000 THENF=F/1000370 IFF=>100 THENIFF=>(INT(F)+.5) THENF=INT(F)+1ELSEF=INT(F)380 F$=STR$(F):F$=LEFT$(F$,5):F$=F$+F0$390 IFR3=>1E+6 THENR3=R3/1E+6ELSEIFR3=>1000 THENR3=R3/1000400 IFR3=>100 THENIFR3=>(INT(R3)+.5) THENR3=INT(R3)+1ELSER3=INT(R3)410 R3$=STR$(R3):R3$=LEFT$(R3$,5):R3$=R3$+R0$420 IFR5=>1E+6 THENR5=R5/1E+6ELSEIFR5=>1000 THENR5=R5/1000430 IFR5=>100 THENIFR5=>(INT(R5)+.5) THENR5=INT(R5)+1ELSER5=INT(R5)440 R5$=STR$(R5):R5$=LEFT$(R5$,5):R5$=R5$+R1$450 IFC2=>1E-6 THENC2=C2/1E-6ELSEIFC2=>1E-9 THENC2=C2/1E-9ELSEC2=C2/1E-12460 IFC2=>100 THENIFC2=>(INT(C2)+.5) THENC2=INT(C2)+1ELSEC2=INT(C2)470 C2$=STR$(C2):C2$=LEFT$(C2$,5):C2$=C2$+C0$480 IFC4=>1E-6 THENC4=C4/1E-6ELSEIFC4=>1E-9 THENC4=C4/1E-9ELSEC4=C4/1E-12490 IFC4=>100 THENIFC4=>(INT(C4)+.5) THENC4=INT(C4)+1ELSEC4=INT(C4)500 C4$=STR$(C4):C4$=LEFT$(C4$,5)510 G$=STR$(G):G$=LEFT$(G$,5)520 CLS540 PRINT@410,"In.":PRINT@500,"Out."550 PRINT@569,C2$:PRINT@578,C2$:PRINT@590,"741"560 PRINT@680,R3$570 PRINT@317,C4$:PRINT@368,C1$:PRINT@330,R5$580 PRINT@1090,"Gain ="+G$585 PRINT@1220,"";586 PRINT@1184,"Cutoff Frequency ="+F$;587 GOSUB620588 IFI$="S"THENSAVEM"HPASS",3584,9727,3584:GOSUB620590 I$=INKEY$:IFI$=""THEN590600 IFI$="A"THENCLS:GOTO140605 IFI$="S"THEN520610 IFI$="E"THENCLS:ENDELSE590620 PRINT@10,"Hi-Pass Active Filter Design"625 PRINT@1220,"";630 CIRCLE(35,76),2:LINE(35,76)-(65,76),PSET640 DRAW"A1BD4NL5NR5BD2L3NG2R6NF2L3D6"650 DRAW"BM96,76A3BD4NL5NR5BD2L3NG2R6NF2L3D6"660 LINE(54,76)-(98,76),PSET670 LINE(102,76)-(137,76),PSET680 DRAW"BM140,77A0R2"690 CIRCLE(120,76),2700 LINE(120,76)-(120,66),PSET:DRAW"A2DG2F3G3F3G3F2D"710 LINE(120,47)-(120,37),PSET720 CIRCLE(81,76),2730 LINE(81,76)-(81,66),PSET:DRAW"BM81,56A0D4NL5NR5BD2L3NG2R6NF2L3D6"740 LINE(81,56)-(81,37),PSET750 LINE(81,76)-(81,96),PSET760 DRAW"A0DG2F3G3F3G3F2D"770 LINE(81,115)-(81,125),PSET780 DRAW"D3NL5NR5BD3NL3NR3BD3NLNRBD4"790 LINE(137,70)-(137,110),PSET800 LINE(137,70)-(170,90),PSET:LINE(170,90)-(137,110),PSET810 DRAW"BM140,103R2L1U1D2"820 LINE(137,104)-(125,104),PSET830 LINE(125,104)-(125,116),PSET840 DRAW"D3NL5NR5BD3NL3NR3BD3NLNRBD4"850 LINE(170,90)-(205,90),PSET:CIRCLE(205,90),2860 LINE(81,37)-(180,37),PSET:LINE(180,37)-(180,90),PSET870 RETURN