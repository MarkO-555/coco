                                          ULTIMATERM VERSION 4.0                              Documentation Manual                                 Ultimaterm V4.0 written by Ken Johnston                     Documentation written by Ken Johnston                                    Freeware - March 1988                                  Voice : (403) 242-3485  MST                 Modem (DIGITS) : (403) 242-3515  300/1200 baud                                                     Table of Contents                               -----------------         Preface ........................................... page 01         Getting Started with Ultimaterm V4.0 .............. page 02         The Initial Setup ................................. page 02              Disk Options ................................. page 02                  "Default Drive" ......................... page 03                  "Default Extension" ..................... page 03                  "Auto Clear" ............................ page 03                  "Verify" ................................ page 03                  "Stepping Rate" ......................... page 03                  "Double Sided Drives" ................... page 03              Modem Options ................................ page 03                  Duplex settings ......................... page 04                  Baud rates .............................. page 04                  "Autobuffer" ............................ page 04                  "Terminal Type" ......................... page 04                  "Deluxe RS232 Pak" ...................... page 04              Printer Options .............................. page 05                  "Printer Line Delay" .................... page 05              Programmable Key Set ......................... page 05                  Keys [0] through [9] .................... page 05                       One second pause in key ............ page 05                       Quarter second delay between keys .. page 05                  [F-keys] ................................ page 06              Initialization Strings ....................... page 06                  Keyboard String ......................... page 06                  Modem String ............................ page 06              Miscellaneous Options ........................ page 07                  "Repeat delay time" ..................... page 07                  "Repeat speed" .......................... page 07                  "Keyclick tone" ......................... page 07                  "Sound" ................................. page 07                  "Destructable BS" ....................... page 07                  "RS232 Pak slot" ........................ page 07                  "Disk drive slot" ....................... page 07              Other Ultimaterm Parameters .................. page 08                   Mono/Comp toggle ........................ page 08                  Screen positioning ...................... page 08                  Keyclick toggle ......................... page 08                  Upper/Lowercase toggle .................. page 08                  Buffer opened/closed toggle ............. page 08                  VT-Keypad toggle ........................ page 08              Saving all the default options ............... page 09                   Ultimaterm Commands ............................... page 09              [ALT]-[@]  Credits ........................... page 09              [ALT]-[A]  Autodial .......................... page 10                  Creating a dialing directory ............ page 10                  Cursor Movement ......................... page 11                  Adding or Changing an entry ............. page 11                  Dialing Options ......................... page 12                       Dialing Prefix and Suffix .......... page 12                       "Dial time" ........................ page 13                       "Hang-up time" ..................... page 13                       "hang-up String" ................... page 13                       "Abort string" ..................... page 13                       "Connect string" ................... page 13                       "Busy strings" ..................... page 13                       "carrier Method" ................... page 14                       Saving Dialing Options ............. page 14                  Dialing a number ........................ page 14              [ALT]-[B]  Buffer Commands ................... page 15                  "Clear Buffer" .......................... page 15                  "Display Buffer" ........................ page 15                  "Print Buffer" .......................... page 15                  "Buffer Status" ......................... page 15              [ALT]-[C]  Conference Mode ................... page 15              [ALT]-[D]  Disk Commands ..................... page 16                  "Load from disk to buffer" .............. page 16                       Adding LF's to a load .............. page 16                  "Save buffer to disk" ................... page 16                       File types ......................... page 16                       Files to big for one disk .......... page 17                       Stripping LF's during a save ....... page 17                  "Directory" ............................. page 17                  "Kill File" ............................. page 17                  "Format Ramdisk" ........................ page 17                  "Backup to Ramdisk" ..................... page 17                  "Backup to Floppy" ...................... page 17                  "Default Option Save" ................... page 17                  "Default Option Load" ................... page 17              [ALT]-[E]  Exit .............................. page 18              [ALT]-[F]  Freeze Screen ..................... page 18              [ALT]-[H]  Hang-up Modem ..................... page 18              [ALT]-[I]  Freeware Information .............. page 18              [ALT]-[K]  Keyclick toggle ................... page 19              [ALT]-[M]  Monochrome/Composite toggle ....... page 19                        [ALT]-[O]  Set Options ....................... page 19              [ALT]-[P]  Print Screen ...................... page 19              [ALT]-[Q]  VT-Keypad toggle .................. page 19                  VT-100 or ANSI emulation ................ page 19                  VT-52 emulation ......................... page 20              [ALT]-[S]  Buffer Checksum ................... page 20              [ALT]-[T]  Buffer Toggle ..................... page 20              [ALT]-[V]  Ultimaterm Version ................ page 20              [ALT]-[X]  Transfer Files .................... page 21                  "Transmit Buffer" ....................... page 21                  "Receive Buffer" ........................ page 21                  Transfers to disk or buffer ............. page 21                  Scanning a filename ..................... page 21                  "Xmodem Send" ........................... page 22                  "Ymodem Send" ........................... page 22                  "Xmodem Receive" ........................ page 22                  "Ymodem Receive" ........................ page 22                  Receiving to disk ....................... page 22                  Transmitting from disk .................. page 22                  Starting Xmodem receive with CRC ........ page 22                  Aborting a transmission ................. page 22                  Disk Full ERROR on receive to disk ...... page 22                  CRC Option .............................. page 23                       Sample calculation under 'C' ....... page 23                       Sample calculation under assembly .. page 24         Ultimaterm Clock files ............................ page 25         Ultimaterm's Keyboard ............................. page 26         Screen Control .................................... page 26             DEC VT-52 Control Codes ...................... page 27             DEC VT-52 Keyboard controls .................. page 28             DEC VT-100 Control Codes ..................... page 29             DEC VT-100 Keyboard controls ................. page 30             ANSI-BBS Control Codes ....................... page 31             Vidtex Control Codes ......................... page 32                                                               PREFACE           Documentation.   Here's something Ultimaterm has been lacking for     such a  long, long  time.   I decided  it was  about  time  I  stopped     pounding away  on Ultimaterm just long enough to get some explanations     written up.           I'll try  to keep  in mind  that I'm not writing a novel here and     explain things as precisely and simply as possible.  I'll even make an     effort to  include original sources of my information so as anyone who     actually will  read this  manual can  have a  reference  should  I  be     unclear.           Just so  we're thinking  on the  same wavelength,  I'll designate     control key  combinations by  preceding the  key with  a caret (^) and     designate alternate  key combinations  by using  the  sequence  [ALT]-     [key].           One last  thing  I  should  mention  here.    Many  things  about     Ultimaterm V4.0  won't be  readily apparent just by using the terminal     (as I  tried to  make Ultimaterm  V3.0).   I suggest  that even if you     don't read  through manuals  (like me?!)  you  glance  through  a  few     sections just to pick up on some tips I might leave lying around...                                                                Ken Johnston                                                                   1                                 GETTING STARTED WITH ULTIMATERM V4.0           I wouldn't  strongly suggest  you just  LOADM and EXEC Ultimaterm     V4.0 without  reading at  least this  first section.  One of the major     considerations I  kept in  mind while  writing V4.0  was the fact that     every system is not the same.  Especially these days now that everyone     has become  more confident in making hardware mods due to lower repair     or replacement costs.           The first  thing you'll  have to  do is LOADM and EXEC Ultimaterm     V4.0.   You should  notice two  things above  V3.0:  First, it'll take     longer to  load (wonder  why?!) and  second, when it is loaded, you'll     see  a  window  that  states  "Initializing  the  keyboard  and  modem     strings".   A second  or two  later, that  window disappears  and  the     version window  pops up that simply states "Ultimaterm V4.0".  Hit any     key to drop to terminal mode.       The Initial Setup     -----------------           Before you  go off  playing with all the new ALT keys, you'd best     take the  time to customize this version to your system.  First, press     [ALT]-[M] to  toggle the display between monochrome and composite (not     really necessary  if you're using an RGB display).  Second, use [ALT]-     [<] and  [ALT[-[>] to  move the  screen up  or down on your monitor to     center it  as best  as possible.  If keyclick annoys you, press [ALT]-     [K] to shut keyclick off (press it again to turn it back on).           Press [ALT]-[O]  to pop  up the  "Options  Menu".    If  you  had     Ultimaterm V3.0,  you'll probably  immediately notice  the addition of     two new options: "Initialization Strings" and "Miscellaneous Options".       [D]  Disk Options     -----------------           The first step will be setting up the disk options.  Simply press     [D] and the following window will pop up:                                  Disk Options                          D  Default Drive ..........0                         E  Default Extension ....BIN                         A  Auto Clear ...........Yes                         V  Verify ...............Off                         S  Stepping rate ......30 ms                         B  Double sided drives ...No                                           2                  "Default Drive"  and "Default  Extension" are  both used  for the     window that  asks for a filename.  To set the default drive, press [D]     and use  the left  and right  arrow keys  to rotate  through available     choices.   To set the default extension, press [E] and type in the new     extension.           "Auto Clear" is simply a flag that indicates if the buffer should     be cleared  automatically before  LOADing a  file from  disk.  It also     decides if  the buffer  should be  cleared upon  receiving a file from     across the modem.  Press [A] to toggle Autoclear on or off.           "Verify" is  the same  as the  VERIFY ON/OFF command under RSDOS.     If on,  then any  sector written  to  the  disk  will  be  reread  for     verification purposes.  This slows down disk output (especially during     an X or Ymodem transfer), but greatly improves the chances of catching     a possible  disk error  which could  cause you to loose files you just     spent much time downloading.           "Stepping rate" just allows you to set the stepping rate at which     the DSKCON  routine will  execute STEP  commands..   Most drives  will     handle the  6 ms rate but if you're not sure just experiment with them     to find the fastest your drives will handle.           "Double sided drives" allows you to switch the drive select masks     of Ultimaterm  V4.0 between  4 single  sided drives and 2 double sided     drives.           After you  have set  all the "Disk Options" to your liking, press     [BREAK] once to return to the "Set Options" screen.       [M]  Modem Options     ------------------           Press [M]  to pop  up the  "Modem Options" window.  The following     will appear on your screen:                                 Modem  Options                          B  Baud Rate ...........1200                         W  Word Length ............8                         P  Parity ..............None                         S  Stop bits ..............1                         D  Duplex ..............Full                         L  Linefeeds ............Yes                         A  Auto-Buffer ...........No                         T  Terminal Type .......ANSI                         R  Deluxe RS232 Pak .....Yes                         F  Linefeed Filter .......On           I'll assume  I don't  have to  explain what  "Baud  Rate"  is  or     "Parity", etc.   However,  I will  explain some  of the not-so-obvious     options and will also explain how to change the options.                                       3                  There are  two ways  to change  any of the above options.  Either     pressing the  designated key  will automatically  switch  that  option     between one  of two  states, or  pressing the  designated key will hi-     light that  option and  allow you to sequence through all choices with     the left  and right  arrow keys.   When  the right choice is selected,     press [ENTER] to accept the change or [BREAK] to leave it like it was.           NOTE:   If in  monochrome mode  (via the  [ALT]-[M]  option  from     terminal mode)  the option  won't be hi-lighted but will be underlined     instead.           There are  three duplex  settings: Full,  Half and Echo.  When in     FULL, any  keys you  press in  terminal mode will be sent to the modem     and any  keys received will be sent to the screen.  When in HALF, keys     you press  will also  be sent to the screen.  When in ECHO, characters     received from  the modem will be echoed back to the modem and any keys     you press will be sent to the screen.           When setting  the baud  rates, you  should keep  a few  things in     mind...  If you're using the RS232 pak, all baud rates can be selected     with the  exception of 450 baud.  If you're using the serial port, all     baud rates  between 450  baud and 2400 baud can be selected (i.e, 450,     50, 75..300,  600...2400).   I'm pretty  sure 2400  baud  through  the     serial port  is reliable for standard communicating considering I sent     a 100  block YMODEM file (yes, that's 'Y') using a null-modem cable at     2400 baud  with no  errors; but  a  LOT  of  time  goes  to  interrupt     processing and the machine slows down noticeably.           "Autobuffer" is  a feature  which is  very useful for downloading     text files  from a  BBS.   When the system you're connected to sends a     CHR$(18) (aka  DC2), Ultimaterm will open it's receiving buffer.  When     the system  you're connected to sends a CHR$(20) (aka DC4), Ultimaterm     will close  it's receiving  buffer.   This feature can be turned on or     off with this Autobuffer toggle.           "Terminal Type" switches Ultimaterm's screen driver to act as one     of four  different types  of terminals.   The  system you  are calling     should let  you know  what type  (if any)  of terminal  you should set     Ultimaterm to.   A more thorough explanation of the terminal types and     their control  codes will  be explained further on in this manual.  If     the system you are connected to doesn't support any control sequences,     just set  "Terminal Type"  to TTY  (Teletype) which  acts  as  a  dumb     terminal.           "Deluxe RS232 Pak" can only be kept at "Yes" if you have a Deluxe     RS232 Pak  present.   If you  do have a pak and want to use the serial     port for any reason, this is where you can switch over.           After you  have set all the "Modem Options" to your liking, press     [BREAK] once to return to the "Set Options" window.                                          4             [P]  Printer Options     --------------------           There are  three printer  options in  V4.0.  The window will look     like this:                               Printer  Options                          B  Printer Baud Rate ...9600                         L  Printer Linefeeds .....No                         D  Printer Line Delay ...000           These  are   changed  exactly  like  the  "Modem  Options"  were.     "Printer Line  Delay" might  come in  handy for  anyone with  an older     printer.  All it does is cause a set delay to occur at the end of each     line to the printer.           When the  "Printer Options"  are set to your taste, press [BREAK]     once to return to the "Set Options" window.       [K]  Programmable Key Set     -------------------------           This section  took a  major overhaul  when I  went  through  V3.0     fixing up  all that  needed fixing.  You should find much power to the     user has  been added to this section.  Though getting used to pressing     [ENTER] and  not [BREAK]  to exit from entering a macro will take some     time.           The keys  [0] through [9] can be changed to hold any name, alias,     password, etc.  that you  want to  send  across  the  modem  with  one     keystroke.  You can send any control character in the programmable key     by using  the [CTRL]  key.   If you  make a mistake while entering the     keystroke, you  can just  use the  [Left Arrow]  key to backup and fix     that mistake.   To  add the  [ENTER] key as part of the keystroke, use     [^M]; to add the [BREAK] key, use [^C] and to add the [Left Arrow] use     [^H].   Press [CLEAR]  to clear the programmable key, press [BREAK] to     leave the key unchanged, or press [ENTER] to accept the key as is.           There are  two special  CTRL key combinations that can be used in     conjunction with  ALT-[0] through ALT-[9].  They are [^A] and [^B] and     perform time functions during key transmissions.           [^A] in the key causes a single, one-second pause before the next     character in the string is processed.           [^B] in  the key  causes all following characters (up to the next     [^B]) to  be sent  at 1/4  second intervals.   This is most useful for     PBBSes which don't accept programmable keys at full speed.                                          5                  The 'F' keys serve a slightly different purpose.  Ultimaterm V4.0     was designed  with a  keyboard buffer  in mind  to add  much power  to     window control.  The 'F' keys are programmable keyboard strings.  When     you first  load V4.0,  you'll notice  that the  keys are set to [ALT]-     [X];X, [ALT]-[X];Y,  [ALT]-[X];S and  [ALT]-[X];U.   (In  any  of  the     options, any  letter that  is underlined  means it's  an  ALT-letter).     From terminal  mode, you  can press [ALT]-[F1] and [ALT]-[X];X will be     entered into the keyboard input buffer which will take you immediately     to Xmodem Receive.  The remaining ALT-[F's] are set to Ymodem Receive,     Xmodem Send  and Ymodem  Send.   After playing  around with V4.0 for a     while, you can set these keys up to do whatever you prefer.           When all  the programmable  keys are  to your satisfaction, press     [BREAK] once to return to the "Set Options" window.       [I]  Initialization Strings     ---------------------------           Remember that  "Initializing  the  keyboard  and  modem  strings"     window that popped up when you first loaded Ultimaterm?  Well, this is     where you  get to  set the  Keyboard and  Modem strings  for your  own     needs.           The [K]eyboard  string is  just like  one of  the [ALT]-[F  keys]     mentioned in  the "Programmable  Key Set"  section but  it is executed     when Ultimaterm  first loads  up and  is only  executed  once.    It's     basically my  version of  a safety  net that  will allow you to set up     some parameter  I may  have overlooked;  but most  people will find it     more useful  to execute  some  command  (like  dial  a  phone  number)     whenever they load up V4.0.           The [M]odem  string is  just like  one of  the [ALT]-[0]  through     [ALT]-[9] keys  that gets sent to the modem.  Currently, it sends "ATZ     [ENTER]", a  2 second  pause, "ATS0=0 L0 V1 X4 [ENTER]" to set up some     initial parameters  on your modem.  You can just press [M] and [CLEAR]     to clear  this string  should you  not have a smart modem.  Sorry this     string could  not be  longer, but  you can  use the keyboard string to     send a couple of [ALT]-[#] keys to set up more complex modem strings.           When the  Intialization strings  are set  to  your  needs,  press     [BREAK] to return to the "Set Options" menu.                                                  6             [Z]  Miscellaneous Options     --------------------------           This is  probably the  most important  option you need to look at     before you  can really  do anything  with V4.0  as it  allows  you  to     designate which  slots of  your multi-pak  (if you're  using one!) you     keep your  drive controller  and RS232  pak in.  The window looks like     this:                             Miscellaneous  Options                          D  Repeat delay time ....016                         R  Repeat speed .........128                         T  Keyclick tone ........032                         S  Sound .................On                         B  Destructible BS ......Yes                         Y  RS232 Pak slot .........1                         Z  Disk drive slot ........4           "Repeat delay time" is the length of time you have to hold down a     key before  it starts to repeat.  Just increase or decrease this value     to your liking.           "Repeat speed"  is how  fast the  key will  repeat.   Increase or     decrease this value to your liking.           "Keyclick tone"  is the  tone of  the keyclick  (if you  have the     keyclick turned on and the sound turned on).           "Sound" allows you to silence any noise Ultimaterm makes.           "Destructible BS" allows you to change the conditions under which     a backspace  will be  performed.   If set  to "Yes",  then whenever  a     backspace is  received, the  character over  which you're  backspacing     will be  erased.   If set to "No", then the cursor will just move back     over the previous character without destroying it.           "RS232 Pak  slot" allows  you to select which slot in your Multi-     Pak you have the RS232 pak in.  Please do not neglect this (unless you     don't have  the RS232 Pak or Multi-Pak!) as the Receiver Interrupt can     only be  enabled  if  Ultimaterm  knows  what  slot  the  pak  is  in.     Otherwise received  characters will  not cause  an interrupt condition     and will be ignored by Ultimaterm.           "Disk drive  slot" allows you to select which slot in your Multi-     Pak you  have the  disk controller in.  Please do not neglect this one     either (unless  you don't have a Multi-Pak) as it enables the CTS line     to the drive controller.           When you  have finished  with the  "Miscellaneous Options"  press     [BREAK] twice to return to terminal mode.                                         7                                     Other Ultimaterm Parameters           Now it'd  be  wise  to  set  up  the  miscellaneous  settings  on     Ultimaterm  V4.0   before  we   save  the   defaults  to  disk.    The     miscellaneous  settings  include  the  Mono/Comp  toggle  ([ALT]-[M]),     Screen  position  ([ALT]-[<]  and  [ALT]-[>]),  Keyclick  ([ALT]-[K]),     Upper/Lowercase (SHIFT-0),  Buffer Opened/Closed  ([ALT]-[T]), and VT-     Keypad toggle ([ALT]-[Q]).           The Mono/Comp toggle selects the screen between color and B&W and     also will  enable or  disable the  colorburst signal.   Set  [ALT]-[M]     according to what's most readable on your display.           Screen position  uses the Vertical Fine Scroll register  designed     for doing a smooth scroll to adjust the display up or down the screen.     This should  be most useful to those who have to constantly adjust the     horizontal on their monitors to get the best centering possible.           Keyclick just  enables or  disables keyclick.   Keyclick  can  be     over-ridden by the "Sound" option in "Miscellaneous Options".           Upper/Lower case really needs no explanation, except for pointing     out that  when upper-case is selected, a "#" appears on the top status     line.           Buffer Opened/Closed simply opens or closes the door to the input     buffer.   When OPENed,  the cursor  will change  to a block and an "*"     will appear  on  the  top  line.    When  closed,  the  cursor  is  an     underscore.           NOTE: Since  VT-100 or  VT-52 terminal  emulation can  alter  the     state of  the cursor,  the only sure-fire way of knowing if the buffer     is opened or closed is by the "*" on the status line.           VT-Keypad toggle allows for the CoCo 3's keyboard to emulate that     of the  appropriate VT  emulation.   When toggled on, a "%" appears on     the top  line and  the certain keys on the keyboard behave differently     than usual.  They are as follows:           SHIFT-@      Home Cursor          Up Arrow     Sends Cursor Up sequence          Down Arrow   Sends Cursor Down sequence          Right Arrow  Sends Cursor Right sequence          Left Arrow   Sends Cursor Left sequence          CLEAR        Sends Clear Screen sequence          SHIFT-ENTER  Sends Erase to End of Line sequence           [ALT]-[0-9]    Send Keypad Application Mode 0-9 sequences          [ALT]-[-]      Send Keypad Application Mode - (dash) sequence          [ALT]-[,]      Send Keypad Application Mode , (comma) sequence          [ALT]-[.]      Send Keypad Application Mode . (period) sequence          [ALT]-[ENTER]  Send Keypad Application Mode ENTER sequence          [ALT]-[F1-F4]  Send Programmable Function 4 sequence                                       8                                                                                                                                                                                                       