10  '***************************20 ' COCO JUKEBOX30 ' BY L. A. KELLOGG40 ' (C) COPYRIGHT 198550 '***************************60 ' PROGRAM ALLOWS JUKEBOX 70 ' SELECTION OF MUSIC FILES.80 ' FILES MUST BE READY TO 90 ' LOADM FROM DRIVE0 AND EXEC95 ' WITH A '/MUS' EXTENSION100 '***************************110 GOTO800120 '*** READ FILE NAMES ***130 FOR SEC=3 TO 11140 DSKI$0,17,SEC,A1$,A2$150 AT$=A1$+LEFT$(A2$,120)160 FOR ENTRY=0 TO 7170 NAME$=MID$(AT$,ENTRY*32+1,8)180 TEST$=LEFT$(NAME$,1)190 IF TEST$=CHR$(0) THEN 260200 IF TEST$=CHR$(255) THEN 290210 TYPE=ASC(MID$(AT$,ENTRY*32+12,1))220 IF TYPE<>BINARY THEN 260230 EXT$=MID$(AT$,ENTRY*32+9,3)235 IFEXT$<>"MUS"THEN NEXT ENTRY,SEC:GOTO280240 I=I+1250 SONG$(I)=NAME$+"/"+EXT$260 NEXT ENTRY,SEC280 '*** JUKEBOX MENU ***290 CLS:PRINT@5,"PRESS p FOR NEXT PAGE";300 PRINT@33,"NO."310 PRINT@38,"SIDE a";320 PRINT@50,"SIDE b"330 FOR I=0 TO 9340 Q=(I+1)+(P*20)350 IF Q>79 THEN 570360 PRINT@(I*32)+64,I370 PRINT@(I*32)+70,LEFT$(SONG$(Q),8);380 PRINT@(I*32)+82,LEFT$(SONG$(Q+10),8);390 NEXT I400 PRINT@416,"SELECT SIDE a OR b, q FOR ALL";410 PRINT@485,"PRESS <enter> TO PLAY";420 S$=INKEY$:IFS$=""THEN420430 C=INSTR("ABQP"+CHR$(13),S$)440 IF C=0THEN420ELSE ON C GOTO 450,450,670,530,550450 PRINT@416,BLANKS$460 PRINT@416,"SONG NUMBER";470 SN$=INKEY$:IFSN$=""THEN470480 IFSN$<"0"ORSN$>"9"THEN470490 XX=XX+1500 Z=((C-1)*10)+VAL(SN$)+1510 O(XX)=Z520 GOTO400530 P=P+1:GOTO290540 '*** END OF SONG LIST ***550 XX=XX+1:O(XX)=99560 '*** PLAY THOSE SONGS ***570 FOR I=1 TO 72580 IF O(I)=99 THEN 730590 CLS5:PRINT@74,"coco";BUFF$;600 PRINT@79,"jukebox";610 PRINT@224,BLANKS$;620 PRINT@224,"NOW PLAYING :";630 PRINT@240,SONG$(O(I));640 LOADM SONG$(O(I))641 POKE&HFF40,0:EXEC650 NEXT I660 '*** LOAD ALL SONGS ***670 FOR XX=1TO79680 IF SONG$(XX)=""THENXX=XX-1:GOTO550690 O(XX)=XX700 NEXT710 GOTO550720 '*** FINISHED PLAYING ***730 CLS5:PRINT@224,BLANKS$;740 PRINT@224,"q TO QUIT, r FOR REPLAY";750 S$=INKEY$:IFS$=""THEN750760 C=INSTR("QR",S$)770 IF C=0THEN740ELSE ON C GOTO780,570780 CLS:END790 '*** INITIALIZE ***800 CLS5:PCLEAR1:CLEAR2000810 BLANKS$=STRING$(32," ")820 BUFF$=CHR$(207)830 DIM SONG$(80)840 DIM O(80)850 BINARY=2860 CLS:PRINT@235,"COCO JUKEBOX"870 PRINT@272,"BY":PRINT@331,"L. A. KELLOGG"880 FOR X=1TO1000:NEXT890 XX=0:I=0:P=0:GOTO130