5 CLEAR1000:PRINT"1) LSAVEM UTILITY":PRINT"2) START,END,EXEC SCANNER":INPUTA:IFA<>1THEN100010 CLS:PRINT"SOCK MASTER'S MAGIC HI-MEMORY":PRINT"SAVEM UTILITY. (OCTOBER 1995)":PRINT20 PRINT"FILENAME TO SAVE? ";:LINEINPUTF$:A=INSTR(1,F$,"/"):IFA<>0THENMID$(F$,A,1)="."30 A=INSTR(1,F$,"."):IFA=0THENF$=F$+".BIN"40 A=INSTR(1,F$,":"):IFA=0THENF$=F$+":0"50 BA=122:OPEN"O",#1,F$60 PRINT:PRINT"TYPE HI-MEM (LPEEK) START,END":PRINT"RANGES. ADD 'P' AFTER NUMBERS":PRINT"FOR LOW-MEM (PEEK) RANGES.":PRINT"HIT ENTER ON BLANK LINE TO END.":PRINT61 PRINT"COMMON RANGES:":PRINT"1024P,1535P   32 COL SCREEN":PRINT"3584P,9727P   PMODE4 SCREEN":PRINT"442368,446207 80 COL SCREEN":PRINT"393216,423935 HSCREEN2 SCREEN":PRINT"0,(BANK*8192+8191) AUDIO":PRINT70 LINEINPUT"START,END? ";A$:A=INSTR(1,A$,","):IFA=0THENPRINT"(ILLEGAL INPUT)":PRINT:GOTO9075 IFMID$(A$,A-1,1)="P"THENAD=1ELSEAD=080 S1=VAL(LEFT$(A$,A-1)):E1=VAL(RIGHT$(A$,LEN(A$)-A)):GOSUB282:GOTO7090 B=122:GOSUB170:INPUT"EXEC";EX:GOSUB200:CLOSE100 B=INSTR(1,F$,":")+1:D=VAL(MID$(F$,B,1))110 A=INSTR(1,F$,"."):D$=LEFT$(LEFT$(F$,INSTR(1,F$,".")-1)+"        ",8)+LEFT$(MID$(F$,A+1,B-A-1)+"   ",3)120 FORS=3TO18:DSKI$D,17,S,A$(0),A$(1):FORG=0TO1:FORH=1TO127STEP32:IFMID$(A$(G),H,11)=D$THENMID$(A$(G),H+11,2)=CHR$(2)+CHR$(0):DSKO$D,17,S,A$(0),A$(1):H=200:G=9:S=18130 NEXT:NEXT:NEXT:END150 '160 'SAVE BANK SWITCHING INFO TO FILE170 B=B AND63:IFBA=B THENRETURNELSEA=0:GOSUB230:A=1:GOSUB260:A=65442:GOSUB260:A=B:GOSUB230:POKE65442,B:BA=B:RETURN180 '190 'SAVE EXEC ADDRESS TO FILE200 A=255:GOSUB230:A=0:GOSUB260:A=EX:GOSUB260:RETURN210 '220 'STORE BYTE DATA TO FILE230 PRINT#1,CHR$(A);:RETURN240 '250 'STORE 16BIT NUMBER TO FILE260 AA=A:A=INT(A/256):GOSUB230:A=AA-A*256:GOSUB230:RETURN270 '280 'SAVEM CORE ROUTINE282 IFAD=1THENB1=122:B2=B1:A2=E1:ST=S1:GOTO300290 B1=INT(S1/8192):B2=INT(E1/8192):A1=S1-B1*8192+16384:A2=E1-B2*8192+16384:ST=A1:EN=24575300 FORJ=B1 TOB2:IFJ=B2 THENEN=A2310 B=J:GOSUB170:A=0:GOSUB230:A=EN-ST+1:GOSUB260:A=ST:GOSUB260:FORG=ST TOEN:PRINT#1,CHR$(PEEK(G));:NEXT320 ST=16384:NEXT:RETURN1000 LINEINPUT"SCAN WHICH FILE? ";F$:IFINSTR(1,F$,".")=0ANDINSTR(1,F$,"/")=0THENF$=F$+".BIN"1010 OPEN"D",#1,F$,1:A=11030 GOSUB1090:IFB<>0THEN1040ELSEGOSUB1080:PRINT:PRINTUSING"Len ##### ";B;:C=B:GOSUB1080:PRINTUSING"Start ##### End #####";B;B+C-1;:A=A+C:GOTO10301040 GOSUB1080:GOSUB1080:PRINTUSING" Exec #####";B1070 CLOSE:END1080 GET#1,A:B=PEEK(&H989)*256:GET#1,A+1:B=B+PEEK(&H989):A=A+2:RETURN1090 GET#1,A:B=PEEK(&H989):A=A+1:RETURN