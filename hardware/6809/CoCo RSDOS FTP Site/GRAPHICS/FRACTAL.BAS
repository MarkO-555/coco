1 CLEAR 30,&H3FFF2 PCLEAR 4:PMODE 4,1:COLOR 1,23 TP=&H7FF0:ST=&H40004 P1=ST:P2=TP:PV=.155 CLS:PRINT6 PRINT"          MOUNT FRACTAL"7 PRINT"               BY"8 PRINT"         BRUCE MACKENZIE"9 PRINT:PRINT10 PRINT"CAN YOUR MACHINE HANDLE THE HIGH";11 PRINT"SPEED POKE? Y/N"12 A$=INKEY$:IF A$<>"Y" AND A$<>"N" THEN 12 ELSE IF A$="Y" THEN POKE &HFFD7,013 PRINT14 PRINT"DO YOU WISH TO DEFINE YOUR OWN"15 PRINT"INITIAL TRIANGLE? Y/N"16 A$=INKEY$17 IF A$="Y" THEN 24 ELSE IF A$<>"N" THEN 1618 FOR N=1 TO 319 READ A,B20 C=2:GOSUB 8521 NEXT22 DATA 100,10,5,180,250,18023 GOTO 3324 CLS25 PRINT"INPUT TRIANGLE COORDINATES X,Y."26 PRINT"X=0 TO 255; Y=0 TO 191."27 FOR F=1 TO 328 PRINT:PRINT"COORDINATE"+STR$(F)+" X,Y";29 INPUT A,B30 IF A<0 OR A>255 OR B<0 OR B>191 THEN PRINT"ERROR":GOTO 2831 C=2:GOSUB 8532 NEXT F33 C=3:GOSUB 8534 CNT=CNT+135 PCLS:SCREEN 1,136 FP=0:FL=1:GP=1:H=037 C=1:B=FP+GP-1:GOSUB 85:H=C38 IF GP=FL THEN 4339 L=A:M=B40 C=1:B=FP+GP:GOSUB 85:H=C41 LINE(L,M)-(A,B),PSET42 GP=GP+1:GOTO 3843 IF H<>0 THEN 5444 GP=145 IF GP=FL+1 THEN 5346 C=1:B=FP+GP-1:GOSUB 8547 L=A:M=B48 C=1:B=FP+FL+GP-1:GOSUB 8549 LINE(L,M)-(A,B),PSET50 C=1:B=FP+FL+GP:GOSUB 8551 LINE(L,M)-(A,B),PSET52 GP=GP+1:GOTO 4553 FP=FP+FL:FL=FL+1:GP=1:GOTO 3754 FP=0:FL=1:GP=1:H=0:IF CNT=7 THEN 11155 CLS:PRINT:PRINT"  BEGINNING PASS"+STR$(CNT)56 FOR N=0 TO 600:NEXT N57 SCREEN 1,158 SOUND 100,1:C=1:B=FP+GP-1:GOSUB 85:J=A:K=B59 C=2:A=J:B=K:GOSUB 8560 IF C<>0 THEN END61 IF GP=FL THEN 6962 C=1:B=FP+GP:GOSUB 8563 H=C64 L=A:M=B65 C=J:D=K:GOSUB 10166 C=2:A=E:B=F:GOSUB 8567 IF C<>0 THEN END68 J=L:K=M:GP=GP+1:GOTO 5969 IF H<>0 THEN 3370 GP=171 IF GP=FL+1 THEN 8372 C=1:B=FP+GP-1:GOSUB 8573 L=A:M=B74 C=1:B=FP+FL+GP-1:GOSUB 8575 C=L:D=M:GOSUB 10176 C=2:A=E:B=F:GOSUB 8577 IF C<>0 THEN END78 C=1:B=FP+FL+GP:GOSUB 8579 C=L:D=M:GOSUB 10180 C=2:A=E:B=F:GOSUB 8581 IF C<>0 THEN END82 GP=GP+1:GOTO 7183 FP=FP+FL:FL=FL+1:GP=184 GOTO 5885 FG=0:IF C=3 THEN 9586 IF C=2 THEN 9187 C=2*B+P288 IF C>=TP THEN FG=-1 89 A=PEEK(C):B=PEEK(C+1)90 GOTO 10091 IF P1>=P2 THEN C=-1:RETURN92 POKE P1,A:POKE P1+1,B93 P1=P1+294 GOTO 10095 B=TP+196 FOR A=P1-1 TO ST STEP -197 POKE B,PEEK(A)98 B=B-1:NEXT A99 P2=B+1:P1=ST100 C=FG:RETURN101 D1=A-C:D2=B-D102 EL=SQR(D1*D1+D2*D2)103 EX=RND(0)*PV*EL104 IF RND(2)=1 THEN EX=-EX105 EY=RND(0)*PV*EL106 IF RND(2)=1 THEN EY=-EY107 E=EX+(C+A)/2108 F=EY+(B+D)/2109 IF E<0 OR E>255 OR F<0 OR F>191 THEN 103110 RETURN111 CLS:PRINT:PRINT"  FIGURE COMPLETE."112 FOR X=0 TO 700:NEXT X113 SCREEN 1,1114 IF INKEY$="" THEN 114 ELSE POKE &HFFD6,0:END