0 'THIS PROGRAM TAKES A FILE SAVED FROM A HI-RES GRAPHICS1 'SCREEN (&HE00 TO &H25FF DISK, OR &H600 TO &H1DFF TAPE), AND2 'CREATES FROM IT A RUNNABLE BASIC PROGRAM, SUITABLE FOR BBS3 'UPLOADING, THAT RECREATES THE PICTURE FROM A COMPRESSED4 'ASCII FORMAT AND SAVES THE BINARY OUTPUT TO DISK OR TAPE,5 'ACCORDING TO WHETHER OR NOT DISK CONTROLLER IS PRESENT.6 'REQUIRES 32K DISK OR CASSETTE.7 '8 'MIKE WARD AND ART FLEXSER,      MIAMI, JANUARY 19849 '10 GOTO1211 GOTO1312 PCLEAR6:GOTO1113 CLEAR1000,&H5DFF:GOTO2014 N=N+1:L$=STR$(N)15 L$=RIGHT$(L$,LEN(L$)-1)+CHR$(34)+A$:GOTO1816 N=N+1:L$=STR$(N)17 L$=RIGHT$(L$,LEN(L$)-1)+" "+A$18 PRINT#D,L$:PRINTL$19 RETURN20 CLS:PRINT@136,"BINARY TO ASCII"21 PRINT@263,"PICTURE COMPRESSOR"22 IFPEEK(&HC000)=68THENS=&HE00:D=1:Y$="/BAS":GOTO2423 D=-1:S=&H60024 I$="&H":FOR X=&H7A00 TO &H7A5425 READ H$:POKE X,VAL(I$+H$):NEXT26 DATA BD,B3,ED,1F,3,33,43,EF,8C,4E,8E,5E,0,10,8E,E,0,8627 DATA 8,A7,8C,40,86,6,A7,8C,3A,6F,8C,39,A6,80,5F,48,59,6A28 DATA 8C,2F,27,16,6A,8C,2B,26,F4,86,8,A7,8C,24,A6,80,AC,8C29 DATA 21,25,E8,63,8C,1B,20,E3,CB,30,E7,A0,C6,6,E7,8C,E,5F30 DATA 6D,8C,C,27,DB,31,3F,1F,20,BD,B4,F4,3931 FOR X=&H7B00 TO &H7C3332 READ H$:POKE X,VAL(I$+H$):NEXT33 DATA 8E,0,0,4F,5F,31,8D,1,82,AF,A1,A7,A0,4C,5A,26,F8,8E34 DATA E,0,31,8D,1,73,86,3,E6,80,3D,34,20,31,AB,EE,A4,3335 DATA 41,EF,A4,35,20,8C,26,0,25,EA,31,8D,1,59,C6,FF,AE,A436 DATA A6,22,AC,23,25,4,AE,23,A6,25,31,23,5A,26,F3,B7,5E,037 DATA 6F,8D,0,E9,8E,E,0,10,8E,5E,1,A6,84,17,0,A0,17,038 DATA C7,27,12,B1,5E,0,26,9,F6,5E,0,E7,A0,C6,1,E7,A0,A739 DATA A4,20,69,A1,84,26,52,34,2,17,0,8E,A1,E4,35,2,26,4740 DATA 34,2,17,0,91,A1,E4,35,2,26,3C,C6,1,E7,8D,0,A5,C641 DATA FF,A1,84,26,12,6C,8D,0,9B,17,0,5C,17,0,83,26,15,E142 DATA 8D,0,8F,22,EA,F6,5E,0,E7,A0,E6,8D,0,84,E7,A0,A7,A043 DATA 20,9D,F6,5E,0,E7,A0,E6,8D,0,75,E7,A0,A7,A4,20,13,B144 DATA 5E,0,26,9,F6,5E,0,E7,A0,C6,1,E7,A0,A7,A0,16,FF,7B45 DATA 10,8C,75,FF,25,14,8E,E,0,10,8E,5E,0,EC,81,ED,A1,8C46 DATA 26,0,25,F7,10,8E,0,0,1F,20,BD,B4,F4,39,8C,25,E0,2447 DATA 4,30,88,20,39,30,89,E8,21,39,8C,25,E0,24,4,A6,88,2048 DATA 39,A6,89,E8,21,39,8C,25,C0,24,4,A6,88,40,39,A6,89,E849 DATA 41,39,6D,8D,0,F,26,B,8C,25,FF,26,4,6C,8D,0,4,1A,4,3950 IFD=1THEN5451 FORI=1 TO 10:READ A$,P$:POKE VAL(I$+A$),VAL(I$+P$):NEXT52 DATA 7A0F,6,7B12,6,7B2A,1E,7B4D,6,7BDF,6,7BEA,1E,7BF9,1D53 DATA 7C07,1D,7C15,1D,7C29,1D54 DEFUSR0=&H7B00:DEFUSR1=&H7A0055 CLS:PRINT@96,"FILE NAME OF PICTURE"56 LINEINPUT"TO COMPRESS: ";F$57 PMODE4,1:PCLS1:SCREEN1,1:IFD=1 THEN LOADM F$ ELSE CLOADM F$58 E=USR0(0):IF E<>0 THEN CS=0 ELSE CS=1:E=&H5E00+614359 E2=USR1(E):PRINT:PRINT"6144 BYTES ORIGINALLY"60 PRINTUSING"####";E-&H5E00+1;61 PRINT" BYTES AFTER COMPRESSION"62 PRINTUSING"####";E2-S;:PRINT" BYTES CONVERTED TO ASCII"63 PRINT:PRINT@320,"FILENAME FOR ASCII PICTURE"64 IF F$<>""THEN PRINT"OR <ENTER> TO USE: "TAB(8)F$+Y$65 PRINTSTRING$(17,"=");"> ";:LINEINPUT G$66 IFG$=""THENG$=F$:IF F$=""THEN6367 G$=G$+Y$:PRINT:PRINT"SAVING ";G$:PRINT68 OPEN "O",#D,G$69 N=1:AD=S:EC=5970 L$="1 PCLEAR4:CLEAR200,&H5DFF:"71 IF CS=0 THEN EN$="&H7E95" ELSE EN$="&H7E59"72 L$=L$+"FOR X=&H7E00 TO "+EN$:GOSUB1873 A$="READ H$:POKE X,VAL("+CHR$(34)+"&H"+CHR$(34)+"+H$):NEXT"74 GOSUB1675 A$="DATA 9E,33,30,6,10,8E,5E,0,86,8,A7,8C,3A,86,6,A7,8C,34"76 GOSUB1677 A$="DATA A6,80,80,30,48,48,48,59,6A,8C,29,27,E,6A,8C,25,26"78 GOSUB1679 A$="DATA F4,E7,A0,C6,8,E7,8C,1C,20,EB,86,6,A7,8C,14,A6,80"80 A$=A$+",26,A":GOSUB1681 A$="DATA A6,4,81,22,26,C,30,5,A6,80,80,30,48,48,20,D9,0,0"82 GOSUB1683 IF CS=0 THEN 8684 A$="DATA 8E,5E,0,10,8E,E,0,EC,81,ED,A1,10,8C,26,0,25,F6,39"85 GOSUB16:GOTO 9486 A$="DATA 8E,5E,0,10,8E,E,0,A6,80,A7,8C,42,6F,8C,40,A6,80,"87 A$=A$+"A1,8C,3A":GOSUB1688 A$="DATA 26,F,E6,80,A6,80,A7,A4,8D,10,8D,1D,5A,26,F7,20,4,"89 A$=A$+"A7,A4":GOSUB1690 A$="DATA 8D,5,8D,12,27,E2,39,10,8C,25,E0,24,4,31,A8,20,39,"91 A$=A$+"31,A9":GOSUB1692 A$="DATA E8,21,39,6D,8C,F,26,B,10,8C,25,FF,26,3,6C,8C,4,1A,"93 A$=A$+"4,39":GOSUB1694 A$="IFPEEK(&HC000)=68THEN DK=1:GOTO"+STR$(N+3):GOSUB1695 IFCS THEN9796 A$="POKE&H7E4D,6:POKE&H7E78,&H1D:POKE&H7E8C,&H1D":GOTO9897 A$="POKE&H7E4D,6:POKE&H7E55,&H1E"98 GOSUB1699 A$="PMODE4,1:PCLS1:SCREEN1,1:READZ:EXEC&H7E00:FORI=1TO"100 A$=A$+"5000:NEXT":GOSUB16101 A$="CLS:LINEINPUT"+CHR$(34)+"FILENAME FOR PICTURE: "102 A$=A$+CHR$(34)+";F$:IFF$="+CHR$(34)+CHR$(34)+"THEN"103 A$=A$+STR$(N+1):GOSUB16104 A$="IFDK THEN SAVEM F$,&HE00,&H25FF,&HA027:END":GOSUB16105 A$="CSAVEM F$,&H600,&H1DFF,&HA027:END":GOSUB16106 A$="DATA1":GOSUB16107 C1=INT((E2-S)/EC)108 C2=(E2-S)-(C1*EC):N=99109 V=VARPTR(A$):V1=V+2:V2=V+3:POKEV,EC110 FOR I=1 TO C1111 GOSUB114:AD=AD+EC:NEXT:IFC2=0THEN113112 POKEV,C2:GOSUB114113 CLOSE:PCLEAR4:CLEAR200,&H7FFF:END114 MS=INT(AD/256):LS=AD-256*MS:POKEV1,MS:POKEV2,LS:GOSUB14115 RETURN