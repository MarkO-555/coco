10 RUN80'NEED THIS FOR NO BREAK20 '*** KALIEDOSCOPE ***25 ' COPYRIGHT (C) CLOAD 198230 'ADAPTED FROM A PROGRAM FOR      THE VIP 1802 FROM RCA, WRIT-    TEN BY JOE WEISBECKER40 'THIS VERSION BY RUSS NELSON50 ' RT. 2, BOX 321A, CORVALLIS,60 ' OREGON, 97330.70 ' 503-929-6278 OR 627980 'DISABLE BREAK90 POKE &HF8,&H32:POKE &HF9,&H62:POKE &HFA,&H1C:POKE&HFB,&HAF:POKE&HFC,&H7E:POKE&HFD,&HAD:POKE&HFE,&HA5:POKE&H19A,&H39:POKE&H19B,&H0:POKE&H19C,&HF8:POKE&H19A,&H7E100 CLS0110 PRINT @10,STRING$(14,191);:PRINT@42,CHR$(191);"KALIEDOSCOPE";CHR$(191);:PRINT@74,STRING$(14,191);120 PRINT@256,"DO YOU WANT INSTRUCTIONS? (Y/N)";130 A$=INKEY$140 ON INSTR(1,"@YN",INKEY$)+1 GOTO 140,140,150,460150 'INSTRUCTIONS160 PRINT @5*32,"   KALIEDOSCOPE PRODUCES PRETTY"170 PRINT "PATTERNS ON THE SCREEN.  THE180 PRINT "PROGRAM TAKES A PATTERN THAT YOU";190 PRINT "INPUT AND REPEATS IT, MIRRORED200 PRINT "AROUND THE HORIZONTAL AND210 PRINT "VERTICAL AXES.  EACH TIME THE220 PRINT"PATTERN IS REPEATED, THE COLOR230 PRINT"IS CHANGED.240 INPUT "<ENTER> TO CONTINUE";A$250 PRINT @5*32,"   YOU INPUT THE PATTERN USING260 PRINT"THE FOUR ARROW KEYS.  YOUR270 PRINT"CURSOR IS THE FLASHING DOT280 PRINT"WHICH IS INITIALLY IN THE UPPER290 PRINT"LEFT PART OF THE SCREEN.  AS YOU";300 PRINT"INPUT THE PATTERN, IT IS310 PRINT"REFLECTED THE SAME WAY AS WHEN320 PRINT"THE PROGRAM IS REPEATING THE330 PRINT"PATTERN."340 INPUT"<ENTER> TO CONTINUE";A$350 PRINT@5*32,"   WHEN YOU ARE SATISFIED WITH360 PRINT"YOUR PATTERN, HIT THE <ENTER>370 PRINT"KEY.  THE PROGRAM WILL THEN TAKE";380 PRINT"OFF.  TO ADJUST THE REPEAT SPEED";390 PRINT"HIT A KEY FROM A TO Z, A BEING400 PRINT"THE FASTEST.  WHEN THE PATTERN410 PRINT"BECOMES BORING, HIT THE <BREAK>420 PRINT"KEY, AND YOU WILL RETURN TO430 PRINT"INPUT MODE.  TO EXIT THE PROGRAM";440 PRINT"HIT THE <BREAK> KEY AGAIN.450 INPUT "<ENTER> TO BEGIN";A$460 CLEAR 600470 AD=PEEK(&H1B)*256+PEEK(&H1C)480 DEF USR0=AD-256490 CO=1500 CLS0510 CH$=CHR$(94)+CHR$(10)+CHR$(8)+CHR$(9)+CHR$(13)+CHR$(3)520 A=0:X=31:Y=15530 LI$=""540 GOSUB 860550 P=POINT(X,Y)560 A$=INKEY$570 IF TIMER<7 THEN 600580 TIMER=0590 IF POINT(X,Y) THEN RESET(X,Y) ELSE SET(X,Y,CO)600 IF A$="" THEN 560610 IF P THEN SET(X,Y,CO) ELSE RESET(X,Y)620 CH=INSTR(1,CH$,A$)630 IF CH=6 THEN 710640 IF CH=5 THEN IF LI$="" THEN 490 ELSE 740650 IF CH=0 THEN 550660 IF A=250 THEN SOUND 1,1:GOTO550670 GOSUB 850680 A=A+1690 LI$=LI$+CHR$(CH)700 GOTO 550710 'STOP720 CLS0730 END740 'START REPEATING STRING750 'DELETE NEXT TWO LINES TO USE BASIC INSTEAD OF MACHINE CODE760 LI$=USR0(LI$)770 GOTO 490780 A1=A-1790 IF COL=8 THEN COL=1 ELSE COL=COL+1800 FOR A=0 TO A1810 GOSUB 850820 IF INKEY$<>"" THEN 490830 NEXT A840 GOTO 790850 ON CH GOSUB 920,940,960,980860 'SET(X,Y,(POINT(X,Y) AND 7)+1)870 IF POINT(X,Y) THEN RESET(X,Y) ELSE SET(X,Y,CO)880 IF POINT(63-X,Y) THEN RESET(63-X,Y) ELSE SET(63-X,Y,CO)890 IF POINT(X,31-Y) THEN RESET(X,31-Y) ELSE SET(X,31-Y,CO)900 IF POINT(63-X,31-Y) THEN RESET(63-X,31-Y) ELSE SET(63-X,31-Y,CO)910 RETURN920 Y=Y-1:IF Y<0 THEN Y=15:GOTO980930 RETURN940 Y=Y+1:IF Y>15 THEN Y=0:GOTO960950 RETURN960 X=X-1:IF X<0 THEN X=31:GOTO 940970 RETURN980 X=X+1:IF X>31 THEN X=0:GOTO 920990 RETURN